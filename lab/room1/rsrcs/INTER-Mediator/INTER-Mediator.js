var INTERMediator_DBAdapter;INTERMediator_DBAdapter={generate_authParams:function(){var b="",c,a;if(INTERMediatorOnPage.authUser.length>0){b="&clientid="+encodeURIComponent(INTERMediatorOnPage.clientId)+"&authuser="+encodeURIComponent(INTERMediatorOnPage.authUser);if(INTERMediatorOnPage.isNativeAuth){b+="&response="+encodeURIComponent(INTERMediatorOnPage.publickey.biEncryptedString(INTERMediatorOnPage.authHashedPassword+"\n"+INTERMediatorOnPage.authChallenge))}else{if(INTERMediatorOnPage.authHashedPassword&&INTERMediatorOnPage.authChallenge){c=new jsSHA(INTERMediatorOnPage.authHashedPassword,"ASCII");a=c.getHMAC(INTERMediatorOnPage.authChallenge,"ASCII","SHA-256","HEX");b+="&response="+encodeURIComponent(a)}else{b+="&response=dummy"}}}return b},store_challenge:function(a){if(a!==null){INTERMediatorOnPage.authChallenge=a.substr(0,24);INTERMediatorOnPage.authUserHexSalt=a.substr(24,32);INTERMediatorOnPage.authUserSalt=String.fromCharCode(parseInt(a.substr(24,2),16),parseInt(a.substr(26,2),16),parseInt(a.substr(28,2),16),parseInt(a.substr(30,2),16))}},logging_comAction:function(a,d,c,b){INTERMediator.setDebugMessage(INTERMediatorOnPage.getMessages()[a]+"Accessing:"+decodeURI(d)+", Parameters:"+decodeURI(c+b))},logging_comResult:function(c,k,a,d,h,l,b,f,e){var g;if(INTERMediator.debugMode>1){if(c.responseText.length>1000){g=c.responseText.substr(0,1000)+" ...[trancated]"}else{g=c.responseText}INTERMediator.setDebugMessage("myRequest.responseText="+g);INTERMediator.setDebugMessage("Return: resultCount="+k+", dbresult="+INTERMediatorLib.objectToString(a)+"\nReturn: requireAuth="+d+", challenge="+h+", clientid="+l+"\nReturn: newRecordKeyValue="+b+", changePasswordResult="+f+", mediatoken="+e)}},server_access:function(accessURL,debugMessageNumber,errorMessageNumber){var newRecordKeyValue="",dbresult="",resultCount=0,challenge=null,clientid=null,requireAuth=false,myRequest=null,changePasswordResult=null,mediatoken=null,appPath,authParams;appPath=INTERMediatorOnPage.getEntryPath();authParams=INTERMediator_DBAdapter.generate_authParams();INTERMediator_DBAdapter.logging_comAction(debugMessageNumber,appPath,accessURL,authParams);try{myRequest=new XMLHttpRequest();myRequest.open("POST",appPath,false,INTERMediatorOnPage.httpuser,INTERMediatorOnPage.httppasswd);myRequest.setRequestHeader("charset","utf-8");myRequest.setRequestHeader("Content-Type","application/x-www-form-urlencoded");myRequest.send(accessURL+authParams);eval(myRequest.responseText);INTERMediator_DBAdapter.logging_comResult(myRequest,resultCount,dbresult,requireAuth,challenge,clientid,newRecordKeyValue,changePasswordResult,mediatoken);INTERMediator_DBAdapter.store_challenge(challenge);if(clientid!==null){INTERMediatorOnPage.clientId=clientid}if(mediatoken!==null){INTERMediatorOnPage.mediaToken=mediatoken}}catch(e){INTERMediator.setErrorMessage(e,INTERMediatorLib.getInsertedString(INTERMediatorOnPage.getMessages()[errorMessageNumber],[e,myRequest.responseText]))}if(requireAuth){INTERMediator.setDebugMessage("Authentication Required, user/password panel should be show.");INTERMediatorOnPage.authHashedPassword=null;throw"_im_requath_request_"}if(!accessURL.match(/access=challenge/)){INTERMediatorOnPage.authCount=0}INTERMediatorOnPage.storeCredencialsToCookie();return{dbresult:dbresult,resultCount:resultCount,newRecordKeyValue:newRecordKeyValue,newPasswordResult:changePasswordResult}},changePassowrd:function(d,a,c){if(d&&a){INTERMediatorOnPage.authUser=d;if(d!=""&&(INTERMediatorOnPage.authChallenge==null||INTERMediatorOnPage.authChallenge.length<24)){INTERMediatorOnPage.authHashedPassword="need-hash-pls";challengeResult=INTERMediator_DBAdapter.getChallenge();if(!challengeResult){INTERMediator.flushMessage();return false}}INTERMediatorOnPage.authHashedPassword=SHA1(a+INTERMediatorOnPage.authUserSalt)+INTERMediatorOnPage.authUserHexSalt}else{INTERMediatorOnPage.retrieveAuthInfo()}params="access=changepassword&newpass="+INTERMediatorLib.generatePasswordHash(c);try{result=INTERMediator_DBAdapter.server_access(params,1029,1030);if(result.newPasswordResult&&result.newPasswordResult===true){if(INTERMediatorOnPage.isNativeAuth){INTERMediatorOnPage.authHashedPassword=INTERMediatorOnPage.publickey.biEncryptedString(c)}else{INTERMediatorOnPage.authHashedPassword=SHA1(c+INTERMediatorOnPage.authUserSalt)+INTERMediatorOnPage.authUserHexSalt}INTERMediatorOnPage.storeCredencialsToCookie()}}catch(b){return false}return(result.newPasswordResult&&result.newPasswordResult===true)},getChallenge:function(){try{this.server_access("access=challenge",1027,1028)}catch(a){if(a=="_im_requath_request_"){throw a}else{INTERMediator.setErrorMessage(a,"EXCEPTION-19")}}if(INTERMediatorOnPage.authChallenge==null){return false}return true},uploadFile:function(parameters,uploadingFile,doItOnFinish){var newRecordKeyValue="",dbresult="",resultCount=0,challenge=null,clientid=null,requireAuth=false,myRequest=null,changePasswordResult=null,mediatoken=null,appPath,authParams,accessURL;appPath=INTERMediatorOnPage.getEntryPath();authParams=INTERMediator_DBAdapter.generate_authParams();accessURL="access=uploadfile"+parameters;INTERMediator_DBAdapter.logging_comAction(1031,appPath,accessURL,authParams);try{myRequest=new XMLHttpRequest();myRequest.open("POST",appPath,true,INTERMediatorOnPage.httpuser,INTERMediatorOnPage.httppasswd);myRequest.setRequestHeader("charset","utf-8");var params=(accessURL+authParams).split("&");var fd=new FormData();for(var i=0;i<params.length;i++){var valueset=params[i].split("=");fd.append(valueset[0],decodeURIComponent(valueset[1]))}fd.append("_im_uploadfile",uploadingFile.content);myRequest.onreadystatechange=function(){switch(myRequest.readyState){case 3:break;case 4:eval(myRequest.responseText);INTERMediator_DBAdapter.logging_comResult(myRequest,resultCount,dbresult,requireAuth,challenge,clientid,newRecordKeyValue,changePasswordResult,mediatoken);INTERMediator_DBAdapter.store_challenge(challenge);if(clientid!==null){INTERMediatorOnPage.clientId=clientid}if(mediatoken!==null){INTERMediatorOnPage.mediaToken=mediatoken}if(requireAuth){INTERMediator.setDebugMessage("Authentication Required, user/password panel should be show.");INTERMediatorOnPage.authHashedPassword=null;throw"_im_requath_request_"}INTERMediatorOnPage.authCount=0;INTERMediatorOnPage.storeCredencialsToCookie();doItOnFinish();break}};myRequest.send(fd)}catch(e){INTERMediator.setErrorMessage(e,INTERMediatorLib.getInsertedString(INTERMediatorOnPage.getMessages()[1032],[e,myRequest.responseText]))}},db_query:function(m){var c=true,g,k,f,a,o,h,d,b,n,e;if(m.name==null){INTERMediator.setErrorMessage(INTERMediatorLib.getInsertedStringFromErrorNumber(1005));c=false}if(!c){return}if(m.records==null){f="access=select&name="+encodeURIComponent(m.name)+"&records=10000000"}else{if(m.records==0){f="access=describe&name="+encodeURIComponent(m.name)}else{f="access=select&name="+encodeURIComponent(m.name)}f+="&records="+encodeURIComponent(m.records)}if(m.primaryKeyOnly){f+="&pkeyonly=true"}if(m.fields){for(g=0;g<m.fields.length;g++){f+="&field_"+g+"="+encodeURIComponent(m.fields[g])}}a=0;if(m.parentkeyvalue){for(k in m.parentkeyvalue){if(m.parentkeyvalue.hasOwnProperty(k)){f+="&foreign"+a+"field="+encodeURIComponent(k);f+="&foreign"+a+"value="+encodeURIComponent(m.parentkeyvalue[k]);a++}}}if(m.useoffset&&INTERMediator.startFrom!=null){f+="&start="+encodeURIComponent(INTERMediator.startFrom)}o=0;while(m.conditions&&m.conditions[o]){f+="&condition"+o+"field="+encodeURIComponent(m.conditions[o]["field"]);f+="&condition"+o+"operator="+encodeURIComponent(m.conditions[o]["operator"]);f+="&condition"+o+"value="+encodeURIComponent(m.conditions[o]["value"]);o++}h=INTERMediator.additionalCondition[m.name];if(h){if(h.field){h=[h]}for(k=0;k<h.length;k++){if(h.hasOwnProperty(k)){f+="&condition"+o+"field="+encodeURIComponent(h[k]["field"]);if(h[k]["operator"]!==undefined){f+="&condition"+o+"operator="+encodeURIComponent(h[k]["operator"])}if(h[k]["value"]!==undefined){f+="&condition"+o+"value="+encodeURIComponent(h[k]["value"])}o++}}}o=0;d=INTERMediator.additionalSortKey[m.name];if(d){if(d.field){d=[d]}for(k=0;k<d.length;k++){f+="&sortkey"+o+"field="+encodeURIComponent(d[k]["field"]);f+="&sortkey"+o+"direction="+encodeURIComponent(d[k]["direction"]);o++}}f+="&randkey"+Math.random();b={};try{n=this.server_access(f,1012,1004);b.recordset=n.dbresult;b.totalCount=n.resultCount;b.count=0;for(e in n.dbresult){b.count++}if((m.paging!=null)&&(m.paging==true)){INTERMediator.pagedSize=m.records;INTERMediator.pagedAllCount=n.resultCount}}catch(l){if(l=="_im_requath_request_"){throw l}else{INTERMediator.setErrorMessage(l,"EXCEPTION-17")}b.recordset=null;b.totalCount=0;b.count=0}return b},db_queryWithAuth:function(b,a){var d=false;INTERMediatorOnPage.retrieveAuthInfo();try{d=INTERMediator_DBAdapter.db_query(b)}catch(c){if(c=="_im_requath_request_"){if(INTERMediatorOnPage.requireAuthentication){if(!INTERMediatorOnPage.isComplementAuthData()){INTERMediatorOnPage.authChallenge=null;INTERMediatorOnPage.authHashedPassword=null;INTERMediatorOnPage.authenticating(function(){d=INTERMediator_DBAdapter.db_queryWithAuth(arg,a)});return}}}else{INTERMediator.setErrorMessage(c,"EXCEPTION-16")}}a(d)},db_update:function(g){var b=true,d,h,k,a,f,e;if(g.name==null){INTERMediator.setErrorMessage(INTERMediatorLib.getInsertedStringFromErrorNumber(1007));b=false}if(g.dataset==null){INTERMediator.setErrorMessage(INTERMediatorLib.getInsertedStringFromErrorNumber(1011));b=false}if(!b){return}d="access=update&name="+encodeURIComponent(g.name);a=0;if(INTERMediator.additionalFieldValueOnUpdate&&INTERMediator.additionalFieldValueOnUpdate[g.name]){e=INTERMediator.additionalFieldValueOnUpdate[g.name];if(e.field){e=[e]}for(f in e){var c=e[f];d+="&field_"+a+"="+encodeURIComponent(c.field);d+="&value_"+a+"="+encodeURIComponent(c.value);a++}}if(g.conditions!=null){for(h=0;h<g.conditions.length;h++){d+="&condition"+h+"field=";d+=encodeURIComponent(g.conditions[h]["field"]);d+="&condition"+h+"operator=";d+=encodeURIComponent(g.conditions[h]["operator"]);if(g.conditions[h]["value"]){d+="&condition"+h+"value=";d+=encodeURIComponent(g.conditions[h]["value"])}}}for(h=0;h<g.dataset.length;h++){d+="&field_"+(a+h)+"="+encodeURIComponent(g.dataset[h]["field"]);d+="&value_"+(a+h)+"="+encodeURIComponent(g.dataset[h]["value"])}k=this.server_access(d,1013,1014);return k.dbresult},db_updateWithAuth:function(b,a){var d=false;INTERMediatorOnPage.retrieveAuthInfo();try{d=INTERMediator_DBAdapter.db_update(b)}catch(c){if(c=="_im_requath_request_"){if(INTERMediatorOnPage.requireAuthentication){if(!INTERMediatorOnPage.isComplementAuthData()){INTERMediatorOnPage.authChallenge=null;INTERMediatorOnPage.authHashedPassword=null;INTERMediatorOnPage.authenticating(function(){d=INTERMediator_DBAdapter.db_updateWithAuth(arg,a)});return}}}else{INTERMediator.setErrorMessage(c,"EXCEPTION-15")}}a(d)},db_delete:function(h){var b=true,d,e,k,a,g,f;if(h.name==null){INTERMediator.setErrorMessage(INTERMediatorLib.getInsertedStringFromErrorNumber(1019));b=false}if(h.conditions==null){INTERMediator.setErrorMessage(INTERMediatorLib.getInsertedStringFromErrorNumber(1020));b=false}if(!b){return}d="access=delete&name="+encodeURIComponent(h.name);a=0;if(INTERMediator.additionalFieldValueOnDelete&&INTERMediator.additionalFieldValueOnDelete[h.name]){f=INTERMediator.additionalFieldValueOnDelete[h.name];if(f.field){f=[f]}for(g in f){var c=f[g];d+="&field_"+a+"="+encodeURIComponent(c.field);d+="&value_"+a+"="+encodeURIComponent(c.value);a++}}for(e=0;e<h.conditions.length;e++){d+="&condition"+e+"field="+encodeURIComponent(h.conditions[e]["field"]);d+="&condition"+e+"operator="+encodeURIComponent(h.conditions[e]["operator"]);d+="&condition"+e+"value="+encodeURIComponent(h.conditions[e]["value"])}k=this.server_access(d,1017,1015);return k},db_deleteWithAuth:function(b,a){var d=false;INTERMediatorOnPage.retrieveAuthInfo();try{d=INTERMediator_DBAdapter.db_delete(b)}catch(c){if(c=="_im_requath_request_"){if(INTERMediatorOnPage.requireAuthentication){if(!INTERMediatorOnPage.isComplementAuthData()){INTERMediatorOnPage.authChallenge=null;INTERMediatorOnPage.authHashedPassword=null;INTERMediatorOnPage.authenticating(function(){d=INTERMediator_DBAdapter.db_deleteWithAuth(arg,a)});return}}}else{INTERMediator.setErrorMessage(c,"EXCEPTION-14")}}a(d)},db_createRecord:function(h){var d,e,k,g,f,a,b;if(h.name==null){INTERMediator.setErrorMessage(INTERMediatorLib.getInsertedStringFromErrorNumber(1021));return}ds=INTERMediatorOnPage.getDataSources();b=null;for(key in ds){if(ds[key]["name"]==h.name){b=key;break}}if(b===null){alert("no targetname :"+h.name);return}d="access=new&name="+encodeURIComponent(h.name);a=0;if(INTERMediator.additionalFieldValueOnNewRecord&&INTERMediator.additionalFieldValueOnNewRecord[h.name]){f=INTERMediator.additionalFieldValueOnNewRecord[h.name];if(f.field){f=[f]}for(g in f){var c=f[g];d+="&field_"+a+"="+encodeURIComponent(c.field);d+="&value_"+a+"="+encodeURIComponent(c.value);a++}}for(e=0;e<h.dataset.length;e++){d+="&field_"+a+"="+encodeURIComponent(h.dataset[e]["field"]);d+="&value_"+a+"="+encodeURIComponent(h.dataset[e]["value"]);a++}k=this.server_access(d,1018,1016);return k.newRecordKeyValue},db_createRecordWithAuth:function(b,a){var d=false;INTERMediatorOnPage.retrieveAuthInfo();try{d=INTERMediator_DBAdapter.db_createRecord(b)}catch(c){if(c=="_im_requath_request_"){if(INTERMediatorOnPage.requireAuthentication){if(!INTERMediatorOnPage.isComplementAuthData()){INTERMediatorOnPage.authChallenge=null;INTERMediatorOnPage.authHashedPassword=null;INTERMediatorOnPage.authenticating(function(){d=INTERMediator_DBAdapter.db_createRecordWithAuth(arg,a)});return}}}else{INTERMediator.setErrorMessage(c,"EXCEPTION-13")}}if(a){a(d)}}};var INTERMediatorLib={ignoreEnclosureRepeaterClassName:"_im_ignore_enc_rep",rollingRepeaterClassName:"_im_repeater",rollingEnclocureClassName:"_im_enclosure",generatePasswordHash:function(d){var f,e,c,g,a,b;f=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F"];e="";c="";for(i=0;i<4;i++){g=Math.floor(Math.random()*(128-32)+32);a=g&15;b=(g>>4)&15;e+=String.fromCharCode(g);c+=f[b]+f[a]}return encodeURIComponent(SHA1(d+e)+c)},getParentRepeater:function(b){var a=b;while(a!=null){if(INTERMediatorLib.isRepeater(a,true)){return a}a=a.parentNode}return null},getParentEnclosure:function(b){var a=b;while(a!=null){if(INTERMediatorLib.isEnclosure(a,true)){return a}a=a.parentNode}return null},isEnclosure:function(e,f){var c,d,b,a;if(!e||e.nodeType!==1){return false}c=e.tagName;d=INTERMediatorLib.getClassAttributeFromNode(e);if(d&&d.indexOf(INTERMediatorLib.ignoreEnclosureRepeaterClassName)>=0){return false}if((c==="TBODY")||(c==="UL")||(c==="OL")||(c==="SELECT")||((c==="DIV"||c==="SPAN")&&d&&d.indexOf(INTERMediatorLib.rollingEnclocureClassName)>=0)){if(f){return true}else{b=e.childNodes;for(a=0;a<b.length;a++){if(INTERMediatorLib.isRepeater(b[a],true)){return true}}}}return false},isRepeater:function(f,g){var d,e,c,b;if(!f||f.nodeType!==1){return false}d=f.tagName;e=INTERMediatorLib.getClassAttributeFromNode(f);if(e&&e.indexOf(INTERMediatorLib.ignoreEnclosureRepeaterClassName)>=0){return false}if((d==="TR")||(d==="LI")||(d==="OPTION")||((d==="DIV"||d==="SPAN")&&e&&e.indexOf(INTERMediatorLib.rollingRepeaterClassName)>=0)){if(g){return true}else{return a(f)}}return false;function a(h){if(INTERMediatorLib.isLinkedElement(h)){return true}c=h.childNodes;for(b=0;b<c.length;b++){if(c[b].nodeType===1){if(INTERMediatorLib.isLinkedElement(c[b])){return true}else{if(a(c[b])){return true}}}}return false}},isLinkedElement:function(b){var c,a;if(b!=null){if(INTERMediator.titleAsLinkInfo){if(b.getAttribute("TITLE")!=null&&b.getAttribute("TITLE").length>0){return true}}if(INTERMediator.classAsLinkInfo){c=INTERMediatorLib.getClassAttributeFromNode(b);if(c!=null){a=c.match(/IM\[.*\]/);if(a){return true}}}}return false},isWidgetElement:function(b){var c,a;if(b!=null){c=INTERMediatorLib.getClassAttributeFromNode(b);if(c!=null){a=c.match(/IM_WIDGET\[.*\]/);if(a){return true}}}return false},isNamedElement:function(b){var c,a;if(b!=null){c=b.getAttribute("name");if(c!=null){a=c.match(/IM\[.*\]/);if(a){return true}}}return false},getEnclosureSimple:function(a){if(INTERMediatorLib.isEnclosure(a,true)){return a}return INTERMediatorLib.getEnclosureSimple(a.parentNode)},getEnclosure:function(d){var c,b;c=d;while(c!=null){if(INTERMediatorLib.isRepeater(c,true)){b=c}else{if(a(b,c)){b=null;return c}}c=c.parentNode}return null;function a(h,l){var k,g,f,m,e;if(!h||!l){return false}k=h.tagName;g=l.tagName;if((k==="TR"&&g==="TBODY")||(k==="OPTION"&&g==="SELECT")||(k==="LI"&&g==="OL")||(k==="LI"&&g==="UL")){return true}if((g==="DIV"||g==="SPAN")){f=INTERMediatorLib.getClassAttributeFromNode(l);if(f&&f.indexOf("_im_enclosure")>=0){m=INTERMediatorLib.getClassAttributeFromNode(h);if((k==="DIV"||k==="SPAN")&&m!=null&&m.indexOf("_im_repeater")>=0){return true}else{if(k==="INPUT"){e=h.getAttribute("type");if(e&&((e.indexOf("radio")>=0||e.indexOf("check")>=0))){return true}}}}}return false}},getLinkedElementInfo:function(g){var b=[],c,e,d,a;if(INTERMediatorLib.isLinkedElement(g)){if(INTERMediator.titleAsLinkInfo){if(g.getAttribute("TITLE")!=null){c=g.getAttribute("TITLE").split(INTERMediator.defDivider);for(e=0;e<c.length;e++){b.push(f(c[e]))}}}if(INTERMediator.classAsLinkInfo){d=INTERMediatorLib.getClassAttributeFromNode(g);if(d!==null&&d.length>0){a=d.match(/IM\[([^\]]*)\]/);c=a[1].split(INTERMediator.defDivider);for(e=0;e<c.length;e++){b.push(f(c[e]))}}}return b}return false;function f(k){var h=INTERMediatorOnPage.getOptionsAliases();if(h!=null&&h[k]!=null){return h[k]}return k}},getWidgetInfo:function(f){var b=[],c,e,d,a;if(INTERMediatorLib.isWidgetElement(f)){d=INTERMediatorLib.getClassAttributeFromNode(f);if(d!==null&&d.length>0){a=d.match(/IM_WIDGET\[([^\]]*)\]/);c=a[1].split(INTERMediator.defDivider);for(e=0;e<c.length;e++){b.push(c[e])}}return b}return false},getNamedInfo:function(f){var b=[],c,e,d,a;if(INTERMediatorLib.isNamedElement(f)){d=f.getAttribute("name");if(d!==null&&d.length>0){a=d.match(/IM\[([^\]]*)\]/);c=a[1].split(INTERMediator.defDivider);for(e=0;e<c.length;e++){b.push(c[e])}}return b}return false},repeaterTagFromEncTag:function(a){if(a=="TBODY"){return"TR"}else{if(a=="SELECT"){return"OPTION"}else{if(a=="UL"){return"LI"}else{if(a=="OL"){return"LI"}else{if(a=="DIV"){return"DIV"}else{if(a=="SPAN"){return"SPAN"}}}}}}return null},getNodeInfoArray:function(b){var e,a,d,c;e=b.split(INTERMediator.separator);a="",d="",c="";if(e.length==3){a=e[0];d=e[1];c=e[2]}else{if(e.length==2){a=e[0];d=e[1]}else{d=b}}return{table:a,field:d,target:c,tableindex:"_im_index_"+a}},getClassAttributeFromNode:function(a){var b="";if(a==null){return""}if(INTERMediator.isIE&&INTERMediator.ieVersion<8){b=a.getAttribute("className")}else{b=a.getAttribute("class")}return b},setClassAttributeToNode:function(b,a){if(b==null){return}if(INTERMediator.isIE&&INTERMediator.ieVersion<8){b.setAttribute("className",a)}else{b.setAttribute("class",a)}},addEvent:function(c,a,b){if(c.addEventListener){c.addEventListener(a,b,false)}else{if(c.attachEvent){c.attachEvent("on"+a,b)}}},toNumber:function(d){var b="",a,e;d=(new String(d)).toString();for(a=0;a<d.length;a++){e=d.charAt(a);if((e>="0"&&e<="9")||e=="-"||e=="."){b+=e}}return parseFloat(b)},RoundHalfToEven:function(a,b){return a},numberFormat:function(e,h){var l,a,b,d,k,g,c;l=new Array();a=INTERMediatorLib.toNumber(e);b="";if(a<0){b="-";a=-a}d=a-Math.floor(a);for(a=Math.floor(a);a>0;a=Math.floor(a/1000)){if(a>=1000){c="000"+(a%1000).toString();l.push(c.substr(c.length-3))}else{l.push(a)}}k=(h==null)?0:INTERMediatorLib.toNumber(h);g=(k==0)?"":new String(Math.floor(d*Math.pow(10,k)));while(g.length<k){g="0"+g}return b+l.reverse().join(",")+(g==""?"":"."+g)},objectToString:function(c){var d,b,a;if(c===null){return"null"}if(typeof c=="object"){d="";if(c.constractor===Array){for(b=0;b<c.length;b++){d+=INTERMediatorLib.objectToString(c[b])+", "}return"["+d+"]"}else{for(a in c){d+="'"+a+"':"+INTERMediatorLib.objectToString(c[a])+", "}return"{"+d+"}"}}else{return"'"+c+"'"}},getTargetTableForRetrieve:function(a){if(a.view!=null){return a.view}return a.name},getTargetTableForUpdate:function(a){if(a.table!=null){return a.table}return a.name},getInsertedString:function(b,a){var d,c;d=b;if(a!=null){for(c=1;c<=a.length;c++){d=d.replace("@"+c+"@",a[c-1])}}return d},getInsertedStringFromErrorNumber:function(b,a){var d,c;d=INTERMediatorOnPage.getMessages()[b];if(a!=null){for(c=1;c<=a.length;c++){d=d.replace("@"+c+"@",a[c-1])}}return d},getNamedObject:function(d,c,a){var b;for(b in d){if(d[b][c]==a){return d[b]}}return null},getNamedObjectInObjectArray:function(b,d,a){var c;for(c=0;c<b.length;c++){if(b[c][d]==a){return b[c]}}return null},getNamedValueInObject:function(c,e,b,f){var a=[],d;for(d in c){if(c[d][e]==b){a.push(c[d][f])}}if(a.length===0){return null}else{if(a.length===1){return a[0]}else{return a}}},is_array:function(a){return a&&typeof a==="object"&&typeof a.length==="number"&&typeof a.splice==="function"&&!(a.propertyIsEnumerable("length"))},getNamedValuesInObject:function(c,g,e,f,b,h){var a=[],d;for(d in c){if(c[d][g]==e&&c[d][f]==b){a.push(c[d][h])}}if(a.length===0){return null}else{if(a.length===1){return a[0]}else{return a}}},getRecordsetFromFieldValueObject:function(b){var c={},a;for(a in b){c[b[a]["field"]]=b[a]["value"]}return c},getNodePath:function(a){var b="";if(a.tagName==null){return""}else{return INTERMediatorLib.getNodePath(a.parentNode)+"/"+a.tagName}},getElementsByClassName:function(e,a){var c=[],d=new RegExp(a);b(e);return c;function b(g){if(g.nodeType!=1){return}if(INTERMediatorLib.getClassAttributeFromNode(g)&&INTERMediatorLib.getClassAttributeFromNode(g).match(d)){c.push(g)}for(var f=0;f<g.children.length;f++){b(g.children[f])}}}};if(!Array.indexOf){Array.prototype.indexOf=function(b){var a;for(a=0;a<this.length;a++){if(this[a]===b){return a}}return -1}}var INTERMediatorOnPage;INTERMediatorOnPage={authCountLimit:4,authCount:0,authUser:"",authHashedPassword:"",authUserSalt:"",authUserHexSalt:"",authChallenge:"",requireAuthentication:false,clientId:null,authRequiredContext:null,authStoring:"cookie",authExpired:3600,isOnceAtStarting:true,publickey:null,isNativeAuth:false,httpuser:null,httppasswd:null,mediaToken:null,realm:"",dbCache:{},isEmailAsUsername:false,isShowChangePassword:true,isSetDefaultStyle:true,authPanelTitle:null,getMessages:function(){return null},getURLParametersAsArray:function(){var c,f,e,a,b,d;a={};f=location.search.substring(1).split("&");for(c=0;c<f.length;c++){e=f[c].indexOf("=");if(e>0){b=f[c].substring(0,e);d=f[c].substring(e+1);a[b]=decodeURIComponent(d)}}return a},getContextInfo:function(b){var c,a;c=INTERMediatorOnPage.getDataSources();for(index in c){if(c[index].name==b){return c[index]}}return null},isComplementAuthData:function(){if(this.authUser!=null&&this.authUser.length>0&&this.authHashedPassword!=null&&this.authHashedPassword.length>0&&this.authUserSalt!=null&&this.authUserSalt.length>0&&this.authChallenge!=null&&this.authChallenge.length>0){return true}return false},retrieveAuthInfo:function(){if(this.requireAuthentication){if(this.isOnceAtStarting){switch(this.authStoring){case"cookie":case"cookie-domainwide":this.authUser=this.getCookie("_im_username");this.authHashedPassword=this.getCookie("_im_credential");this.mediaToken=this.getCookie("_im_mediatoken");break;default:this.removeCookie("_im_username");this.removeCookie("_im_credential");this.removeCookie("_im_mediatoken");break}this.isOnceAtStarting=false}if(this.authUser.length>0){if(!INTERMediator_DBAdapter.getChallenge()){INTERMediator.flushMessage()}}}},logout:function(){this.authUser="";this.authHashedPassword="";this.authUserSalt="";this.authChallenge="";this.clientId="";this.removeCookie("_im_username");this.removeCookie("_im_credential");this.removeCookie("_im_mediatoken")},storeCredencialsToCookie:function(){switch(INTERMediatorOnPage.authStoring){case"cookie":INTERMediatorOnPage.setCookie("_im_username",INTERMediatorOnPage.authUser);INTERMediatorOnPage.setCookie("_im_credential",INTERMediatorOnPage.authHashedPassword);if(INTERMediatorOnPage.mediaToken){INTERMediatorOnPage.setCookie("_im_mediatoken",INTERMediatorOnPage.mediaToken)}break;case"cookie-domainwide":INTERMediatorOnPage.setCookieDomainWide("_im_username",INTERMediatorOnPage.authUser);INTERMediatorOnPage.setCookieDomainWide("_im_credential",INTERMediatorOnPage.authHashedPassword);if(INTERMediatorOnPage.mediaToken){INTERMediatorOnPage.setCookieDomainWide("_im_mediatoken",INTERMediatorOnPage.mediaToken)}break}},defaultBackgroundImage:"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAAXNSR0IArs4c6QAAACF0RVh0U29mdHdhcmUAR3JhcGhpY0NvbnZlcnRlciAoSW50ZWwpd4f6GQAAAHRJREFUeJzs0bENAEAMAjHWzBC/f5sxkPIurkcmSV65KQcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAL4AaA9oHwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOA6wAAAA//8DAF3pMFsPzhYWAAAAAElFTkSuQmCC)",defaultBackgroundColor:null,loginPanelHTML:null,authenticating:function(g){var b,h,q,x,k,f,u,e,l,v,m,a,r,d,o,p,c,t,s,w,n;if(this.authCount>this.authCountLimit){this.authenticationError();this.logout();INTERMediator.flushMessage();return}b=document.getElementsByTagName("BODY")[0];h=document.createElement("div");b.insertBefore(h,b.childNodes[0]);h.style.height="100%";h.style.width="100%";if(INTERMediatorOnPage.defaultBackgroundImage){h.style.backgroundImage=INTERMediatorOnPage.defaultBackgroundImage}if(INTERMediatorOnPage.defaultBackgroundColor){h.style.backgroundColor=INTERMediatorOnPage.defaultBackgroundColor}h.style.position="absolute";h.style.padding=" 50px 0 0 0";h.style.top="0";h.style.left="0";h.style.zIndex="999998";if(INTERMediatorOnPage.loginPanelHTML){h.innerHTML=INTERMediatorOnPage.loginPanelHTML;m=document.getElementById("_im_password");u=document.getElementById("_im_username");d=document.getElementById("_im_authbutton");r=document.getElementById("_im_changebutton")}else{q=document.createElement("div");if(INTERMediatorOnPage.isSetDefaultStyle){q.style.width="450px";q.style.backgroundColor="#333333";q.style.color="#DDDDAA";q.style.margin="50px auto 0 auto";q.style.padding="20px";q.style.borderRadius="10px";q.style.position="relative"}q.id="_im_authpanel";h.appendChild(q);o="";if(INTERMediatorOnPage.authPanelTitle&&INTERMediatorOnPage.authPanelTitle.length>0){o=INTERMediatorOnPage.authPanelTitle}else{if(INTERMediatorOnPage.realm&&INTERMediatorOnPage.realm.length>0){o=INTERMediatorOnPage.realm}}if(o&&o.length>0){w=document.createElement("DIV");w.appendChild(document.createTextNode(o));w.style.textAlign="left";q.appendChild(w);a=document.createElement("HR");q.appendChild(a)}x="200px";k=document.createElement("LABEL");q.appendChild(k);f=document.createElement("span");if(INTERMediatorOnPage.isSetDefaultStyle){f.style.width=x;f.style.textAlign="right";f.style.cssFloat="left"}INTERMediatorLib.setClassAttributeToNode(f,"_im_authlabel");k.appendChild(f);e=INTERMediatorOnPage.isEmailAsUsername?2011:2002;f.appendChild(document.createTextNode(INTERMediatorLib.getInsertedStringFromErrorNumber(e)));u=document.createElement("INPUT");u.type="text";u.id="_im_username";u.size="24";u.setAttribute("autocapitalize","off");k.appendChild(u);a=document.createElement("BR");a.clear="all";q.appendChild(a);l=document.createElement("LABEL");q.appendChild(l);v=document.createElement("SPAN");if(INTERMediatorOnPage.isSetDefaultStyle){v.style.minWidth=x;v.style.textAlign="right";v.style.cssFloat="left"}INTERMediatorLib.setClassAttributeToNode(v,"_im_authlabel");l.appendChild(v);v.appendChild(document.createTextNode(INTERMediatorLib.getInsertedStringFromErrorNumber(2003)));m=document.createElement("INPUT");m.type="password";m.id="_im_password";m.size="24";l.appendChild(m);d=document.createElement("BUTTON");d.appendChild(document.createTextNode(INTERMediatorLib.getInsertedStringFromErrorNumber(2004)));q.appendChild(d);a=document.createElement("BR");a.clear="all";q.appendChild(a);if(this.isShowChangePassword&&!INTERMediatorOnPage.isNativeAuth){a=document.createElement("HR");q.appendChild(a);p=document.createElement("LABEL");q.appendChild(p);c=document.createElement("SPAN");if(INTERMediatorOnPage.isSetDefaultStyle){c.style.minWidth=x;c.style.textAlign="right";c.style.cssFloat="left";c.style.fontSize="0.7em";c.style.paddingTop="4px"}INTERMediatorLib.setClassAttributeToNode(c,"_im_authlabel");p.appendChild(c);c.appendChild(document.createTextNode(INTERMediatorLib.getInsertedStringFromErrorNumber(2006)));t=document.createElement("INPUT");t.type="password";t.id="_im_newpassword";t.size="12";p.appendChild(t);r=document.createElement("BUTTON");r.appendChild(document.createTextNode(INTERMediatorLib.getInsertedStringFromErrorNumber(2005)));q.appendChild(r);s=document.createElement("DIV");s.style.textAlign="center";s.style.textSize="10pt";s.style.color="#994433";q.appendChild(s)}}m.onkeydown=function(y){n=(window.event)?window.event.which:y.keyCode;if(n==13){d.onclick()}};u.value=INTERMediatorOnPage.authUser;u.onkeydown=function(y){n=(window.event)?window.event.which:y.keyCode;if(n==13){m.focus()}};d.onclick=function(){var A,y,z;A=document.getElementById("_im_username").value;y=document.getElementById("_im_password").value;INTERMediatorOnPage.authUser=A;b.removeChild(h);if(A!=""&&(INTERMediatorOnPage.authChallenge==null||INTERMediatorOnPage.authChallenge.length<24)){INTERMediatorOnPage.authHashedPassword="need-hash-pls";z=INTERMediator_DBAdapter.getChallenge();if(!z){INTERMediator.flushMessage();return}}if(INTERMediatorOnPage.isNativeAuth){INTERMediatorOnPage.authHashedPassword=INTERMediatorOnPage.publickey.biEncryptedString(y)}else{INTERMediatorOnPage.authHashedPassword=SHA1(y+INTERMediatorOnPage.authUserSalt)+INTERMediatorOnPage.authUserHexSalt}if(INTERMediatorOnPage.authUser.length>0){INTERMediatorOnPage.storeCredencialsToCookie()}g();INTERMediator.flushMessage()};if(r){r.onclick=function(){var E,z,A,B,D,y;E=document.getElementById("_im_username").value;z=document.getElementById("_im_password").value;A=document.getElementById("_im_newpassword").value;if(E===""||z===""||A===""){s.innerHTML=INTERMediatorLib.getInsertedStringFromErrorNumber(2007);return}INTERMediatorOnPage.authUser=E;if(E!=""&&(INTERMediatorOnPage.authChallenge==null||INTERMediatorOnPage.authChallenge.length<24)){INTERMediatorOnPage.authHashedPassword="need-hash-pls";B=INTERMediator_DBAdapter.getChallenge();if(!B){s.innerHTML=INTERMediatorLib.getInsertedStringFromErrorNumber(2008);INTERMediator.flushMessage();return}}INTERMediatorOnPage.authHashedPassword=SHA1(z+INTERMediatorOnPage.authUserSalt)+INTERMediatorOnPage.authUserHexSalt;D="access=changepassword&newpass="+INTERMediatorLib.generatePasswordHash(A);try{y=INTERMediator_DBAdapter.server_access(D,1029,1030)}catch(C){y={newPasswordResult:false}}s.innerHTML=INTERMediatorLib.getInsertedStringFromErrorNumber(y.newPasswordResult===true?2009:2010);INTERMediator.flushMessage()}}window.scroll(0,0);u.focus();INTERMediatorOnPage.authCount++},authenticationError:function(){var c,b,a;INTERMediatorOnPage.hideProgress();c=document.getElementsByTagName("BODY")[0];b=document.createElement("div");c.insertBefore(b,c.childNodes[0]);b.style.height="100%";b.style.width="100%";b.style.backgroundImage="url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAAXNSR0IArs4c6QAAACF0RVh0U29mdHdhcmUAR3JhcGhpY0NvbnZlcnRlciAoSW50ZWwpd4f6GQAAAHlJREFUeJzs0UENACAQA8EzdAl2EIEg3CKjyTGP/TfTur1OuJ2sAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAJwDRAekDAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADzAR4AAAD//wMAkUKRPI/rh/AAAAAASUVORK5CYII=)";b.style.position="absolute";b.style.padding=" 50px 0 0 0";b.style.top="0";b.style.left="0";b.style.zIndex="999999";a=document.createElement("div");a.style.width="240px";a.style.backgroundColor="#333333";a.style.color="#DD6666";a.style.fontSize="16pt";a.style.margin="50px auto 0 auto";a.style.padding="20px 4px 20px 4px";a.style.borderRadius="10px";a.style.position="relatvie";a.style.textAlign="Center";a.onclick=function(){c.removeChild(b)};b.appendChild(a);a.appendChild(document.createTextNode(INTERMediatorLib.getInsertedStringFromErrorNumber(2001)))},INTERMediatorCheckBrowser:function(k){var d,m,h,o,b,c,p,q,f,r,l,a,n,s,g,e;d=INTERMediatorOnPage.browserCompatibility();m=false;h=false;o;for(b in d){if(navigator.userAgent.toUpperCase().indexOf(b.toUpperCase())>-1){m=true;if(d[b] instanceof Object){for(c in d[b]){if(navigator.platform.toUpperCase().indexOf(c.toUpperCase())>-1){h=true;o=d[b][c];break}}}else{h=true;o=d[b];break}}}p=false;if(m&&h){q=parseInt(o);if(navigator.appVersion.indexOf("MSIE")>-1){r=navigator.appVersion.indexOf("MSIE");l=navigator.appVersion.indexOf(".",r);f=parseInt(navigator.appVersion.substring(r+4,l))}else{l=navigator.appVersion.indexOf(".");f=parseInt(navigator.appVersion.substring(0,l))}if(o.indexOf("-")>-1){p=(q>=f)}else{if(o.indexOf("+")>-1){p=(q<=f)}else{p=(q==f)}}if(document.documentMode){p=(q<=document.documentMode)}}if(p){if(k!=null){k.parentNode.removeChild(k)}}else{a=document.getElementsByTagName("BODY")[0];n=document.createElement("div");n.setAttribute("align","center");s=document.createElement("font");s.setAttribute("color","gray");g=document.createElement("font");g.setAttribute("size","+2");g.appendChild(document.createTextNode(INTERMediatorOnPage.getMessages()[1022]));s.appendChild(g);s.appendChild(document.createElement("br"));s.appendChild(document.createTextNode(INTERMediatorOnPage.getMessages()[1023]));s.appendChild(document.createElement("br"));s.appendChild(document.createTextNode(navigator.userAgent));n.appendChild(s);for(e=a.childNodes.length-1;e>=0;e--){a.removeChild(a.childNodes[e])}a.appendChild(n)}return p},getNodeIdFromIMDefinition:function(c,e,a){var b;if(a){b=e}else{b=INTERMediatorLib.getParentRepeater(e)}return d(b,c);function d(l,f){var h,g,m,k;if(l.nodeType!=1){return null}h=l.childNodes;if(h){for(g=0;g<h.length;g++){if(h[g].nodeType==1){if(INTERMediatorLib.isLinkedElement(h[g])){m=INTERMediatorLib.getLinkedElementInfo(h[g]);if(m.indexOf(f)>-1){k=h[g].getAttribute("id");return k}}k=d(h[g],f);if(k!==null){return k}}}}return null}},getNodeIdFromIMDefinitionOnEnclosure:function(b,d){var a;a=INTERMediatorLib.getParentEnclosure(d);return c(a,b);function c(k,e){var g,f,l,h;if(k.nodeType!=1){return null}g=k.childNodes;if(g){for(f=0;f<g.length;f++){if(g[f].nodeType==1){if(INTERMediatorLib.isLinkedElement(g[f])){l=INTERMediatorLib.getLinkedElementInfo(g[f]);if(l.indexOf(e)>-1){h=g[f].getAttribute("id");return h}}h=c(g[f],e);if(h!==null){return h}}}}return null}},getNodeIdsFromIMDefinition:function(c,f,a){var b,d;if(a){b=f}else{b=INTERMediatorLib.getParentEnclosure(f)}if(b!=null){d=[];e(b,c)}return d;function e(n,k){var g,h,m,l;if(n.nodeType!=1){return}m=n.childNodes;if(m){for(l=0;l<m.length;l++){if(m[l].getAttribute!=null){g=m[l].getAttribute("class");h=m[l].getAttribute("title");if((g!=null&&g.indexOf(k)>-1)||(h!=null&&h.indexOf(k)>-1)){d.push(m[l].getAttribute("id"))}}e(m[l],k)}}}},getKeyWithRealm:function(a){if(INTERMediatorOnPage.realm.length>0){return a+"_"+INTERMediatorOnPage.realm}return a},getCookie:function(c){var d,b,a;d=document.cookie.split("; ");a=this.getKeyWithRealm(c);for(b=0;b<d.length;b++){if(d[b].indexOf(a+"=")==0){return decodeURIComponent(d[b].substring(d[b].indexOf("=")+1))}}return""},removeCookie:function(a){document.cookie=this.getKeyWithRealm(a)+"=; path=/; max-age=0; expires=Thu, 1-Jan-1900 00:00:00 GMT;";document.cookie=this.getKeyWithRealm(a)+"=; max-age=0;  expires=Thu, 1-Jan-1900 00:00:00 GMT;"},setCookie:function(a,b){this.setCookieWorker(this.getKeyWithRealm(a),b,false)},setCookieDomainWide:function(a,b){this.setCookieWorker(this.getKeyWithRealm(a),b,true)},setCookieWorker:function(b,f,a){var c;var e=new Date();e.setTime(e.getTime()+INTERMediatorOnPage.authExpired*1000);c=b+"="+encodeURIComponent(f)+(a?";path=/":"")+";max-age="+INTERMediatorOnPage.authExpired+";expires="+e.toGMTString()+";";if(document.URL.substring(0,8)=="https://"){c+="secure;"}document.cookie=c},hideProgress:function(){var a;a=document.getElementById("_im_progress");if(a){a.parentNode.removeChild(a)}},showProgress:function(){var d,b,a,c;b=document.getElementById("_im_progress");if(!b){d=document.getElementsByTagName("BODY")[0];b=document.createElement("div");b.setAttribute("id","_im_progress");b.style.backgroundColor="#000000";b.style.textAlign="center";b.style.width="130px";b.style.height="55px";b.style.left="0";b.style.top="0";b.style.color="#DDDDAA";b.style.fontSize="6px";b.style.position="absolute";b.style.padding="6px";b.style.borderRadius="0 0 10px 0";b.style.borderRight=b.style.borderBottom="solid 4px #779933";b.style.zIndex="999999";if(d.firstChild){d.insertBefore(b,d.firstChild)}else{d.appendChild(b)}c=document.createElement("img");c.setAttribute("src","data:image/gif;base64,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");c.style.marginRight="12px";b.appendChild(c);a=document.createElement("img");a.setAttribute("src","data:image/gif;base64,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");b.appendChild(a);b.appendChild(document.createElement("BR"));b.appendChild(document.createTextNode("INTER-Mediator working"))}}};var IMParts_tinymce={instanciate:function(a){var b=a.getAttribute("id")+"-e";this.ids.push(b);var c=document.createElement("TEXTAREA");c.setAttribute("id",b);INTERMediatorLib.setClassAttributeToNode(c,"_im_tinymce");a.appendChild(c);this.ids.push(b);c._im_getValue=function(){var d=c;return d.value};a._im_getValue=function(){var d=c;return d.value};a._im_getComponentId=function(){var d=b;return d};a._im_setValue=function(e){var d=c;d.innerHTML=e}},ids:[],finish:function(){if(!tinymceOption){tinymceOption={}}tinymceOption.mode="specific_textareas";tinymceOption.editor_selector="_im_tinymce";tinymceOption.elements=this.ids.join(",");tinymceOption.setup=function(c){c.onChange.add(function(d,e){INTERMediator.valueChange(d.id)});c.onKeyDown.add(function(d,e){INTERMediator.keyDown(e)});c.onKeyUp.add(function(d,e){INTERMediator.keyUp(e)})};tinyMCE.init(tinymceOption);for(var a=0;a<this.ids.length;a++){var b=document.getElementById(this.ids[a]);if(b){b._im_getValue=function(){return tinymce.EditorManager.get(this.id).getContent()}}}}};var IMParts_codemirror={instanciate:function(a){var b=a.getAttribute("id")+"-e";var c=document.createElement("TEXTAREA");c.setAttribute("id",b);INTERMediatorLib.setClassAttributeToNode(c,"_im_codemirror");a.appendChild(c);this.ids.push(b);c._im_getValue=function(){var d=c;return d.getValue()};a._im_getValue=function(){var d=c;return d.value};a._im_getComponentId=function(){var d=b;return d};a._im_setValue=function(d){IMParts_codemirror.initialValues[this._im_getComponentId()]=d}},ids:[],initialValues:{},mode:"text/html",finish:function(){for(var b=0;b<this.ids.length;b++){var a=this.ids[b];var d=document.getElementById(a);if(d){var c=CodeMirror.fromTextArea(d,{mode:this.mode});c.setValue(this.initialValues[a]);c.on("change",function(){var e=a;return function(f,g){INTERMediator.valueChange(e)}}());d._im_getValue=function(){var e=c;return function(){return e.getValue()}}()}}}};var IMParts_im_fileupload={html5DDSuported:false,progressSupported:false,forceOldStyleForm:false,uploadId:"sign"+Math.random(),instanciate:function(f){var k,a,c;var d=f.getAttribute("id")+"-e";var m=document.createElement("DIV");INTERMediatorLib.setClassAttributeToNode(m,"_im_fileupload");m.setAttribute("id",d);IMParts_im_fileupload.ids.push(d);if(IMParts_im_fileupload.forceOldStyleForm){IMParts_im_fileupload.html5DDSuported=false}else{IMParts_im_fileupload.html5DDSuported=true;try{var l=new FileReader();var h=new FormData()}catch(g){IMParts_im_fileupload.html5DDSuported=false}}if(IMParts_im_fileupload.html5DDSuported){m.dropzone="copy";m.style.width="200px";m.style.height="100px";m.style.paddingTop="20px";m.style.backgroundColor="#AAAAAA";m.style.border="3px dotted #808080";m.style.textAlign="center";m.style.fontSize="75%";var b=INTERMediatorOnPage.getMessages()[3101].split(/\n/);for(var e=0;e<b.length;e++){if(e>0){m.appendChild(document.createElement("BR"))}m.appendChild(document.createTextNode(b[e]))}}else{a=document.createElement("FORM");a.setAttribute("method","post");a.setAttribute("action",INTERMediatorOnPage.getEntryPath()+"?access=uploadfile");a.setAttribute("enctype","multipart/form-data");m.appendChild(a);if(IMParts_im_fileupload.progressSupported){k=document.createElement("INPUT");k.setAttribute("type","hidden");k.setAttribute("name","APC_UPLOAD_PROGRESS");k.setAttribute("id","progress_key");k.setAttribute("value",IMParts_im_fileupload.uploadId+(IMParts_im_fileupload.ids.length-1));a.appendChild(k)}k=document.createElement("INPUT");k.setAttribute("type","hidden");k.setAttribute("name","_im_redirect");k.setAttribute("value",location.href);a.appendChild(k);k=document.createElement("INPUT");k.setAttribute("type","hidden");k.setAttribute("name","_im_contextnewrecord");k.setAttribute("value","uploadfile");a.appendChild(k);k=document.createElement("INPUT");k.setAttribute("type","hidden");k.setAttribute("name","access");k.setAttribute("value","uploadfile");a.appendChild(k);k=document.createElement("INPUT");k.setAttribute("type","file");k.setAttribute("accept","*/*");k.setAttribute("name","_im_uploadfile");a.appendChild(k);c=document.createElement("BUTTON");c.setAttribute("type","submit");c.appendChild(document.createTextNode(""));a.appendChild(c);IMParts_im_fileupload.formFromId[d]=a}f.appendChild(m);m._im_getValue=function(){var n=m;return n.value};f._im_getValue=function(){var n=m;return n.value};f._im_getComponentId=function(){var n=d;return n};f._im_setValue=function(o){var n=m;if(IMParts_im_fileupload.html5DDSuported){}else{}}},ids:[],formFromId:{},finish:function(){if(IMParts_im_fileupload.html5DDSuported){for(var c=0;c<IMParts_im_fileupload.ids.length;c++){var g=document.getElementById(IMParts_im_fileupload.ids[c]);if(g){INTERMediatorLib.addEvent(g,"dragleave",function(h){h.preventDefault();h.target.style.backgroundColor="#AAAAAA"});INTERMediatorLib.addEvent(g,"dragover",function(h){h.preventDefault();h.target.style.backgroundColor="#AADDFF"});INTERMediatorLib.addEvent(g,"drop",(function(){var h=c;return function(o){var n,p;o.preventDefault();var q=o.currentTarget;if(IMParts_im_fileupload.progressSupported){var m=document.createElement("iframe");m.setAttribute("id","upload_frame"+(IMParts_im_fileupload.ids.length-1));m.setAttribute("name","upload_frame");m.setAttribute("frameborder","0");m.setAttribute("border","0");m.setAttribute("scrolling","no");m.setAttribute("scrollbar","no");m.style.width="100%";m.style.height="24px";q.appendChild(m)}for(var l=0;l<o.dataTransfer.files.length;l++){n=o.dataTransfer.files[l];p=document.createElement("DIV");p.appendChild(document.createTextNode(INTERMediatorOnPage.getMessages()[3102]+n.name));p.style.marginTop="20px";p.style.backgroundColor="#FFFFFF";p.style.textAlign="center";o.target.appendChild(p)}var k=INTERMediator.updateRequiredObject[q.getAttribute("id")];if(IMParts_im_fileupload.progressSupported){m.style.display="block";setTimeout(function(){m.setAttribute("src","upload_frame.php?up_id="+IMParts_im_fileupload.uploadId+h)})}INTERMediator_DBAdapter.uploadFile("&_im_contextname="+encodeURIComponent(k.name)+"&_im_field="+encodeURIComponent(k.field)+"&_im_keyfield="+encodeURIComponent(k.keying.split("=")[0])+"&_im_keyvalue="+encodeURIComponent(k.keying.split("=")[1])+"&_im_contextnewrecord="+encodeURIComponent("uploadfile")+(IMParts_im_fileupload.progressSupported?("&APC_UPLOAD_PROGRESS="+encodeURIComponent(IMParts_im_fileupload.uploadId+h)):""),{fileName:n.name,content:n},function(){var u=true;var t=INTERMediatorLib.getNamedObject(INTERMediatorOnPage.getDataSources(),"name",k.name);if(t["file-upload"]){var s="";for(var r=0;r<t["file-upload"].length;r++){if(t["file-upload"][r]["field"]==k.field){s=t["file-upload"][r]["context"];break}}for(var r=0;r<INTERMediator.keyFieldObject.length;r++){if(INTERMediator.keyFieldObject[r]["name"]==s){u=r;break}}}else{for(var r=0;r<INTERMediator.keyFieldObject.length;r++){if(INTERMediator.keyFieldObject[r]["name"]==k.name){u=r;break}}}INTERMediator.construct(u)})}})())}}}else{for(var c=0;c<IMParts_im_fileupload.ids.length;c++){var g=document.getElementById(IMParts_im_fileupload.ids[c]);if(g){var b=INTERMediator.updateRequiredObject[IMParts_im_fileupload.ids[c]];var f=g.getElementsByTagName("FORM")[0];var e=document.createElement("INPUT");e.setAttribute("type","hidden");e.setAttribute("name","_im_contextname");e.setAttribute("value",b.name);f.appendChild(e);e=document.createElement("INPUT");e.setAttribute("type","hidden");e.setAttribute("name","_im_field");e.setAttribute("value",b.field);f.appendChild(e);e=document.createElement("INPUT");e.setAttribute("type","hidden");e.setAttribute("name","_im_keyfield");e.setAttribute("value",b.keying.split("=")[0]);f.appendChild(e);e=document.createElement("INPUT");e.setAttribute("type","hidden");e.setAttribute("name","_im_keyvalue");e.setAttribute("value",b.keying.split("=")[1]);f.appendChild(e);e=document.createElement("INPUT");e.setAttribute("type","hidden");e.setAttribute("name","clientid");if(INTERMediatorOnPage.authUser.length>0){e.value=INTERMediatorOnPage.clientId}f.appendChild(e);e=document.createElement("INPUT");e.setAttribute("type","hidden");e.setAttribute("name","authuser");if(INTERMediatorOnPage.authUser.length>0){e.value=INTERMediatorOnPage.authUser}f.appendChild(e);e=document.createElement("INPUT");e.setAttribute("type","hidden");e.setAttribute("name","response");if(INTERMediatorOnPage.authUser.length>0){if(INTERMediatorOnPage.isNativeAuth){thisForm.elements.response.value=INTERMediatorOnPage.publickey.biEncryptedString(INTERMediatorOnPage.authHashedPassword+"\n"+INTERMediatorOnPage.authChallenge)}else{if(INTERMediatorOnPage.authHashedPassword&&INTERMediatorOnPage.authChallenge){shaObj=new jsSHA(INTERMediatorOnPage.authHashedPassword,"ASCII");hmacValue=shaObj.getHMAC(INTERMediatorOnPage.authChallenge,"ASCII","SHA-256","HEX");e.value=hmacValue}else{e.value="dummy"}}}f.appendChild(e);if(IMParts_im_fileupload.progressSupported){e=document.createElement("iframe");e.setAttribute("id","upload_frame"+c);e.setAttribute("name","upload_frame");e.setAttribute("frameborder","0");e.setAttribute("border","0");e.setAttribute("scrolling","no");e.setAttribute("scrollbar","no");f.appendChild(e);INTERMediatorLib.addEvent(f,"submit",(function(){var h=c;return function(l){var k=document.getElementById("upload_frame"+h);k.style.display="block";setTimeout(function(){var m=d()+"?uploadprocess="+IMParts_im_fileupload.uploadId+h;k.setAttribute("src",m)});return true}})())}}}}function d(){var k=document.getElementsByTagName("SCRIPT");for(var l=0;l<k.length;l++){var h=k[l].getAttribute("src");if(h.match(/\.php/)){return h}}return null}function a(m,o){var k,h,n,p;var l=INTERMediatorLib.getNamedObject(INTERMediatorOnPage.getDataSources(),"name",m.name);if(l["file-upload"]){for(k in l["file-upload"]){if(l["file-upload"][k]["field"]==m.field){p=INTERMediatorLib.getNamedObject(INTERMediatorOnPage.getDataSources(),"name",l["file-upload"][k]["context"]);n=[{field:"path",value:o}];if(p.relation){for(h in p.relation){n.push({field:p.relation[h]["foreign-key"],value:m.keying.split("=")[1]})}}if(p.query){for(h in p.query){n.push({field:p.query[h]["field"],value:p.query[h]["value"]})}}INTERMediator_DBAdapter.db_createRecord({name:l["file-upload"][k]["context"],dataset:n})}}}}}};var INTERMediator={debugMode:false,separator:"@",defDivider:"|",additionalCondition:{},additionalSortKey:{},defaultTargetInnerHTML:false,navigationLabel:null,startFrom:0,elementIds:[],widgetElementIds:[],radioNameMode:false,dontSelectRadioCheck:false,ignoreOptimisticLocking:false,supressDebugMessageOnPage:false,supressErrorMessageOnPage:false,additionalFieldValueOnNewRecord:{},additionalFieldValueOnUpdate:{},additionalFieldValueOnDelete:{},waitSecondsAfterPostMessage:4,pagedSize:0,pagedAllCount:0,currentEncNumber:0,isIE:false,ieVersion:-1,titleAsLinkInfo:true,classAsLinkInfo:true,noRecordClassName:"_im_for_noresult_",updateRequiredObject:null,keyFieldObject:null,rootEnclosure:null,errorMessages:[],debugMessages:[],deleteInsertOnNavi:[],setDebugMessage:function(a,b){if(b===undefined){b=1}if(INTERMediator.debugMode>=b){INTERMediator.debugMessages.push(a);if(typeof console!="undefined"){console.log("INTER-Mediator[DEBUG:%s]: %s",new Date(),a)}}},setErrorMessage:function(a,b){b=b===undefined?"":(" - "+b);if((typeof a=="string"||a instanceof String)){INTERMediator.errorMessages.push(a+b);if(typeof console!="undefined"){console.error("INTER-Mediator[ERROR]: %s",a+b)}}else{if(a.message){INTERMediator.errorMessages.push(a.message+b);if(typeof console!="undefined"){console.error("INTER-Mediator[ERROR]: %s",a.message+b)}}if(a.stack&&typeof console!="undefined"){console.error(a.stack)}}},flushMessage:function(){var h,k,e,c,b,l,a,d,f;if(!INTERMediator.supressErrorMessageOnPage&&INTERMediator.errorMessages.length>0){h=document.getElementById("_im_error_panel_4873643897897");if(h==null){h=document.createElement("div");h.setAttribute("id","_im_error_panel_4873643897897");h.style.backgroundColor="#FFDDDD";k=document.createElement("h3");k.appendChild(document.createTextNode("Error Info from INTER-Mediator"));k.appendChild(document.createElement("hr"));h.appendChild(k);e=document.getElementsByTagName("body")[0];e.insertBefore(h,e.firstChild)}h.appendChild(document.createTextNode("============ERROR MESSAGE on "+new Date()+"============"));h.appendChild(document.createElement("hr"));for(c=0;c<INTERMediator.errorMessages.length;c++){l=INTERMediator.errorMessages[c].split("\n");for(b=0;b<l.length;b++){if(b>0){h.appendChild(document.createElement("br"))}h.appendChild(document.createTextNode(l[b]))}h.appendChild(document.createElement("hr"))}}if(!INTERMediator.supressDebugMessageOnPage&&INTERMediator.debugMode&&INTERMediator.debugMessages.length>0){h=document.getElementById("_im_debug_panel_4873643897897");if(h==null){h=document.createElement("div");h.setAttribute("id","_im_debug_panel_4873643897897");h.style.backgroundColor="#DDDDDD";a=document.createElement("button");a.setAttribute("title","clear");INTERMediatorLib.addEvent(a,"click",function(){f=document.getElementById("_im_debug_panel_4873643897897");f.parentNode.removeChild(f)});d=document.createTextNode("clear");a.appendChild(d);k=document.createElement("h3");k.appendChild(document.createTextNode("Debug Info from INTER-Mediator"));k.appendChild(a);k.appendChild(document.createElement("hr"));h.appendChild(k);e=document.getElementsByTagName("body")[0];if(e){if(e.firstChild){e.insertBefore(h,e.firstChild)}else{e.appendChild(h)}}}h.appendChild(document.createTextNode("============DEBUG INFO on "+new Date()+"============ "));var g=document.createElement("a");g.setAttribute("href",INTERMediatorOnPage.getEditorPath());g.appendChild(document.createTextNode("Definition File Editor"));h.appendChild(g);h.appendChild(document.createElement("hr"));for(c=0;c<INTERMediator.debugMessages.length;c++){l=INTERMediator.debugMessages[c].split("\n");for(b=0;b<l.length;b++){if(b>0){h.appendChild(document.createElement("br"))}h.appendChild(document.createTextNode(l[b]))}h.appendChild(document.createElement("hr"))}}INTERMediator.errorMessages=[];INTERMediator.debugMessages=[]},isShiftKeyDown:false,isControlKeyDown:false,keyDown:function(a){var b=(window.event)?a.which:a.keyCode;if(b==16){INTERMediator.isShiftKeyDown=true}if(b==17){INTERMediator.isControlKeyDown=true}},keyUp:function(a){var b=(window.event)?a.which:a.keyCode;if(b==16){INTERMediator.isShiftKeyDown=false}if(b==17){INTERMediator.isControlKeyDown=false}},valueChange:function(idValue){var changedObj,linkInfo,matched,context,i,index,checkFunction,target,value,result;if(INTERMediator.isShiftKeyDown&&INTERMediator.isControlKeyDown){INTERMediator.setDebugMessage("Canceled to update the value with shift+control keys.");INTERMediator.flushMessage();INTERMediator.isShiftKeyDown=false;INTERMediator.isControlKeyDown=false;return}INTERMediator.isShiftKeyDown=false;INTERMediator.isControlKeyDown=false;changedObj=document.getElementById(idValue);linkInfo=INTERMediatorLib.getLinkedElementInfo(changedObj);if(linkInfo.length>0){matched=linkInfo[0].match(/([^@]+)/);context=INTERMediatorLib.getNamedObject(INTERMediatorOnPage.getDataSources(),"name",matched[1]);if(context.validation!=null){for(i=0;i<linkInfo.length;i++){matched=linkInfo[i].match(/([^@]+)@([^@]+)/);for(index in context.validation){if(context.validation[index]["field"]==matched[2]){checkFunction=function(){target=changedObj;value=changedObj.value;result=false;eval("result = "+context.validation[index]["rule"]);if(!result){alert(context.validation[index]["message"]);changedObj.value=INTERMediator.updateRequiredObject[idValue]["initialvalue"];changedObj.focus();if(INTERMediatorOnPage.doAfterValidationFailure!=null){INTERMediatorOnPage.doAfterValidationFailure(target,linkInfo[i])}}else{if(INTERMediatorOnPage.doAfterValidationSucceed!=null){INTERMediatorOnPage.doAfterValidationSucceed(target,linkInfo[i])}}return result};if(!checkFunction()){return}}}}}}if(changedObj!=null){if(INTERMediatorOnPage.getOptionsTransaction()=="none"){INTERMediator.updateRequiredObject[idValue]["edit"]=true}else{INTERMediator.updateDB(idValue);INTERMediator.flushMessage()}}},updateDB:function(D){var o=null,E,q,w,s,A,n,t,b,f,l,h,C,B,y,x,v,u,a,m,e,p,r,d=null,g,c=null;E=document.getElementById(D);if(E!=null){INTERMediatorOnPage.showProgress();INTERMediatorOnPage.retrieveAuthInfo();q=E.getAttribute("type");if(q=="radio"&&!E.checked){return}w=INTERMediator.updateRequiredObject[D];if(!INTERMediator.ignoreOptimisticLocking){s=w.keying.split("=");A=s[0];s.shift();n=s.join("=");p=w.foreignfield.split("=");if(p[1]!=""){r=p[0];p.shift();d=p.join("=");u={name:w.name,records:1,paging:w.paging,fields:[w.field],parentkeyvalue:null,conditions:[{field:A,operator:"=",value:n},{field:r,operator:"=",value:d}],useoffset:false,primaryKeyOnly:true}}else{u={name:w.name,records:1,paging:w.paging,fields:[w.field],parentkeyvalue:null,conditions:[{field:A,operator:"=",value:n}],useoffset:false,primaryKeyOnly:true}}try{t=INTERMediator_DBAdapter.db_query(u)}catch(z){if(z=="_im_requath_request_"){if(INTERMediatorOnPage.requireAuthentication&&!INTERMediatorOnPage.isComplementAuthData()){INTERMediatorOnPage.authChallenge=null;INTERMediatorOnPage.authHashedPassword=null;INTERMediatorOnPage.authenticating(function(){INTERMediator.db_query(u)});return}}else{INTERMediator.setErrorMessage(z,"EXCEPTION-1")}}if(t.recordset==null||t.recordset[0]==null||t.recordset[0][w.field]==null){alert(INTERMediatorLib.getInsertedString(INTERMediatorOnPage.getMessages()[1003],[w.field]));return}if(t.count>1){b=confirm(INTERMediatorOnPage.getMessages()[1024]);if(!b){return}}t=t.recordset[0][w.field];f=(w.initialvalue!=t)}if(INTERMediator.widgetElementIds.indexOf(E.getAttribute("id"))>-1){o=E._im_getValue()}else{if(E.tagName=="TEXTAREA"){o=E.value}else{if(E.tagName=="SELECT"){o=E.value;if(E.firstChild.value==""){E.removeChild(E.firstChild)}}else{if(E.tagName=="INPUT"){if(q!=null){if(q=="checkbox"){a=INTERMediatorOnPage.getDBSpecification();if(a["db-class"]!=null&&a["db-class"]=="FileMaker_FX"){m=[];e=E.parentNode.getElementsByTagName("INPUT");for(v=0;v<e.length;v++){if(e[v].checked){m.push(e[v].getAttribute("value"))}}o=m.join("\n");f=(o==t)}else{l=E.getAttribute("value");if(E.checked){o=l;f=(l==t)}else{o="";f=(l!=t)}}}else{if(q=="radio"){o=E.value}else{o=E.value}}}}}}}}if(f&&!INTERMediator.ignoreOptimisticLocking){if(!confirm(INTERMediatorLib.getInsertedString(INTERMediatorOnPage.getMessages()[1001],[w.initialvalue,o,t]))){return}INTERMediatorOnPage.retrieveAuthInfo()}if(o!=null){h=w.keying.split("=");g=w.foreignfield.split("=");try{if(g[1]==""){INTERMediator_DBAdapter.db_update({name:w.name,conditions:[{field:h[0],operator:"=",value:h[1]}],dataset:[{field:w.field,value:o}]})}else{INTERMediator_DBAdapter.db_update({name:w.name,conditions:[{field:h[0],operator:"=",value:h[1]}],dataset:[{field:w.field+"."+g[1],value:o}]})}}catch(z){if(z=="_im_requath_request_"){if(z=="_im_requath_request_"){if(INTERMediatorOnPage.requireAuthentication&&!INTERMediatorOnPage.isComplementAuthData()){INTERMediatorOnPage.authChallenge=null;INTERMediatorOnPage.authHashedPassword=null;INTERMediatorOnPage.authenticating(function(){INTERMediator.updateDB(D)});return}}}else{INTERMediator.setErrorMessage(z,"EXCEPTION-2")}}if(E.tagName=="INPUT"&&q=="radio"){for(y in INTERMediator.updateRequiredObject){if(INTERMediator.updateRequiredObject[y]["field"]==w.field&&INTERMediator.updateRequiredObject[y]["keying"]==w.keying){INTERMediator.updateRequiredObject[y]["initialvalue"]=o}}}else{w.initialvalue=o}C=w.updatenodeid;B=false;for(y=0;y<INTERMediator.keyFieldObject.length;y++){for(x=0;x<INTERMediator.keyFieldObject[y]["target"].length;x++){if(INTERMediator.keyFieldObject[y]["target"][x]==D){B=true}}}if(B){for(y=0;y<INTERMediator.keyFieldObject.length;y++){if(INTERMediator.keyFieldObject[y]["node"].getAttribute("id")==C){INTERMediator.constructMain(y);break}}}}INTERMediatorOnPage.hideProgress()},deleteButton:function(f,d,e,b,c,k,g){var l,a;if(g){if(!confirm(INTERMediatorOnPage.getMessages()[1025])){return}}INTERMediatorOnPage.showProgress();try{INTERMediatorOnPage.retrieveAuthInfo();if(b!=""){INTERMediator_DBAdapter.db_update({name:f,conditions:[{field:d,operator:"=",value:e}],dataset:[{field:"-delete.related",operator:"=",value:b.replace("::-recid","")+"."+c}]})}else{INTERMediator_DBAdapter.db_delete({name:f,conditions:[{field:d,operator:"=",value:e}]})}}catch(h){if(h=="_im_requath_request_"){if(INTERMediatorOnPage.requireAuthentication&&!INTERMediatorOnPage.isComplementAuthData()){INTERMediatorOnPage.authChallenge=null;INTERMediatorOnPage.authHashedPassword=null;INTERMediatorOnPage.authenticating(function(){INTERMediator.deleteButton(f,d,e,b,c,k,false)});return}}else{INTERMediator.setErrorMessage(h,"EXCEPTION-3")}}for(l in k){a=document.getElementById(k[l]);try{a.parentNode.removeChild(a)}catch(h){}}INTERMediatorOnPage.hideProgress();INTERMediator.flushMessage()},insertButton:function(g,o,n,f,m,d){var b,h,c,u,p,q,l,s,t,e,a,k=false;if(d){if(!confirm(INTERMediatorOnPage.getMessages()[1026])){return}}INTERMediatorOnPage.showProgress();b=INTERMediatorLib.getNamedObject(INTERMediatorOnPage.getDataSources(),"name",g);h=[],relatedRecordSet=[];if(n!=null){for(c in b.relation){h.push({field:b.relation[c]["foreign-key"],value:n[b.relation[c]["join-field"]]})}}try{INTERMediatorOnPage.retrieveAuthInfo();l=b.relation;if(l){for(c in l){if(l[c]["portal"]==true){b.portal=true}}}if(b.portal==true){relatedRecordSet=[];for(c in b["default-values"]){relatedRecordSet.push({field:g+"::"+b["default-values"][c]["field"]+".0",value:b["default-values"][c]["value"]})}if(relatedRecordSet.length==0){a="";s=INTERMediator_DBAdapter.db_query({name:g,records:1,conditions:[{field:b.key?b.key:"-recid",operator:"=",value:o}]});for(t in s.recordset[0][0]){if(t.indexOf(g+"::")>-1){k=true;e=t;if(t==g+"::"+h[0]["field"]){a=h[0]["value"];break}if(t!=g+"::id"&&t!=g+"::"+h[0]["field"]){break}}}if(k==false){s=INTERMediator_DBAdapter.db_query({name:g,records:0,conditions:[{field:b.key?b.key:"-recid",operator:"=",value:o}]});for(t in s.recordset){if(t.indexOf(g+"::")>-1){e=t;if(t==g+"::"+h[0]["field"]){a=h[0]["value"];break}if(t!=g+"::id"&&t!=g+"::"+h[0]["field"]){break}}}}relatedRecordSet.push({field:e+".0",value:a})}INTERMediator_DBAdapter.db_update({name:g,conditions:[{field:b.key?b.key:"-recid",operator:"=",value:o}],dataset:relatedRecordSet})}else{INTERMediator_DBAdapter.db_createRecord({name:g,dataset:h})}}catch(r){if(r=="_im_requath_request_"){INTERMediatorOnPage.authChallenge=null;INTERMediatorOnPage.authHashedPassword=null;INTERMediatorOnPage.authenticating(function(){INTERMediator.insertButton(g,o,n,f,m,false)});INTERMediator.flushMessage();return}else{INTERMediator.setErrorMessage(r,"EXCEPTION-4")}}for(u in m){p=document.getElementById(m[u]);try{p.parentNode.removeChild(p)}catch(r){}}for(q=0;q<INTERMediator.keyFieldObject.length;q++){if(INTERMediator.keyFieldObject[q]["node"].getAttribute("id")==f){INTERMediator.keyFieldObject[q]["foreign-value"]=n;if(b.portal==true&&k==false){INTERMediator.additionalCondition[g]={field:b.key?b.key:"-recid",operator:"=",value:o}}INTERMediator.constructMain(q);break}}INTERMediatorOnPage.hideProgress();INTERMediator.flushMessage()},insertRecordFromNavi:function(e,d,f){var l,b,a,c,k,g;if(f){if(!confirm(INTERMediatorOnPage.getMessages()[1026])){return}}INTERMediatorOnPage.showProgress();b=INTERMediatorOnPage.getDataSources();a=null;for(l in b){if(b[l]["name"]==e){a=l;break}}if(a===null){alert("no targetname :"+e);return}try{INTERMediatorOnPage.retrieveAuthInfo();c=INTERMediator_DBAdapter.db_createRecord({name:e,dataset:[]})}catch(h){if(h=="_im_requath_request_"){if(INTERMediatorOnPage.requireAuthentication){if(!INTERMediatorOnPage.isComplementAuthData()){INTERMediatorOnPage.authChallenge=null;INTERMediatorOnPage.authHashedPassword=null;INTERMediatorOnPage.authenticating(function(){INTERMediator.insertRecordFromNavi(e,d,f)});INTERMediator.flushMessage();return}}}else{INTERMediator.setErrorMessage(h,"EXCEPTION-5")}}if(c>-1){k=INTERMediator.additionalCondition;INTERMediator.startFrom=0;g={field:d,value:c};if(b[a]["records"]<=1){INTERMediator.additionalCondition={};INTERMediator.additionalCondition[e]=g}INTERMediator.constructMain(true);INTERMediator.additionalCondition=k}INTERMediatorOnPage.hideProgress();INTERMediator.flushMessage()},deleteRecordFromNavi:function(b,e,d,c){if(c){if(!confirm(INTERMediatorOnPage.getMessages()[1026])){return}}INTERMediatorOnPage.showProgress();try{INTERMediatorOnPage.retrieveAuthInfo();INTERMediator_DBAdapter.db_delete({name:b,conditions:[{field:e,operator:"=",value:d}]})}catch(a){if(a=="_im_requath_request_"){INTERMediatorOnPage.authChallenge=null;INTERMediatorOnPage.authHashedPassword=null;INTERMediatorOnPage.authenticating(function(){INTERMediator.deleteRecordFromNavi(b,e,d,c)});INTERMediator.flushMessage();return}else{INTERMediator.setErrorMessage(a,"EXCEPTION-6")}}if(INTERMediator.pagedAllCount-INTERMediator.startFrom<2){INTERMediator.startFrom--;if(INTERMediator.startFrom<0){INTERMediator.startFrom=0}}INTERMediator.constructMain(true);INTERMediatorOnPage.hideProgress();INTERMediator.flushMessage()},saveRecordFromNavi:function(){var a;for(a in INTERMediator.updateRequiredObject){if(INTERMediator.updateRequiredObject[a]["edit"]){INTERMediator.updateDB(a)}}INTERMediator.flushMessage()},partialConstructing:false,objectReference:{},linkedElmCounter:0,clickPostOnlyButton:function(node){var i,j,fieldData,elementInfo,comp,contextCount,selectedContext,contextInfo,validationInfo;var mergedValues,inputNodes,typeAttr,k,target,value,result,alertmessage;var linkedNodes,namedNodes;var targetNode=node.parentNode;while(!INTERMediatorLib.isEnclosure(targetNode,true)){targetNode=targetNode.parentNode;if(!targetNode){return}}linkedNodes=[];namedNodes=[];for(i=0;i<targetNode.childNodes.length;i++){seekLinkedElement(targetNode.childNodes[i])}contextCount={};for(i=0;i<linkedNodes.length;i++){elementInfo=INTERMediatorLib.getLinkedElementInfo(linkedNodes[i]);for(j=0;j<elementInfo.length;j++){comp=elementInfo[j].split(INTERMediator.separator);if(!contextCount[comp[j]]){contextCount[comp[j]]=0}contextCount[comp[j]]++}}if(contextCount.length<1){return}var maxCount=-100;for(var contextName in contextCount){if(maxCount<contextCount[contextName]){maxCount=contextCount[contextName];selectedContext=contextName;contextInfo=INTERMediatorOnPage.getContextInfo(contextName)}}alertmessage="";fieldData=[];for(i=0;i<linkedNodes.length;i++){elementInfo=INTERMediatorLib.getLinkedElementInfo(linkedNodes[i]);for(j=0;j<elementInfo.length;j++){comp=elementInfo[j].split(INTERMediator.separator);if(comp[0]==selectedContext){if(contextInfo.validation){for(index in contextInfo.validation){validationInfo=contextInfo.validation[index];if(validationInfo.field==comp[1]){if(validationInfo){target=linkedNodes[i];value=linkedNodes[i].value;result=false;eval("result = "+validationInfo.rule);if(!result){alertmessage+=validationInfo.message;alertmessage+="\n"}}}}}if(INTERMediatorLib.isWidgetElement(linkedNodes[i])){fieldData.push({field:comp[1],value:linkedNodes[i]._im_getValue()})}else{if(linkedNodes[i].tagName=="SELECT"){fieldData.push({field:comp[1],value:linkedNodes[i].value})}else{if(linkedNodes[i].tagName=="TEXTAREA"){fieldData.push({field:comp[1],value:linkedNodes[i].value})}else{if(linkedNodes[i].tagName=="INPUT"){if((linkedNodes[i].getAttribute("type")=="radio")||(linkedNodes[i].getAttribute("type")=="checkbox")){if(linkedNodes[i].checked){fieldData.push({field:comp[1],value:linkedNodes[i].value})}}else{fieldData.push({field:comp[1],value:linkedNodes[i].value})}}}}}}}}for(i=0;i<namedNodes.length;i++){elementInfo=INTERMediatorLib.getNamedInfo(namedNodes[i]);for(j=0;j<elementInfo.length;j++){comp=elementInfo[j].split(INTERMediator.separator);if(comp[0]==selectedContext){mergedValues=[];inputNodes=namedNodes[i].getElementsByTagName("INPUT");for(k=0;k<inputNodes.length;k++){typeAttr=inputNodes[k].getAttribute("type");if(typeAttr=="radio"||typeAttr=="checkbox"){if(inputNodes[k].checked){mergedValues.push(inputNodes[k].value)}}else{mergedValues.push(inputNodes[k].value)}}fieldData.push({field:comp[1],value:mergedValues.join("\n")+"\n"})}}}if(alertmessage.length>0){window.alert(alertmessage);return}if(INTERMediatorOnPage.processingBeforePostOnlyContext){if(!INTERMediatorOnPage.processingBeforePostOnlyContext(targetNode)){return}}contextInfo=INTERMediatorLib.getNamedObject(INTERMediatorOnPage.getDataSources(),"name",selectedContext);INTERMediator_DBAdapter.db_createRecordWithAuth({name:selectedContext,dataset:fieldData},function(returnValue){var newNode,parentOfTarget,targetNode=node,thisContext=contextInfo,isSetMsg=false;INTERMediator.flushMessage();if(INTERMediatorOnPage.processingAfterPostOnlyContext){INTERMediatorOnPage.processingAfterPostOnlyContext(targetNode)}if(thisContext["post-dismiss-message"]){parentOfTarget=targetNode.parentNode;parentOfTarget.removeChild(targetNode);newNode=document.createElement("SPAN");INTERMediatorLib.setClassAttributeToNode(newNode,"IM_POSTMESSAGE");newNode.appendChild(document.createTextNode(thisContext["post-dismiss-message"]));parentOfTarget.appendChild(newNode);isSetMsg=true}if(thisContext["post-reconstruct"]){setTimeout(function(){INTERMediator.construct(true)},isSetMsg?INTERMediator.waitSecondsAfterPostMessage*1000:0)}if(thisContext["post-move-url"]){setTimeout(function(){location.href=thisContext["post-move-url"]},isSetMsg?INTERMediator.waitSecondsAfterPostMessage*1000:0)}});function seekLinkedElement(node){var children,i;if(node.nodeType===1){if(INTERMediatorLib.isLinkedElement(node)){linkedNodes.push(node)}else{if(INTERMediatorLib.isWidgetElement(node)){linkedNodes.push(node)}else{if(INTERMediatorLib.isNamedElement(node)){namedNodes.push(node)}else{children=node.childNodes;for(i=0;i<children.length;i++){seekLinkedElement(children[i])}}}}}}},construct:function(b){var a;INTERMediatorOnPage.showProgress();if(b===true||b===undefined){a="INTERMediator.constructMain(true)"}else{a="INTERMediator.constructMain("+b+")"}setTimeout(a,0)},constructMain:function(indexOfKeyFieldObject){var i,theNode,currentLevel=0,postSetFields=[],buttonIdNum=1,eventListenerPostAdding=[],isInsidePostOnly,nameAttrCounter=1;INTERMediator.deleteInsertOnNavi=[];INTERMediatorOnPage.retrieveAuthInfo();try{if(indexOfKeyFieldObject===true||indexOfKeyFieldObject===undefined){this.partialConstructing=false;pageConstruct()}else{this.partialConstructing=true;partialConstruct(indexOfKeyFieldObject)}}catch(ex){if(ex=="_im_requath_request_"){if(INTERMediatorOnPage.requireAuthentication){if(!INTERMediatorOnPage.isComplementAuthData()){INTERMediatorOnPage.authChallenge=null;INTERMediatorOnPage.authHashedPassword=null;INTERMediatorOnPage.authenticating(function(){INTERMediator.constructMain(indexOfKeyFieldObject)});return}}}else{INTERMediator.setErrorMessage(ex,"EXCEPTION-7")}}INTERMediatorOnPage.hideProgress();for(i=0;i<eventListenerPostAdding.length;i++){theNode=document.getElementById(eventListenerPostAdding[i].id);if(theNode){INTERMediatorLib.addEvent(theNode,eventListenerPostAdding[i].event,eventListenerPostAdding[i].todo)}}if(INTERMediatorOnPage.doAfterConstruct){INTERMediatorOnPage.doAfterConstruct()}INTERMediator.flushMessage();function partialConstruct(indexOfKeyFieldObject){var updateNode,originalNodes,i,beforeKeyFieldObjectCount,currentNode,currentID,enclosure,field,targetNode;isInsidePostOnly=false;updateNode=INTERMediator.keyFieldObject[indexOfKeyFieldObject]["node"];while(updateNode.firstChild){updateNode.removeChild(updateNode.firstChild)}originalNodes=INTERMediator.keyFieldObject[indexOfKeyFieldObject]["original"];for(i=0;i<originalNodes.length;i++){updateNode.appendChild(originalNodes[i])}beforeKeyFieldObjectCount=INTERMediator.keyFieldObject.length;postSetFields=[];try{seekEnclosureNode(updateNode,INTERMediator.keyFieldObject[indexOfKeyFieldObject]["foreign-value"],INTERMediator.keyFieldObject[indexOfKeyFieldObject]["name"],INTERMediatorLib.getEnclosureSimple(updateNode),null)}catch(ex){if(ex=="_im_requath_request_"){throw ex}else{INTERMediator.setErrorMessage(ex,"EXCEPTION-8")}}for(i=0;i<postSetFields.length;i++){document.getElementById(postSetFields[i]["id"]).value=postSetFields[i]["value"]}for(i=beforeKeyFieldObjectCount+1;i<INTERMediator.keyFieldObject.length;i++){currentNode=INTERMediator.keyFieldObject[i];currentID=currentNode.node.getAttribute("id");if(currentNode.target==null){if(currentID!=null&&currentID.match(/IM[0-9]+-[0-9]+/)){enclosure=INTERMediatorLib.getParentRepeater(currentNode.node)}else{enclosure=INTERMediatorLib.getParentRepeater(INTERMediatorLib.getParentEnclosure(currentNode.node))}if(enclosure!=null){for(field in currentNode["foreign-value"]){targetNode=getEnclosedNode(enclosure,currentNode.name,field);if(targetNode){currentNode.target=targetNode.getAttribute("id")}}}}}}function pageConstruct(){var ua,msiePos,i,c,bodyNode,currentNode,currentID,enclosure,targetNode,emptyElement;INTERMediator.keyFieldObject=[];INTERMediator.updateRequiredObject={};INTERMediator.currentEncNumber=1;INTERMediator.elementIds=[];INTERMediator.widgetElementIds=[];isInsidePostOnly=false;ua=navigator.userAgent;msiePos=ua.toLocaleUpperCase().indexOf("MSIE");if(msiePos>=0){INTERMediator.isIE=true;for(i=msiePos+4;i<ua.length;i++){c=ua.charAt(i);if(c!=" "&&c!="."&&(c<"0"||c>"9")){INTERMediator.ieVersion=INTERMediatorLib.toNumber(ua.substring(msiePos+4,i));break}}}bodyNode=document.getElementsByTagName("BODY")[0];if(INTERMediator.rootEnclosure==null){INTERMediator.rootEnclosure=bodyNode.innerHTML}else{bodyNode.innerHTML=INTERMediator.rootEnclosure}postSetFields=[];try{seekEnclosureNode(bodyNode,null,null,null,null)}catch(ex){if(ex=="_im_requath_request_"){throw ex}else{INTERMediator.setErrorMessage(ex,"EXCEPTION-9")}}for(i=0;i<postSetFields.length;i++){if(postSetFields[i]["value"]==""&&document.getElementById(postSetFields[i]["id"]).tagName=="SELECT"){emptyElement=document.createElement("option");emptyElement.setAttribute("value","");document.getElementById(postSetFields[i]["id"]).insertBefore(emptyElement,document.getElementById(postSetFields[i]["id"]).firstChild)}document.getElementById(postSetFields[i]["id"]).value=postSetFields[i]["value"]}for(i=0;i<INTERMediator.keyFieldObject.length;i++){currentNode=INTERMediator.keyFieldObject[i];currentID=currentNode.node.getAttribute("id");if(currentNode.target==null){if(currentID!=null&&currentID.match(/IM[0-9]+-[0-9]+/)){enclosure=INTERMediatorLib.getParentRepeater(currentNode.node)}else{enclosure=INTERMediatorLib.getParentRepeater(INTERMediatorLib.getParentEnclosure(currentNode.node))}if(enclosure!=null){targetNode=getEnclosedNode(enclosure,currentNode.name,currentNode.field);if(targetNode){currentNode.target=targetNode.getAttribute("id")}}}}INTERMediator.navigationSetup();appendCredit()}function seekEnclosureNode(node,currentRecord,currentTable,parentEnclosure,objectReference){var children,className,i;if(node.nodeType===1){try{if(INTERMediatorLib.isEnclosure(node,false)){className=INTERMediatorLib.getClassAttributeFromNode(node);if(className&&className.match(/_im_post/)){setupPostOnlyEnclosure(node)}else{if(INTERMediator.isIE){try{expandEnclosure(node,currentRecord,currentTable,parentEnclosure,objectReference)}catch(ex){if(ex=="_im_requath_request_"){throw ex}}}else{expandEnclosure(node,currentRecord,currentTable,parentEnclosure,objectReference)}}}else{children=node.childNodes;if(children){for(i=0;i<children.length;i++){if(children[i].nodeType===1){seekEnclosureNode(children[i],currentRecord,currentTable,parentEnclosure,objectReference)}}}}}catch(ex){if(ex=="_im_requath_request_"){throw ex}else{INTERMediator.setErrorMessage(ex,"EXCEPTION-10")}}}}function setupPostOnlyEnclosure(node){var nodes;var postNodes=INTERMediatorLib.getElementsByClassName(node,"_im_post");for(var i=1;i<postNodes.length;i++){INTERMediatorLib.addEvent(postNodes[i],"click",(function(){var targetNode=postNodes[i];return function(){INTERMediator.clickPostOnlyButton(targetNode)}})())}nodes=node.childNodes;isInsidePostOnly=true;for(i=0;i<nodes.length;i++){seekEnclosureInPostOnly(nodes[i])}isInsidePostOnly=false;function seekEnclosureInPostOnly(node){var children,i;if(node.nodeType===1){try{if(INTERMediatorLib.isEnclosure(node,false)){expandEnclosure(node,null,null,null,null)}else{children=node.childNodes;for(i=0;i<children.length;i++){seekEnclosureInPostOnly(children[i])}}}catch(ex){if(ex=="_im_requath_request_"){throw ex}else{INTERMediator.setErrorMessage(ex,"EXCEPTION-11")}}}}}function expandEnclosure(node,currentRecord,currentTable,parentEnclosure,parentObjectInfo){var objectReference={},linkedNodes,encNodeTag,parentNodeId,repeatersOriginal,repeaters,linkDefs,voteResult,currentContext,fieldList,repNodeTag,relationValue,dependObject,relationDef,index,fieldName,thisKeyFieldObject,i,j,k,ix,targetRecords,newNode,nodeClass,repeatersOneRec,currentLinkedNodes,shouldDeleteNodes,keyField,keyValue,counter,nodeTag,typeAttr,linkInfoArray,RecordCounter,valueChangeFunction,nInfo,curVal,curTarget,postCallFunc,newlyAddedNodes,keyingValue,oneRecord,isMatch,pagingValue,recordsValue,currentWidgetNodes,widgetSupport,nodeId,nameAttr,nameNumber,nameTable,selectedNode,foreignField,foreignValue,foreignFieldValue,dbspec,condition,optionalCondition=[];currentLevel++;INTERMediator.currentEncNumber++;widgetSupport={};if(!node.getAttribute("id")){node.setAttribute("id",nextIdValue())}encNodeTag=node.tagName;parentNodeId=(parentEnclosure==null?null:parentEnclosure.getAttribute("id"));repNodeTag=INTERMediatorLib.repeaterTagFromEncTag(encNodeTag);repeatersOriginal=collectRepeatersOriginal(node,repNodeTag);repeaters=collectRepeaters(repeatersOriginal);linkedNodes=collectLinkedElement(repeaters).linkedNode;linkDefs=collectLinkDefinitions(linkedNodes);voteResult=tableVoting(linkDefs);currentContext=voteResult.targettable;fieldList=voteResult.fieldlist;if(currentContext){try{relationValue=null;dependObject=[];relationDef=currentContext.relation;if(relationDef){relationValue={};for(index in relationDef){relationValue[relationDef[index]["join-field"]]=currentRecord[relationDef[index]["join-field"]];if(relationDef[index]["portal"]==true){currentContext.portal=true}for(fieldName in parentObjectInfo){if(fieldName==relationDef[index]["join-field"]){dependObject.push(parentObjectInfo[fieldName])}}}}thisKeyFieldObject={node:node,name:currentContext.name,"foreign-value":relationValue,parent:node.parentNode,original:[],target:dependObject};for(i=0;i<repeatersOriginal.length;i++){thisKeyFieldObject.original.push(repeatersOriginal[i].cloneNode(true))}INTERMediator.keyFieldObject.push(thisKeyFieldObject);pagingValue=false;if(currentContext.paging){pagingValue=currentContext.paging}recordsValue=10000000000;if(currentContext.records){recordsValue=currentContext.records}}catch(ex){if(ex=="_im_requath_request_"){throw ex}else{INTERMediator.setErrorMessage(ex,"EXCEPTION-25")}}if(currentContext.cache==true){try{if(!INTERMediatorOnPage.dbCache[currentContext.name]){INTERMediatorOnPage.dbCache[currentContext.name]=INTERMediator_DBAdapter.db_query({name:currentContext.name,records:null,paging:null,fields:fieldList,parentkeyvalue:null,conditions:null,useoffset:false})}if(relationValue==null){targetRecords=INTERMediatorOnPage.dbCache[currentContext.name]}else{targetRecords={recordset:[],count:0};counter=0;for(ix in INTERMediatorOnPage.dbCache[currentContext.name].recordset){oneRecord=INTERMediatorOnPage.dbCache[currentContext.name].recordset[ix];isMatch=true;index=0;for(keyField in relationValue){fieldName=currentContext.relation[index]["foreign-key"];if(oneRecord[fieldName]!=relationValue[keyField]){isMatch=false;break}index++}if(isMatch){if(!pagingValue||(pagingValue&&(counter>=INTERMediator.startFrom))){targetRecords.recordset.push(oneRecord);targetRecords.count++;if(recordsValue<=targetRecords.count){break}}counter++}}}}catch(ex){if(ex=="_im_requath_request_"){throw ex}else{INTERMediator.setErrorMessage(ex,"EXCEPTION-24")}}}else{try{if(currentContext.portal==true){for(condition in INTERMediator.additionalCondition){optionalCondition.push(INTERMediator.additionalCondition[condition]);break}}targetRecords=INTERMediator_DBAdapter.db_query({name:currentContext.name,records:currentContext.records,paging:currentContext.paging,fields:fieldList,parentkeyvalue:relationValue,conditions:optionalCondition,useoffset:true})}catch(ex){if(ex=="_im_requath_request_"){throw ex}else{INTERMediator.setErrorMessage(ex,"EXCEPTION-12")}}}if(targetRecords.count==0){for(i=0;i<repeaters.length;i++){newNode=repeaters[i].cloneNode(true);nodeClass=INTERMediatorLib.getClassAttributeFromNode(newNode);if(nodeClass==INTERMediator.noRecordClassName){node.appendChild(newNode);setIdValue(newNode)}}}RecordCounter=0;for(ix in targetRecords.recordset){try{RecordCounter++;repeatersOneRec=cloneEveryNodes(repeatersOriginal);currentWidgetNodes=collectLinkedElement(repeatersOneRec).widgetNode;currentLinkedNodes=collectLinkedElement(repeatersOneRec).linkedNode;shouldDeleteNodes=shouldDeleteNodeIds(repeatersOneRec);dbspec=INTERMediatorOnPage.getDBSpecification();if(dbspec["db-class"]!=null&&dbspec["db-class"]=="FileMaker_FX"){keyField=currentContext.key?currentContext.key:"-recid"}else{keyField=currentContext.key?currentContext.key:"id"}if(currentContext.portal==true){keyField="-recid";foreignField=currentContext.name+"::-recid";foreignValue=targetRecords.recordset[ix][foreignField];foreignFieldValue=foreignField+"="+foreignValue}else{foreignFieldValue="="}keyValue=targetRecords.recordset[ix][keyField];keyingValue=keyField+"="+keyValue;for(k=0;k<currentLinkedNodes.length;k++){setIdValue(currentLinkedNodes[k])}for(k=0;k<currentWidgetNodes.length;k++){var wInfo=INTERMediatorLib.getWidgetInfo(currentWidgetNodes[k]);if(wInfo[0]){if(!widgetSupport[wInfo[0]]){var targetName="IMParts_"+wInfo[0];widgetSupport[wInfo[0]]={plugin:eval(targetName),instanciate:eval(targetName+".instanciate"),finish:eval(targetName+".finish")}}(widgetSupport[wInfo[0]].instanciate).apply((widgetSupport[wInfo[0]].plugin),[currentWidgetNodes[k]])}}}catch(ex){if(ex=="_im_requath_request_"){throw ex}else{INTERMediator.setErrorMessage(ex,"EXCEPTION-26")}}if(currentContext.portal!=true||(currentContext.portal==true&&targetRecords.totalCount>0)){nameTable={};for(k=0;k<currentLinkedNodes.length;k++){try{nodeTag=currentLinkedNodes[k].tagName;nodeId=currentLinkedNodes[k].getAttribute("id");if(INTERMediatorLib.isWidgetElement(currentLinkedNodes[k])){nodeId=currentLinkedNodes[k]._im_getComponentId();INTERMediator.widgetElementIds.push(nodeId)}typeAttr=currentLinkedNodes[k].getAttribute("type");linkInfoArray=INTERMediatorLib.getLinkedElementInfo(currentLinkedNodes[k]);if(typeAttr=="radio"){nameTableKey=linkInfoArray.join("|");if(!nameTable[nameTableKey]){nameTable[nameTableKey]=nameAttrCounter;nameAttrCounter++}nameNumber=nameTable[nameTableKey];nameAttr=currentLinkedNodes[k].getAttribute("name");if(nameAttr){currentLinkedNodes[k].setAttribute("name",nameAttr+"-"+nameNumber)}else{currentLinkedNodes[k].setAttribute("name","IM-R-"+nameNumber)}}if(!isInsidePostOnly&&(nodeTag=="INPUT"||nodeTag=="SELECT"||nodeTag=="TEXTAREA")){valueChangeFunction=function(targetId){var theId=targetId;return function(evt){INTERMediator.valueChange(theId)}};eventListenerPostAdding.push({id:nodeId,event:"change",todo:valueChangeFunction(nodeId)});if(nodeTag!="SELECT"){eventListenerPostAdding.push({id:nodeId,event:"keydown",todo:INTERMediator.keyDown});eventListenerPostAdding.push({id:nodeId,event:"keyup",todo:INTERMediator.keyUp})}}for(j=0;j<linkInfoArray.length;j++){nInfo=INTERMediatorLib.getNodeInfoArray(linkInfoArray[j]);curVal=targetRecords.recordset[ix][nInfo.field];if(curVal==null){curVal=""}curTarget=nInfo.target;if(nodeTag=="INPUT"||nodeTag=="SELECT"||nodeTag=="TEXTAREA"||INTERMediatorLib.isWidgetElement(currentLinkedNodes[k])){INTERMediator.updateRequiredObject[nodeId]={targetattribute:curTarget,initialvalue:curVal,name:currentContext.name,field:nInfo.field,"parent-enclosure":node.getAttribute("id"),keying:keyingValue,foreignfield:foreignFieldValue,"foreign-value":relationValue,updatenodeid:parentNodeId}}objectReference[nInfo.field]=nodeId;if((typeof curVal=="object"||curVal instanceof Object)){for(i=0;i<Object.keys(curVal).length;i++){if(i==0){if(setDataToElement(currentLinkedNodes[k],curTarget,curVal[i])){postSetFields.push({id:nodeId,value:curVal[i]})}}}}else{if(setDataToElement(currentLinkedNodes[k],curTarget,curVal)){postSetFields.push({id:nodeId,value:curVal})}}}}catch(ex){if(ex=="_im_requath_request_"){throw ex}else{INTERMediator.setErrorMessage(ex,"EXCEPTION-27")}}}}if(currentContext.portal==true){keyField="-recid";foreignField=currentContext.name+"::-recid";foreignValue=targetRecords.recordset[ix][foreignField];foreignFieldValue=foreignField+"="+foreignValue}else{foreignField="";foreignValue="";foreignFieldValue="="}setupDeleteButton(encNodeTag,repNodeTag,repeatersOneRec[repeatersOneRec.length-1],currentContext,keyField,keyValue,foreignField,foreignValue,shouldDeleteNodes);if(currentContext.portal!=true||(currentContext.portal==true&&targetRecords.totalCount>0)){newlyAddedNodes=[];for(i=0;i<repeatersOneRec.length;i++){newNode=repeatersOneRec[i].cloneNode(true);nodeClass=INTERMediatorLib.getClassAttributeFromNode(newNode);if(nodeClass!=INTERMediator.noRecordClassName){node.appendChild(newNode);newlyAddedNodes.push(newNode);setIdValue(newNode);seekEnclosureNode(newNode,targetRecords.recordset[ix],currentContext.name,node,objectReference)}}try{if(INTERMediatorOnPage.expandingRecordFinish!=null){INTERMediatorOnPage.expandingRecordFinish(currentContext.name,newlyAddedNodes);INTERMediator.setDebugMessage("Call INTERMediatorOnPage.expandingRecordFinish with the context: "+currentContext.name,2)}if(currentContext["post-repeater"]){postCallFunc=new Function("arg","INTERMediatorOnPage."+currentContext["post-repeater"]+"(arg)");postCallFunc(newlyAddedNodes);INTERMediator.setDebugMessage("Call the post repeater method 'INTERMediatorOnPage."+currentContext["post-repeater"]+"' with the context: "+currentContext.name,2)}}catch(ex){if(ex=="_im_requath_request_"){throw ex}else{INTERMediator.setErrorMessage(ex,"EXCEPTION-23")}}}}setupInsertButton(currentContext,keyValue,encNodeTag,repNodeTag,node,relationValue);for(var pName in widgetSupport){widgetSupport[pName].plugin.finish()}try{if(INTERMediatorOnPage.expandingEnclosureFinish!=null){INTERMediatorOnPage.expandingEnclosureFinish(currentContext.name,node);INTERMediator.setDebugMessage("Call INTERMediatorOnPage.expandingEnclosureFinish with the context: "+currentContext.name,2)}}catch(ex){if(ex=="_im_requath_request_"){throw ex}else{INTERMediator.setErrorMessage(ex,"EXCEPTION-21")}}try{if(currentContext["post-enclosure"]){postCallFunc=new Function("arg","INTERMediatorOnPage."+currentContext["post-enclosure"]+"(arg)");postCallFunc(node);INTERMediator.setDebugMessage("Call the post enclosure method 'INTERMediatorOnPage."+currentContext["post-enclosure"]+"' with the context: "+currentContext.name,2)}}catch(ex){if(ex=="_im_requath_request_"){throw ex}else{INTERMediator.setErrorMessage(ex,"EXCEPTION-22: hint: post-enclosure of "+currentContext.name)}}}else{repeaters=[];for(i=0;i<repeatersOriginal.length;i++){newNode=node.appendChild(repeatersOriginal[i]);if(repeatersOriginal[i].getAttribute("selected")!=null){selectedNode=newNode}if(selectedNode!==undefined){selectedNode.selected=true}seekEnclosureNode(newNode,null,null,node,null)}}currentLevel--}function setIdValue(node){if(node.getAttribute("id")==null){node.setAttribute("id",nextIdValue())}else{if(INTERMediator.elementIds.indexOf(node.getAttribute("id"))>=0){node.setAttribute("id",nextIdValue())}INTERMediator.elementIds.push(node.getAttribute("id"))}return node}function nextIdValue(){INTERMediator.linkedElmCounter++;return currentIdValue()}function currentIdValue(){return"IM"+INTERMediator.currentEncNumber+"-"+INTERMediator.linkedElmCounter}function collectRepeatersOriginal(node,repNodeTag){var i,repeatersOriginal=[],children;children=node.childNodes;for(i=0;i<children.length;i++){if(children[i].nodeType===1&&children[i].tagName==repNodeTag){repeatersOriginal.push(children[i])}}return repeatersOriginal}function collectRepeaters(repeatersOriginal){var i,repeaters=[],inDocNode,parentOfRep,cloneNode;for(i=0;i<repeatersOriginal.length;i++){inDocNode=repeatersOriginal[i];parentOfRep=repeatersOriginal[i].parentNode;cloneNode=repeatersOriginal[i].cloneNode(true);repeaters.push(cloneNode);cloneNode.setAttribute("id",nextIdValue());parentOfRep.removeChild(inDocNode)}return repeaters}var linkedNodesCollection;var widgetNodesCollection;function collectLinkedElement(repeaters){var i;linkedNodesCollection=[];widgetNodesCollection=[];for(i=0;i<repeaters.length;i++){seekLinkedElement(repeaters[i])}return{linkedNode:linkedNodesCollection,widgetNode:widgetNodesCollection}}function seekLinkedElement(node){var nType,currentEnclosure,children,detectedEnclosure,i;nType=node.nodeType;if(nType===1){if(INTERMediatorLib.isLinkedElement(node)){currentEnclosure=INTERMediatorLib.getEnclosure(node);if(currentEnclosure===null){linkedNodesCollection.push(node)}else{return currentEnclosure}}if(INTERMediatorLib.isWidgetElement(node)){currentEnclosure=INTERMediatorLib.getEnclosure(node);if(currentEnclosure===null){widgetNodesCollection.push(node)}else{return currentEnclosure}}children=node.childNodes;for(i=0;i<children.length;i++){detectedEnclosure=seekLinkedElement(children[i])}}return null}function collectLinkDefinitions(linkedNodes){var linkDefs=[],nodeDefs,j,k;for(j=0;j<linkedNodes.length;j++){nodeDefs=INTERMediatorLib.getLinkedElementInfo(linkedNodes[j]);if(nodeDefs!==null){for(k=0;k<nodeDefs.length;k++){linkDefs.push(nodeDefs[k])}}}return linkDefs}function tableVoting(linkDefs){var j,nodeInfoArray,nodeInfoField,nodeInfoTable,maxVoted,maxTableName,tableName,nodeInfoTableIndex,context,tableVote=[],fieldList=[];for(j=0;j<linkDefs.length;j++){nodeInfoArray=INTERMediatorLib.getNodeInfoArray(linkDefs[j]);nodeInfoField=nodeInfoArray.field;nodeInfoTable=nodeInfoArray.table;nodeInfoTableIndex=nodeInfoArray.tableindex;if(nodeInfoField!=null&&nodeInfoTable!=null&&nodeInfoField.length!=0&&nodeInfoTable.length!=0){if(fieldList[nodeInfoTableIndex]==null){fieldList[nodeInfoTableIndex]=[]}fieldList[nodeInfoTableIndex].push(nodeInfoField);if(tableVote[nodeInfoTableIndex]==null){tableVote[nodeInfoTableIndex]=1}else{++tableVote[nodeInfoTableIndex]}}else{INTERMediator.setErrorMessage(INTERMediatorLib.getInsertedStringFromErrorNumber(1006,[linkDefs[j]]))}}maxVoted=-1;maxTableName="";for(tableName in tableVote){if(maxVoted<tableVote[tableName]){maxVoted=tableVote[tableName];maxTableName=tableName.substring(10)}}context=INTERMediatorLib.getNamedObject(INTERMediatorOnPage.getDataSources(),"name",maxTableName);return{targettable:context,fieldlist:fieldList["_im_index_"+maxTableName]}}function cloneEveryNodes(originalNodes){var i,clonedNodes=[];for(i=0;i<originalNodes.length;i++){clonedNodes.push(originalNodes[i].cloneNode(true))}return clonedNodes}function shouldDeleteNodeIds(repeatersOneRec){var shouldDeleteNodes=[],i;for(i=0;i<repeatersOneRec.length;i++){setIdValue(repeatersOneRec[i]);shouldDeleteNodes.push(repeatersOneRec[i].getAttribute("id"))}return shouldDeleteNodes}function setDataToElement(element,curTarget,curVal){var styleName,statement,currentValue,scriptNode,typeAttr,valueAttr,textNode,needPostValueSet=false,nodeTag,curValues,i;nodeTag=element.tagName;if(curTarget!=null&&curTarget.length>0){if(curTarget.charAt(0)=="#"){curTarget=curTarget.substring(1);if(curTarget=="innerHTML"){if(INTERMediator.isIE&&nodeTag=="TEXTAREA"){curVal=curVal.replace(/\r\n/g,"\r").replace(/\n/g,"\r").replace(/\r/g,"<br>")}element.innerHTML+=curVal}else{if(curTarget=="textNode"||curTarget=="script"){textNode=document.createTextNode(curVal);if(nodeTag=="TEXTAREA"){curVal=curVal.replace(/\r\n/g,"\r").replace(/\n/g,"\r")}element.appendChild(textNode)}else{if(curTarget.indexOf("style.")==0){styleName=curTarget.substring(6,curTarget.length);statement="element.style."+styleName+"='"+curVal+"';";eval(statement)}else{currentValue=element.getAttribute(curTarget);element.setAttribute(curTarget,currentValue+curVal)}}}}else{if(curTarget.charAt(0)=="$"){curTarget=curTarget.substring(1);if(curTarget=="innerHTML"){if(INTERMediator.isIE&&nodeTag=="TEXTAREA"){curVal=curVal.replace(/\r\n/g,"\r").replace(/\n/g,"\r").replace(/\r/g,"<br>")}element.innerHTML=element.innerHTML.replace("$",curVal)}else{if(curTarget=="textNode"||curTarget=="script"){if(nodeTag=="TEXTAREA"){curVal=curVal.replace(/\r\n/g,"\r").replace(/\n/g,"\r")}element.innerHTML=element.innerHTML.replace("$",curVal)}else{if(curTarget.indexOf("style.")==0){styleName=curTarget.substring(6,curTarget.length);statement="element.style."+styleName+"='"+curVal+"';";eval(statement)}else{currentValue=element.getAttribute(curTarget);element.setAttribute(curTarget,currentValue.replace("$",curVal))}}}}else{if(INTERMediatorLib.isWidgetElement(element)){element._im_setValue(curVal)}else{if(curTarget=="innerHTML"){if(INTERMediator.isIE&&nodeTag=="TEXTAREA"){curVal=curVal.replace(/\r\n/g,"\r").replace(/\n/g,"\r").replace(/\r/g,"<br>")}element.innerHTML=curVal}else{if(curTarget=="textNode"){if(nodeTag=="TEXTAREA"){curVal=curVal.replace(/\r\n/g,"\r").replace(/\n/g,"\r")}textNode=document.createTextNode(curVal);element.appendChild(textNode)}else{if(curTarget=="script"){textNode=document.createTextNode(curVal);if(nodeTag=="SCRIPT"){element.appendChild(textNode)}else{scriptNode=document.createElement("script");scriptNode.type="text/javascript";scriptNode.appendChild(textNode);element.appendChild(scriptNode)}}else{if(curTarget.indexOf("style.")==0){styleName=curTarget.substring(6,curTarget.length);statement="element.style."+styleName+"='"+curVal+"';";eval(statement)}else{element.setAttribute(curTarget,curVal)}}}}}}}}else{if(INTERMediatorLib.isWidgetElement(element)){element._im_setValue(curVal)}else{if(nodeTag=="INPUT"){typeAttr=element.getAttribute("type");if(typeAttr=="checkbox"||typeAttr=="radio"){valueAttr=element.value;curValues=curVal.split("\n");if(typeAttr=="checkbox"&&curValues.length>1){element.checked=false;for(i=0;i<curValues.length;i++){if(valueAttr==curValues[i]&&!INTERMediator.dontSelectRadioCheck){if(INTERMediator.isIE){element.setAttribute("checked","checked")}else{element.checked=true}}}}else{if(valueAttr==curVal&&!INTERMediator.dontSelectRadioCheck){if(INTERMediator.isIE){element.setAttribute("checked","checked")}else{element.checked=true}}else{element.checked=false}}}else{element.value=curVal}}else{if(nodeTag=="SELECT"){needPostValueSet=true}else{if(INTERMediator.defaultTargetInnerHTML){if(INTERMediator.isIE&&nodeTag=="TEXTAREA"){curVal=curVal.replace(/\r\n/g,"\r").replace(/\n/g,"\r").replace(/\r/g,"<br/>")}element.innerHTML=curVal}else{if(nodeTag=="TEXTAREA"){curVal=curVal.replace(/\r\n/g,"\r").replace(/\n/g,"\r")}textNode=document.createTextNode(curVal);element.appendChild(textNode)}}}}}return needPostValueSet}function setupDeleteButton(encNodeTag,repNodeTag,endOfRepeaters,currentContext,keyField,keyValue,foreignField,foreignValue,shouldDeleteNodes){var buttonNode,thisId,deleteJSFunction,tdNodes,tdNode;if(currentContext["repeat-control"]&&currentContext["repeat-control"].match(/delete/i)){if(currentContext.relation||currentContext.records===undefined||currentContext.records>1){buttonNode=document.createElement("BUTTON");buttonNode.appendChild(document.createTextNode(INTERMediatorOnPage.getMessages()[6]));thisId="IM_Button_"+buttonIdNum;buttonNode.setAttribute("id",thisId);buttonIdNum++;deleteJSFunction=function(a,b,c,d,e){var contextName=a,keyField=b,keyValue=c,removeNodes=d,confirming=e;return function(){INTERMediator.deleteButton(contextName,keyField,keyValue,foreignField,foreignValue,removeNodes,confirming)}};eventListenerPostAdding.push({id:thisId,event:"click",todo:deleteJSFunction(currentContext.name,keyField,keyValue,shouldDeleteNodes,currentContext["repeat-control"].match(/confirm-delete/i))});switch(encNodeTag){case"TBODY":tdNodes=endOfRepeaters.getElementsByTagName("TD");tdNode=tdNodes[tdNodes.length-1];tdNode.appendChild(buttonNode);break;case"UL":case"OL":endOfRepeaters.appendChild(buttonNode);break;case"DIV":case"SPAN":if(repNodeTag=="DIV"||repNodeTag=="SPAN"){endOfRepeaters.appendChild(buttonNode)}break}}else{INTERMediator.deleteInsertOnNavi.push({kind:"DELETE",name:currentContext.name,key:keyField,value:keyValue,confirm:currentContext["repeat-control"].match(/confirm-delete/i)})}}}function setupInsertButton(currentContext,keyValue,encNodeTag,repNodeTag,node,relationValue){var buttonNode,shouldRemove,enclosedNode,footNode,trNode,tdNode,liNode,divNode,insertJSFunction,i,firstLevelNodes,targetNodeTag,existingButtons,keyField;if(currentContext["repeat-control"]&&currentContext["repeat-control"].match(/insert/i)){if(relationValue||!currentContext.paging||currentContext.paging===false){buttonNode=document.createElement("BUTTON");buttonNode.appendChild(document.createTextNode(INTERMediatorOnPage.getMessages()[5]));INTERMediatorLib.setClassAttributeToNode(buttonNode,"_im_insert_button");shouldRemove=[];switch(encNodeTag){case"TBODY":targetNodeTag="TFOOT";if(currentContext["repeat-control"].match(/top/i)){targetNodeTag="THEAD"}enclosedNode=node.parentNode;firstLevelNodes=enclosedNode.childNodes;footNode=null;for(i=0;i<firstLevelNodes.length;i++){if(firstLevelNodes[i].tagName===targetNodeTag){footNode=firstLevelNodes[i];break}}if(footNode==null){footNode=document.createElement(targetNodeTag);enclosedNode.appendChild(footNode)}existingButtons=INTERMediatorLib.getElementsByClassName(footNode,"_im_insert_button");if(existingButtons.length==0){trNode=document.createElement("TR");tdNode=document.createElement("TD");setIdValue(trNode);footNode.appendChild(trNode);trNode.appendChild(tdNode);tdNode.appendChild(buttonNode);shouldRemove=[trNode.getAttribute("id")]}break;case"UL":case"OL":liNode=document.createElement("LI");existingButtons=INTERMediatorLib.getElementsByClassName(liNode,"_im_insert_button");if(existingButtons.length==0){liNode.appendChild(buttonNode);if(currentContext["repeat-control"].match(/top/i)){node.insertBefore(liNode,node.firstChild)}else{node.appendChild(liNode)}}break;case"DIV":case"SPAN":if(repNodeTag=="DIV"||repNodeTag=="SPAN"){divNode=document.createElement(repNodeTag);existingButtons=INTERMediatorLib.getElementsByClassName(divNode,"_im_insert_button");if(existingButtons.length==0){divNode.appendChild(buttonNode);if(currentContext["repeat-control"].match(/top/i)){node.insertBefore(divNode,node.firstChild)}else{node.appendChild(divNode)}}}break}insertJSFunction=function(a,b,c,d,e){var contextName=a,relationValue=b,nodeId=c,removeNodes=d,confirming=e;return function(){INTERMediator.insertButton(contextName,keyValue,relationValue,nodeId,removeNodes,confirming)}};INTERMediatorLib.addEvent(buttonNode,"click",insertJSFunction(currentContext.name,relationValue,node.getAttribute("id"),shouldRemove,currentContext["repeat-control"].match(/confirm-insert/i)))}else{dbspec=INTERMediatorOnPage.getDBSpecification();if(dbspec["db-class"]!=null&&dbspec["db-class"]=="FileMaker_FX"){keyField=currentContext.key?currentContext.key:"-recid"}else{keyField=currentContext.key?currentContext.key:"id"}INTERMediator.deleteInsertOnNavi.push({kind:"INSERT",name:currentContext.name,key:keyField,confirm:currentContext["repeat-control"].match(/confirm-insert/i)})}}}function getEnclosedNode(rootNode,tableName,fieldName){var i,j,nodeInfo,nInfo,children,r;if(rootNode.nodeType==1){nodeInfo=INTERMediatorLib.getLinkedElementInfo(rootNode);for(j=0;j<nodeInfo.length;j++){nInfo=INTERMediatorLib.getNodeInfoArray(nodeInfo[j]);if(nInfo.table==tableName&&nInfo.field==fieldName){return rootNode}}}children=rootNode.childNodes;for(i=0;i<children.length;i++){r=getEnclosedNode(children[i],tableName,fieldName);if(r!==null){return r}}return null}function appendCredit(){var bodyNode,creditNode,cNode,spNode,aNode;if(document.getElementById("IM_CREDIT")==null){bodyNode=document.getElementsByTagName("BODY")[0];creditNode=document.createElement("div");bodyNode.appendChild(creditNode);creditNode.setAttribute("id","IM_CREDIT");creditNode.setAttribute("class","IM_CREDIT");cNode=document.createElement("div");creditNode.appendChild(cNode);cNode.style.backgroundColor="#F6F7FF";cNode.style.height="2px";cNode=document.createElement("div");creditNode.appendChild(cNode);cNode.style.backgroundColor="#EBF1FF";cNode.style.height="2px";cNode=document.createElement("div");creditNode.appendChild(cNode);cNode.style.backgroundColor="#E1EAFF";cNode.style.height="2px";cNode=document.createElement("div");creditNode.appendChild(cNode);cNode.setAttribute("align","right");cNode.style.backgroundColor="#D7E4FF";cNode.style.padding="2px";spNode=document.createElement("span");cNode.appendChild(spNode);cNode.style.color="#666666";cNode.style.fontSize="7pt";aNode=document.createElement("a");aNode.appendChild(document.createTextNode("INTER-Mediator"));aNode.setAttribute("href","http://inter-mediator.org/");aNode.setAttribute("target","_href");spNode.appendChild(document.createTextNode("Generated by "));spNode.appendChild(aNode);spNode.appendChild(document.createTextNode(" Ver.3.10.1(2013-11-05)"))}}},navigationSetup:function(){var c,h,d,k,e,a,n,l,f,g,p,o,b,q,m;c=document.getElementById("IM_NAVIGATOR");if(c!=null){d=c.childNodes;for(h=0;h<d.length;h++){c.removeChild(d[h])}c.innerHTML="";c.setAttribute("class","IM_NAV_panel");k=INTERMediator.navigationLabel;if(k==null||k[8]!==false){e=document.createElement("SPAN");c.appendChild(e);e.appendChild(document.createTextNode(((k==null||k[8]==null)?INTERMediatorOnPage.getMessages()[2]:k[8])));e.setAttribute("class","IM_NAV_button");INTERMediatorLib.addEvent(e,"click",function(){location.reload()})}if(k==null||k[4]!==false){a=Number(INTERMediator.startFrom);n=Number(INTERMediator.pagedSize);l=Number(INTERMediator.pagedAllCount);f=" IM_NAV_disabled";e=document.createElement("SPAN");c.appendChild(e);e.appendChild(document.createTextNode(((k==null||k[4]==null)?INTERMediatorOnPage.getMessages()[1]:k[4])+(a+1)+((Math.min(a+n,l)-a>1)?(((k==null||k[5]==null)?"-":k[5])+Math.min(a+n,l)):"")+((k==null||k[6]==null)?" / ":k[6])+(l)+((k==null||k[7]==null)?"":k[7])));e.setAttribute("class","IM_NAV_info")}if(k==null||k[0]!==false){e=document.createElement("SPAN");c.appendChild(e);e.appendChild(document.createTextNode((k==null||k[0]==null)?"<<":k[0]));e.setAttribute("class","IM_NAV_button"+(a==0?f:""));INTERMediatorLib.addEvent(e,"click",function(){INTERMediator.startFrom=0;INTERMediator.constructMain(true)});e=document.createElement("SPAN");c.appendChild(e);e.appendChild(document.createTextNode((k==null||k[1]==null)?"<":k[1]));e.setAttribute("class","IM_NAV_button"+(a==0?f:""));p=(a-n>0)?a-n:0;INTERMediatorLib.addEvent(e,"click",function(){INTERMediator.startFrom=p;INTERMediator.constructMain(true)});e=document.createElement("SPAN");c.appendChild(e);e.appendChild(document.createTextNode((k==null||k[2]==null)?">":k[2]));e.setAttribute("class","IM_NAV_button"+(a+n>=l?f:""));o=(a+n<l)?a+n:((l-n>0)?a:0);INTERMediatorLib.addEvent(e,"click",function(){INTERMediator.startFrom=o;INTERMediator.constructMain(true)});e=document.createElement("SPAN");c.appendChild(e);e.appendChild(document.createTextNode((k==null||k[3]==null)?">>":k[3]));e.setAttribute("class","IM_NAV_button"+(a+n>=l?f:""));b=l-n;INTERMediatorLib.addEvent(e,"click",function(){INTERMediator.startFrom=(b>0)?b:0;INTERMediator.constructMain(true)});e=document.createElement("SPAN");c.appendChild(e);e.appendChild(document.createTextNode(INTERMediatorOnPage.getMessages()[10]));g=document.createElement("INPUT");g.setAttribute("class","IM_NAV_JUMP");g.setAttribute("type","text");g.setAttribute("value",(INTERMediator.startFrom/n)+1);e.appendChild(g);e.appendChild(document.createTextNode(INTERMediatorOnPage.getMessages()[11]));INTERMediatorLib.addEvent(g,"change",function(){if(this.value<1){this.value=1}var r=Math.ceil(l/n);if(r<this.value){this.value=r}INTERMediator.startFrom=(~~this.value-1)*n;INTERMediator.construct(true)})}if(k==null||k[9]!==false){for(h=0;h<INTERMediator.deleteInsertOnNavi.length;h++){switch(INTERMediator.deleteInsertOnNavi[h]["kind"]){case"INSERT":e=document.createElement("SPAN");c.appendChild(e);e.appendChild(document.createTextNode(INTERMediatorOnPage.getMessages()[3]+": "+INTERMediator.deleteInsertOnNavi[h]["name"]));e.setAttribute("class","IM_NAV_button");q=function(s,r,w){var v=s,u=r,t=w;return function(){INTERMediator.insertRecordFromNavi(v,u,t)}};INTERMediatorLib.addEvent(e,"click",q(INTERMediator.deleteInsertOnNavi[h]["name"],INTERMediator.deleteInsertOnNavi[h]["key"],INTERMediator.deleteInsertOnNavi[h]["confirm"]?true:false));break;case"DELETE":e=document.createElement("SPAN");c.appendChild(e);e.appendChild(document.createTextNode(INTERMediatorOnPage.getMessages()[4]+": "+INTERMediator.deleteInsertOnNavi[h]["name"]));e.setAttribute("class","IM_NAV_button");m=function(s,r,y,x){var w=s,u=r,v=y,t=x;return function(){INTERMediator.deleteRecordFromNavi(w,u,v,t)}};INTERMediatorLib.addEvent(e,"click",m(INTERMediator.deleteInsertOnNavi[h]["name"],INTERMediator.deleteInsertOnNavi[h]["key"],INTERMediator.deleteInsertOnNavi[h]["value"],INTERMediator.deleteInsertOnNavi[h]["confirm"]?true:false));break}}}if(k==null||k[10]!==false){if(INTERMediatorOnPage.getOptionsTransaction()=="none"){e=document.createElement("SPAN");c.appendChild(e);e.appendChild(document.createTextNode((k==null||k[10]==null)?INTERMediatorOnPage.getMessages()[7]:k[10]));e.setAttribute("class","IM_NAV_button");INTERMediatorLib.addEvent(e,"click",INTERMediator.saveRecordFromNavi)}}if(k==null||k[11]!==false){if(INTERMediatorOnPage.requireAuthentication){e=document.createElement("SPAN");c.appendChild(e);e.appendChild(document.createTextNode(INTERMediatorOnPage.getMessages()[8]+INTERMediatorOnPage.authUser));e.setAttribute("class","IM_NAV_info");e=document.createElement("SPAN");c.appendChild(e);e.appendChild(document.createTextNode((k==null||k[11]==null)?INTERMediatorOnPage.getMessages()[9]:k[11]));e.setAttribute("class","IM_NAV_button");INTERMediatorLib.addEvent(e,"click",function(){INTERMediatorOnPage.logout();location.reload()})}}}}};function SHA1(e){function d(A,z){var y=(A<<z)|(A>>>(32-z));return y}function s(B){var A="";var y;var C;var z;for(y=0;y<=6;y+=2){C=(B>>>(y*4+4))&15;z=(B>>>(y*4))&15;A+=C.toString(16)+z.toString(16)}return A}function u(B){var A="";var z;var y;for(z=7;z>=0;z--){y=(B>>>(z*4))&15;A+=y.toString(16)}return A}function b(z){z=z.replace(/\r\n/g,"\n");var y="";for(var B=0;B<z.length;B++){var A=z.charCodeAt(B);if(A<128){y+=String.fromCharCode(A)}else{if((A>127)&&(A<2048)){y+=String.fromCharCode((A>>6)|192);y+=String.fromCharCode((A&63)|128)}else{y+=String.fromCharCode((A>>12)|224);y+=String.fromCharCode(((A>>6)&63)|128);y+=String.fromCharCode((A&63)|128)}}}return y}var h;var w,v;var c=new Array(80);var n=1732584193;var l=4023233417;var k=2562383102;var g=271733878;var f=3285377520;var t,r,q,p,o;var x;e=b(e);var a=e.length;var m=new Array();for(w=0;w<a-3;w+=4){v=e.charCodeAt(w)<<24|e.charCodeAt(w+1)<<16|e.charCodeAt(w+2)<<8|e.charCodeAt(w+3);m.push(v)}switch(a%4){case 0:w=2147483648;break;case 1:w=e.charCodeAt(a-1)<<24|8388608;break;case 2:w=e.charCodeAt(a-2)<<24|e.charCodeAt(a-1)<<16|32768;break;case 3:w=e.charCodeAt(a-3)<<24|e.charCodeAt(a-2)<<16|e.charCodeAt(a-1)<<8|128;break}m.push(w);while((m.length%16)!=14){m.push(0)}m.push(a>>>29);m.push((a<<3)&4294967295);for(h=0;h<m.length;h+=16){for(w=0;w<16;w++){c[w]=m[h+w]}for(w=16;w<=79;w++){c[w]=d(c[w-3]^c[w-8]^c[w-14]^c[w-16],1)}t=n;r=l;q=k;p=g;o=f;for(w=0;w<=19;w++){x=(d(t,5)+((r&q)|(~r&p))+o+c[w]+1518500249)&4294967295;o=p;p=q;q=d(r,30);r=t;t=x}for(w=20;w<=39;w++){x=(d(t,5)+(r^q^p)+o+c[w]+1859775393)&4294967295;o=p;p=q;q=d(r,30);r=t;t=x}for(w=40;w<=59;w++){x=(d(t,5)+((r&q)|(r&p)|(q&p))+o+c[w]+2400959708)&4294967295;o=p;p=q;q=d(r,30);r=t;t=x}for(w=60;w<=79;w++){x=(d(t,5)+(r^q^p)+o+c[w]+3395469782)&4294967295;o=p;p=q;q=d(r,30);r=t;t=x}n=(n+t)&4294967295;l=(l+r)&4294967295;k=(k+q)&4294967295;g=(g+p)&4294967295;f=(f+o)&4294967295}var x=u(n)+u(l)+u(k)+u(g)+u(f);return x.toLowerCase()}(function(){var q=8,t="",r=0,s=function(y){var w=[],x=(1<<q)-1,A=y.length*q,z;for(z=0;z<A;z+=q){w[z>>5]|=(y.charCodeAt(z/q)&x)<<(32-q-(z%32))}return w},d=function(x){var w=[],A=x.length,z,y;for(z=0;z<A;z+=2){y=parseInt(x.substr(z,2),16);if(!isNaN(y)){w[z>>3]|=y<<(24-(4*(z%8)))}else{return"INVALID HEX STRING"}}return w},g=function(x){var w=(r)?"0123456789ABCDEF":"0123456789abcdef",B="",A=x.length*4,z,y;for(z=0;z<A;z+=1){y=x[z>>2]>>((3-(z%4))*8);B+=w.charAt((y>>4)&15)+w.charAt(y&15)}return B},m=function(x){var w="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",C="",A=x.length*4,z,y,B;for(z=0;z<A;z+=3){B=(((x[z>>2]>>8*(3-z%4))&255)<<16)|(((x[z+1>>2]>>8*(3-(z+1)%4))&255)<<8)|((x[z+2>>2]>>8*(3-(z+2)%4))&255);for(y=0;y<4;y+=1){if(z*8+y*6<=x.length*32){C+=w.charAt((B>>6*(3-y))&63)}else{C+=t}}}return C},h=function(w,y){return(w>>>y)|(w<<(32-y))},p=function(w,y){return w>>>y},k=function(w,B,A){return(w&B)^(~w&A)},b=function(w,B,A){return(w&B)^(w&A)^(B&A)},n=function(w){return h(w,2)^h(w,13)^h(w,22)},l=function(w){return h(w,6)^h(w,11)^h(w,25)},v=function(w){return h(w,7)^h(w,18)^p(w,3)},u=function(w){return h(w,17)^h(w,19)^p(w,10)},e=function(w,B){var z=(w&65535)+(B&65535),A=(w>>>16)+(B>>>16)+(z>>>16);return((A&65535)<<16)|(z&65535)},c=function(x,w,B,A){var z=(x&65535)+(w&65535)+(B&65535)+(A&65535),y=(x>>>16)+(w>>>16)+(B>>>16)+(A>>>16)+(z>>>16);return((y&65535)<<16)|(z&65535)},a=function(x,w,C,B,A){var z=(x&65535)+(w&65535)+(C&65535)+(B&65535)+(A&65535),y=(x>>>16)+(w>>>16)+(C>>>16)+(B>>>16)+(A>>>16)+(z>>>16);return((y&65535)<<16)|(z&65535)},f=function(F,E,D){var R,Q,P,O,N,M,L,I,C,A,y,J,G,z,x,w=[],B;if(D==="SHA-224"||D==="SHA-256"){J=(((E+65)>>9)<<4)+15;x=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];if(D==="SHA-224"){y=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}else{y=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]}}F[E>>5]|=128<<(24-E%32);F[J]=E;B=F.length;for(G=0;G<B;G+=16){R=y[0];Q=y[1];P=y[2];O=y[3];N=y[4];M=y[5];L=y[6];I=y[7];for(z=0;z<64;z+=1){if(z<16){w[z]=F[z+G]}else{w[z]=c(u(w[z-2]),w[z-7],v(w[z-15]),w[z-16])}C=a(I,l(N),k(N,M,L),x[z],w[z]);A=e(n(R),b(R,Q,P));I=L;L=M;M=N;N=e(O,C);O=P;P=Q;Q=R;R=e(C,A)}y[0]=e(R,y[0]);y[1]=e(Q,y[1]);y[2]=e(P,y[2]);y[3]=e(O,y[3]);y[4]=e(N,y[4]);y[5]=e(M,y[5]);y[6]=e(L,y[6]);y[7]=e(I,y[7])}switch(D){case"SHA-224":return[y[0],y[1],y[2],y[3],y[4],y[5],y[6]];case"SHA-256":return y;default:return[]}},o=function(x,w){this.sha224=null;this.sha256=null;this.strBinLen=null;this.strToHash=null;if("HEX"===w){if(0!==(x.length%2)){return"TEXT MUST BE IN BYTE INCREMENTS"}this.strBinLen=x.length*4;this.strToHash=d(x)}else{if(("ASCII"===w)||("undefined"===typeof(w))){this.strBinLen=x.length*q;this.strToHash=s(x)}else{return"UNKNOWN TEXT INPUT TYPE"}}};o.prototype={getHash:function(x,w){var z=null,y=this.strToHash.slice();switch(w){case"HEX":z=g;break;case"B64":z=m;break;default:return"FORMAT NOT RECOGNIZED"}switch(x){case"SHA-224":if(null===this.sha224){this.sha224=f(y,this.strBinLen,x)}return z(this.sha224);case"SHA-256":if(null===this.sha256){this.sha256=f(y,this.strBinLen,x)}return z(this.sha256);default:return"HASH NOT RECOGNIZED"}},getHMAC:function(F,E,D,B){var A,z,y,w,C,H,G=[],x=[];switch(B){case"HEX":A=g;break;case"B64":A=m;break;default:return"FORMAT NOT RECOGNIZED"}switch(D){case"SHA-224":H=224;break;case"SHA-256":H=256;break;default:return"HASH NOT RECOGNIZED"}if("HEX"===E){if(0!==(F.length%2)){return"KEY MUST BE IN BYTE INCREMENTS"}z=d(F);C=F.length*4}else{if("ASCII"===E){z=s(F);C=F.length*q}else{return"UNKNOWN KEY INPUT TYPE"}}if(64<(C/8)){z=f(z,C,D);z[15]&=4294967040}else{if(64>(C/8)){z[15]&=4294967040}}for(y=0;y<=15;y+=1){G[y]=z[y]^909522486;x[y]=z[y]^1549556828}w=f(G.concat(this.strToHash),512+this.strBinLen,D);w=f(x.concat(w),512+H,D);return(A(w))}};window.jsSHA=o}());var biRadixBase=2;var biRadixBits=16;biRadixBits=biRadixBits-biRadixBits%4;var bitsPerDigit=biRadixBits;var biRadix=1<<biRadixBits;var biHalfRadix=biRadix>>>1;var biRadixSquared=biRadix*biRadix;var maxDigitVal=biRadix-1;var maxInteger=4294967295;var biHexPerDigit=biRadixBits/4;var bigZero=biFromNumber(0);var bigOne=biFromNumber(1);var dpl10=9;var lr10=biFromNumber(1000000000);function BigInt(a){this.isNeg=false;if(a==-1){return}if(a){this.digits=new Array(a);while(a){this.digits[--a]=0}}else{this.digits=[0]}}BigInt.prototype.isZero=function(){return this.digits[0]==0&&biNormalize(this).digits.length==1};BigInt.prototype.isOne=function(){return this.digits[0]==1&&!this.isNeg&&biNormalize(this).digits.length==1};BigInt.prototype.isEqual=function(b){if(this.isNeg!=b.isNeg){return false}if(this.digits.length!=b.digits.length){return false}for(var a=this.digits.length-1;a>-1;a--){if(this.digits[a]!=b.digits[a]){return false}}return true};BigInt.prototype.blankZero=function(){this.digits.length=1;this.digits[0]=0};BigInt.prototype.blankOne=function(){this.digits.length=1;this.digits[0]=1};BigInt.prototype.blankEmpty=function(){this.digits.length=0};function biCopy(b){var a=new BigInt(-1);a.digits=b.digits.slice(0);a.isNeg=b.isNeg;return a}function biAbs(b){var a=new BigInt(-1);a.digits=b.digits.slice(0);a.isNeg=false;return a}function biMinus(b){var a=new BigInt(-1);a.digits=b.digits.slice(0);a.isNeg=!b.isNeg;return a}function biFromNumber(c){if(Math.abs(c)>maxInteger){return(biFromFloat(c))}var a=new BigInt();if(a.isNeg=c<0){c=-c}var b=0;while(c>0){a.digits[b++]=c&maxDigitVal;c>>>=biRadixBits}return a}function biFromFloat(d){var a=new BigInt();if(a.isNeg=d<0){d=-d}var b=0;while(d>0){var e=Math.floor(d/biRadix);a.digits[b++]=d-e*biRadix;d=e}return a}function biFromString(l,k){if(k==16){return biFromHex(l)}var a=l.charAt(0)=="-";var e=(a?1:0)-1;var m=new BigInt();var b=biCopy(bigOne);for(var d=l.length-1;d>e;d--){var f=l.charCodeAt(d);var g=charToHex(f);var h=biMultiplyDigit(b,g);m=biAdd(m,h);b=biMultiplyDigit(b,k)}m.isNeg=a;return biNormalize(m)}function biFromDecimal(a){return biFromString(a,10)}function biFromHex(e){var b=new BigInt();if(e.charAt(0)=="-"){b.isNeg=true;e=substr(e,1)}else{b.isNeg=false}var a=e.length;for(var d=a,c=0;d>0;d-=biHexPerDigit,c++){b.digits[c]=hexToDigit(e.substr(Math.max(d-biHexPerDigit,0),Math.min(d,biHexPerDigit)))}return biNormalize(b)}function reverseStr(c){var a="";for(var b=c.length-1;b>-1;b--){a+=c.charAt(b)}return a}var hexatrigesimalToChar=new Array("0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z");function biToString(d,f){if(f==16){return biToHex(d)}var c=biFromNumber(f);var e=biDivideModulo(biAbs(d),c);var a=hexatrigesimalToChar[e[1].digits[0]];while(!e[0].isZero()){e=biDivideModulo(e[0],c);a+=hexatrigesimalToChar[e[1].digits[0]]}return(d.isNeg?"-":"")+reverseStr(a)}function biToDecimal(a){return biToString(a,10)}var hexToChar=new Array("0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f");function digitToHex(d){var b=15;var a="";for(var c=0;c<biHexPerDigit;c++){a+=hexToChar[d&b];d>>>=4}return reverseStr(a)}function digitToHexTrunk(d){if(d==0){return"0"}var b=15;var a="";for(var c=0;c<biHexPerDigit&&d>0;c++){a+=hexToChar[d&b];d>>>=4}return reverseStr(a)}function biToHex(b){var a=b.isNeg?"-":"";var c=biHighIndex(b);a+=digitToHexTrunk(b.digits[c--]);while(c>-1){a+=digitToHex(b.digits[c--])}return a}function biToNumber(b){var a=0;var d=1;var c=biHighIndex(b)+1;for(var e=0;e<c;e++){a+=b.digits[e]*d;d*=biRadix}return b.isNeg?-a:a}function charToHex(k){var d=48;var b=d+9;var e=97;var h=e+25;var g=65;var f=65+25;var a;if(k>=d&&k<=b){a=k-d}else{if(k>=g&&k<=f){a=10+k-g}else{if(k>=e&&k<=h){a=10+k-e}else{a=0}}}return a}function hexToDigit(d){var b=0;var a=Math.min(d.length,biHexPerDigit);for(var c=0;c<a;c++){b<<=4;b|=charToHex(d.charCodeAt(c))}return b}function biDump(a){return(a.isNeg?"minus ":"plus ")+a.digits.join(" ")}function biNormalize(a){var b=a.digits.length;if(a.digits[b-1]!=0&&!isNaN(a.digits[b-1])){return a}for(var c=b-1;c>0;c--){if(a.digits[c]==0||isNaN(a.digits[c])){a.digits.pop()}else{return a}}if(a.digits.length==1&&a.digits[0]==0){a.isNeg=false}if(isNaN(a.digits[0])){throw new Error("Undefined BigInt: "+biDump(a))}return a}function biHighIndex(a){biNormalize(a);return a.digits.length-1}function biNumBits(c){var f=biHighIndex(c);var e=c.digits[f];var b=(f+1)*bitsPerDigit;var a;for(a=b;a>b-bitsPerDigit;a--){if((e&biHalfRadix)!=0){break}e<<=1}return a}function biCompareAbs(b,e){var a=biHighIndex(b);var d=biHighIndex(e);if(a!=d){return 1-2*((a<d)?1:0)}for(var c=b.digits.length-1;c>-1;c--){if(b.digits[c]!=e.digits[c]){return 1-2*((b.digits[c]<e.digits[c])?1:0)}}return 0}function biCompare(a,b){if(a.isNeg!=b.isNeg){return 1-2*(a.isNeg?1:0)}return a.isNeg?-biCompareAbs(a,b):biCompareAbs(a,b)}function biAddNatural(l,h){var f=biHighIndex(l)+1;var e=biHighIndex(h)+1;var d=0;var g=0;if(f>e){var m=biAbs(l);var a=h;var b=e}else{var m=biAbs(h);var a=l;var b=f}while(d<b){m.digits[d]+=a.digits[d]+g;if(m.digits[d]<biRadix){g=0}else{m.digits[d]&=maxDigitVal;g=1}d++}while(g>0){m.digits[d]=(m.digits[d]||0)+g;if(m.digits[d]<biRadix){g=0}else{m.digits[d]&=maxDigitVal;g=1}d++}return m}function biSubtractNatural(k,h){var f=biHighIndex(k)+1;var e=biHighIndex(h)+1;var m=biAbs(k);var a=m.digits;var b=k.digits;var l=h.digits;var g=0;for(var d=0;d<e;d++){if(b[d]>=l[d]-g){a[d]=b[d]-l[d]+g;g=0}else{a[d]=biRadix+b[d]-l[d]+g;g=-1}}while(g<0&&d<f){if(b[d]>=-g){a[d]=b[d]+g;g=0}else{a[d]=biRadix+b[d]+g;g=-1}d++}return biNormalize(m)}function biAdd(b,d){var a;if(!b.isNeg&&!d.isNeg){return biAddNatural(b,d)}if(b.isNeg&&d.isNeg){a=biAddNatural(b,d);a.isNeg=true;return a}var c=biCompareAbs(b,d);if(c==0){return biFromNumber(0)}if(c>0){a=biSubtractNatural(b,d);a.isNeg=b.isNeg}if(c<0){a=biSubtractNatural(d,b);a.isNeg=d.isNeg}return a}function biSubtract(b,d){var a;if(!b.isNeg&&d.isNeg){return biAddNatural(b,d)}if(b.isNeg&&!d.isNeg){a=biAddNatural(b,d);a.isNeg=true;return a}var c=biCompareAbs(b,d);if(c==0){return biCopy(bigZero)}if(c>0){a=biSubtractNatural(b,d);a.isNeg=b.isNeg}if(c<0){a=biSubtractNatural(d,b);a.isNeg=!b.isNeg}return a}function biMultiply(o,m){var l,q,d,f;var e=biHighIndex(o)+1;var r=biHighIndex(m)+1;if(e==1&&o.digits[0]==0||r==1&&m.digits[0]==0){return new BigInt()}var s=new BigInt(e+r);var a=s.digits;var b=o.digits;var p=m.digits;for(var h=0;h<r;h++){l=0;f=h;for(var g=0;g<e;g++,f++){d=a[f]+b[g]*p[h]+l;a[f]=d&maxDigitVal;l=d>>>biRadixBits}a[h+e]=l}s.isNeg=o.isNeg!=m.isNeg;return biNormalize(s)}function biMultiplyDigit(b,h){var g=biHighIndex(b)+1;var a=new BigInt(g);var f=0;for(var d=0;d<g;d++){var e=a.digits[d]+b.digits[d]*h+f;a.digits[d]=e&maxDigitVal;f=e>>>biRadixBits}a.digits[g]=f;return a}function arrayCopy(f,h,c,g,e){if(h>=f.length){if(c.length==0){c[0]=0}return}for(var d=0;d<g;d++){c[d]=0}var a=Math.min(h+e,f.length);for(var d=h,b=g;d<a;d++,b++){c[b]=f[d]}}function biShiftLeft(b,g){var d=Math.floor(g/bitsPerDigit);var a=new BigInt();arrayCopy(b.digits,0,a.digits,d,b.digits.length);var f=g%bitsPerDigit;var c=bitsPerDigit-f;a.digits[a.digits.length]=a.digits[a.digits.length]>>>c;for(var e=a.digits.length-1;e>0;e--){a.digits[e]=((a.digits[e]<<f)&maxDigitVal)|(a.digits[e-1]>>>c)}a.digits[0]=(a.digits[0]<<f)&maxDigitVal;a.isNeg=b.isNeg;return biNormalize(a)}function biShiftRight(b,g){var c=Math.floor(g/bitsPerDigit);var a=new BigInt();arrayCopy(b.digits,c,a.digits,0,b.digits.length-c);var e=g%bitsPerDigit;var f=bitsPerDigit-e;for(var d=0;d<a.digits.length-1;d++){a.digits[d]=(a.digits[d]>>>e)|((a.digits[d+1]<<f)&maxDigitVal)}a.digits[a.digits.length-1]>>>=e;a.isNeg=b.isNeg;return biNormalize(a)}function biMultiplyByRadixPower(b,c){var a=new BigInt();arrayCopy(b.digits,0,a.digits,c,b.digits.length);return a}function biDivideByRadixPower(b,c){var a=new BigInt();arrayCopy(b.digits,c,a.digits,0,b.digits.length-c);return a}function biModuloByRadixPower(b,c){var a=new BigInt();arrayCopy(b.digits,0,a.digits,0,c);return a}function biMultiplyModByRadixPower(o,m,d){var l,r,e,g;var f=biHighIndex(o)+1;var s=biHighIndex(m)+1;if(f==1&&o.digits[0]==0||s==1&&m.digits[0]==0){return new BigInt()}var v=new BigInt(d);var a=v.digits;var b=o.digits;var q=m.digits;for(var h=0;h<s&&h<d;h++){l=0;g=h;for(j=0;j<f&&g<d;j++,g++){e=a[g]+b[j]*q[h]+l;a[g]=e&maxDigitVal;l=e>>>biRadixBits}a[h+f]=l}v=biModuloByRadixPower(v,d);v.isNeg=o.isNeg!=m.isNeg;return biNormalize(v)}function biDivideModuloNatural(m,k){var b,o,d,n,h;var g=biHighIndex(m);var f=biHighIndex(k);var c=new BigInt(-1);c.digits=[];var a=new BigInt();for(var e=g;e>-1;e--){a.digits.unshift(m.digits[e]);h=biCompareAbs(k,a);if(h>0){c.digits.unshift(0);continue}if(h==0){c.digits.unshift(1);a.blankZero();continue}var l=biHighIndex(a);if(l==f){d=Math.floor((a.digits[l]*biRadix+(a.digits[l-1]||0))/(k.digits[f]*biRadix+(k.digits[f-1]||0)+1))}else{d=Math.floor((a.digits[l]*biRadixSquared+(a.digits[l-1]||0)*biRadix+(a.digits[l-2]||0))/(k.digits[f]*biRadix+(k.digits[f-1]||0)+1))}d=Math.max(0,Math.min(d,maxDigitVal));n=biMultiplyDigit(k,d);a=biSubtract(a,n);if(a.isNeg){while(a.isNeg){a=biAdd(a,k);d--}}else{while(biCompare(a,k)>=0){a=biSubtract(a,k);d++}}c.digits.unshift(d)}return[biNormalize(c),biNormalize(a)]}function biDivideModulo(c,g){var f,e;if(biCompareAbs(c,g)<0){if((c.isNeg&&g.isNeg)||(!c.isNeg&&!g.isNeg)){f=biFromNumber(0);e=biCopy(c)}else{f=biFromNumber(-1);e=biAdd(g,c)}return[f,e]}var d=c.isNeg;var b=g.isNeg;var a=biDivideModuloNatural(biAbs(c),biAbs(g));f=a[0];e=a[1];if(!d&&!b){return[f,e]}else{if(d&&b){e.isNeg=true;return[f,e]}else{f.isNeg=true;f=biSubtract(f,bigOne);e.isNeg=d;e=biAdd(e,g)}}if(e.digits[0]==0&&biHighIndex(e)==0){e.isNeg=false}return[f,e]}function biDivide(a,b){return biDivideModulo(a,b)[0]}function biModulo(a,b){return biDivideModulo(a,b)[1]}function biMultiplyMod(b,c,a){return biModulo(biMultiply(b,c),a)}function biPow(c,e){var b=biCopy(bigOne);var d=c;while(true){if((e&1)!=0){b=biMultiply(b,d)}e>>>=1;if(e==0){break}d=biMultiply(d,d)}return b}function biPowMod(d,g,c){var b=biCopy(bigOne);var e=d;var f=g;while(true){if((f.digits[0]&1)!=0){b=biMultiplyMod(b,e,c)}f=biShiftRight(f,1);if(f.digits[0]==0&&biHighIndex(f)==0){break}e=biMultiplyMod(e,e,c)}return b}function biRandom(b){var a=new BigInt();while(b--){a.digits[b]=Math.floor(Math.random()*maxDigitVal)}return a}function biModularInverse(c,b){c=biModulo(c,b);var a=biExtendedEuclid(b,c);if(!a[2].isOne()){return null}return biModulo(a[1],b)}function biExtendedEuclid(e,d){if(biCompare(e,d)>=0){return biExtendedEuclidNatural(e,d)}var c=biExtendedEuclidNatural(d,e);return[c[1],c[0],c[2]]}function biExtendedEuclidNatural(o,l){var k,d,c,f,e,n,h,m,g;if(l.isZero()){return[biFromNumber(1),biFromNumber(0),o]}f=biFromNumber(0);e=biFromNumber(1);n=biFromNumber(1);h=biFromNumber(0);while(!l.isZero()){k=biDivideModulo(o,l);d=k[0];c=k[1];m=biSubtract(e,biMultiply(d,f));g=biSubtract(h,biMultiply(d,n));o=l;l=c;e=f;f=m;h=n;n=g}return[e,h,o]}function biMontgomeryPowMod(c,e,f){var b=biFromNumber(1);var a=biModulo(biMultiply(c,f.R),f);for(var d=e.bin.length-1;d>-1;d--){if(e.bin.charAt(d)=="1"){b=biMultiply(b,a);b=biMontgomeryModulo(b,f)}a=biMultiply(a,a);a=biMontgomeryModulo(a,f)}return b}function biMontgomeryModulo(b,c){var a=biModuloByRadixPower(b,c.nN);a=biMultiplyModByRadixPower(a,c.Ninv,c.nN);a=biMultiply(a,c);a=biAdd(b,a);a=biDivideByRadixPower(a,c.nN);while(biCompare(a,c)>=0){a=biSubtract(a,c)}return a}function biRSAKeyPair(b,c,a){this.e=biFromHex(b);this.d=biFromHex(c);this.m=biFromHex(a);this.chunkSize=2*biHighIndex(this.m);this.radix=16;this.m.nN=biHighIndex(this.m)+1;this.m.R=biMultiplyByRadixPower(biFromNumber(1),this.m.nN);this.m.EGCD=biExtendedEuclid(this.m.R,this.m);this.m.Ri=this.m.EGCD[0];this.m.Rinv=biModulo(this.m.EGCD[0],this.m);this.m.Ni=biMinus(this.m.EGCD[1]);this.m.Ninv=biModulo(biMinus(this.m.EGCD[1]),this.m.R);this.e.bin=biToString(this.e,2);this.d.bin=biToString(this.d,2)}biRSAKeyPair.prototype.biEncryptedString=biEncryptedString;biRSAKeyPair.prototype.biDecryptedString=biDecryptedString;function biEncryptedString(h){h=biUTF8Encode(h);h=h.replace(/[\x00]/gm,String.fromCharCode(255));h=h+String.fromCharCode(254);var a=h.length;h=h+biRandomPadding(this.chunkSize-a%this.chunkSize);var a=h.length;var l="";var e,d,c,b;b=new BigInt();for(var e=0;e<a;e+=this.chunkSize){b.blankZero();d=0;for(c=e;c<e+this.chunkSize&&c<a;++d){b.digits[d]=h.charCodeAt(c++);b.digits[d]+=(h.charCodeAt(c++)||0)<<8}var g=biMontgomeryPowMod(b,this.e,this.m);var f=biToHex(g);l+=f+","}return l.substring(0,l.length-1)}function biDecryptedString(e){var g=e.split(",");var a="";var d,c,f;for(d=0;d<g.length;++d){var b;b=biFromHex(g[d],10);f=biMontgomeryPowMod(b,this.d,this.m);for(c=0;c<=biHighIndex(f);++c){a+=String.fromCharCode(f.digits[c]&255,f.digits[c]>>8)}}a=a.replace(/\xff/gm,String.fromCharCode(0));a=a.substr(0,a.lastIndexOf(String.fromCharCode(254)));return biUTF8Decode(a)}function biUTF8Encode(d){var b="";var a=d.length;for(var f=0;f<a;f++){var e=d.charCodeAt(f);if(e<128){b+=String.fromCharCode(e)}else{if((e>127)&&(e<2048)){b+=String.fromCharCode((e>>6)|192);b+=String.fromCharCode((e&63)|128)}else{b+=String.fromCharCode((e>>12)|224);b+=String.fromCharCode(((e>>6)&63)|128);b+=String.fromCharCode((e&63)|128)}}}return b}function biUTF8Decode(e){var d="";var a=e.length;var b;for(var g=0;g<a;g++){var f=e.charCodeAt(g);if(f<128){d+=String.fromCharCode(f);b=0}else{if((f>191)&&(f<224)){b=((f&31)<<6);f=e.charCodeAt(++g);b+=(f&63);d+=String.fromCharCode(b)}else{b=((f&15)<<12);f=e.charCodeAt(++g);b+=((f&63)<<6);f=e.charCodeAt(++g);b+=(f&63);d+=String.fromCharCode(b)}}}return d}function biRandomPadding(c){var a="";for(var b=0;b<c;b++){a=a+String.fromCharCode(Math.floor(Math.random()*126)+1)}return a};