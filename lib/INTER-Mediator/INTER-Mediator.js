/*
 * INTER-Mediator Ver.5.0 Released 2015-02-20
 *
 *   Copyright (c) 2010-2015 INTER-Mediator Directive Committee, All rights reserved.
 *
 *   This project started at the end of 2009 by Masayuki Nii  msyk@msyk.net.
 *   INTER-Mediator is supplied under MIT License.
 */
var INTERMediator;INTERMediator={debugMode:false,separator:"@",defDivider:"|",defaultTargetInnerHTML:false,navigationLabel:null,elementIds:[],radioNameMode:false,dontSelectRadioCheck:false,ignoreOptimisticLocking:false,supressDebugMessageOnPage:false,supressErrorMessageOnPage:false,additionalFieldValueOnNewRecord:{},additionalFieldValueOnUpdate:{},additionalFieldValueOnDelete:{},waitSecondsAfterPostMessage:4,pagedAllCount:0,totalRecordCount:null,currentEncNumber:0,isIE:false,isTrident:false,ieVersion:-1,titleAsLinkInfo:true,classAsLinkInfo:true,isDBDataPreferable:false,noRecordClassName:"_im_for_noresult_",rootEnclosure:null,useSessionStorage:true,errorMessages:[],debugMessages:[],partialConstructing:false,linkedElmCounter:0,pusherObject:null,buttonIdNum:0,masterNodeOriginalDisplay:"block",detailNodeOriginalDisplay:"none",pusherAvailable:false,dateTimeFunction:false,setDebugMessage:function(a,c){if(c===undefined){c=1}if(INTERMediator.debugMode>=c){INTERMediator.debugMessages.push(a);if(typeof console!="undefined"){console.log("INTER-Mediator[DEBUG:%s]: %s",new Date(),a)}}},setErrorMessage:function(a,c){c=c===undefined?"":(" - "+c);if((typeof a=="string"||a instanceof String)){INTERMediator.errorMessages.push(a+c);if(typeof console!="undefined"){console.error("INTER-Mediator[ERROR]: %s",a+c)}}else{if(a.message){INTERMediator.errorMessages.push(a.message+c);if(typeof console!="undefined"){console.error("INTER-Mediator[ERROR]: %s",a.message+c)}}if(a.stack&&typeof console!="undefined"){console.error(a.stack)}}},flushMessage:function(){var k,l,f,d,c,m,a,e,g;if(!INTERMediator.supressErrorMessageOnPage&&INTERMediator.errorMessages.length>0){k=document.getElementById("_im_error_panel_4873643897897");if(k===null){k=document.createElement("div");k.setAttribute("id","_im_error_panel_4873643897897");k.style.backgroundColor="#FFDDDD";l=document.createElement("h3");l.appendChild(document.createTextNode("Error Info from INTER-Mediator"));l.appendChild(document.createElement("hr"));k.appendChild(l);f=document.getElementsByTagName("body")[0];f.insertBefore(k,f.firstChild)}k.appendChild(document.createTextNode("============ERROR MESSAGE on "+new Date()+"============"));k.appendChild(document.createElement("hr"));for(d=0;d<INTERMediator.errorMessages.length;d++){m=INTERMediator.errorMessages[d].split("\n");for(c=0;c<m.length;c++){if(c>0){k.appendChild(document.createElement("br"))}k.appendChild(document.createTextNode(m[c]))}k.appendChild(document.createElement("hr"))}}if(!INTERMediator.supressDebugMessageOnPage&&INTERMediator.debugMode&&INTERMediator.debugMessages.length>0){k=document.getElementById("_im_debug_panel_4873643897897");if(k===null){k=document.createElement("div");k.setAttribute("id","_im_debug_panel_4873643897897");k.style.backgroundColor="#DDDDDD";a=document.createElement("button");a.setAttribute("title","clear");INTERMediatorLib.addEvent(a,"click",function(){g=document.getElementById("_im_debug_panel_4873643897897");g.parentNode.removeChild(g)});e=document.createTextNode("clear");a.appendChild(e);l=document.createElement("h3");l.appendChild(document.createTextNode("Debug Info from INTER-Mediator"));l.appendChild(a);l.appendChild(document.createElement("hr"));k.appendChild(l);f=document.getElementsByTagName("body")[0];if(f){if(f.firstChild){f.insertBefore(k,f.firstChild)}else{f.appendChild(k)}}}k.appendChild(document.createTextNode("============DEBUG INFO on "+new Date()+"============ "));if(INTERMediatorOnPage.getEditorPath()){var h=document.createElement("a");h.setAttribute("href",INTERMediatorOnPage.getEditorPath());h.appendChild(document.createTextNode("Definition File Editor"));k.appendChild(h)}k.appendChild(document.createElement("hr"));for(d=0;d<INTERMediator.debugMessages.length;d++){m=INTERMediator.debugMessages[d].split("\n");for(c=0;c<m.length;c++){if(c>0){k.appendChild(document.createElement("br"))}k.appendChild(document.createTextNode(m[c]))}k.appendChild(document.createElement("hr"))}}INTERMediator.errorMessages=[];INTERMediator.debugMessages=[]},propertyIETridentSetup:function(){var e,a,f,d;e=navigator.userAgent;a=e.toLocaleUpperCase().indexOf("MSIE");if(a>=0){INTERMediator.isIE=true;for(d=a+4;d<e.length;d++){f=e.charAt(d);if(!(f==" "||f=="."||(f>="0"&&f<="9"))){INTERMediator.ieVersion=INTERMediatorLib.toNumber(e.substring(a+4,d));break}}}a=e.indexOf("; Trident/");if(a>=0){INTERMediator.isTrident=true;for(d=a+10;d<e.length;d++){f=e.charAt(d);if(!(f==" "||f=="."||(f>="0"&&f<="9"))){INTERMediator.ieVersion=INTERMediatorLib.toNumber(e.substring(a+10,d))+4;break}}}},initialize:function(){INTERMediatorOnPage.removeCookie("_im_localcontext");INTERMediator.additionalCondition={};INTERMediator.additionalSortKey={};INTERMediator.startFrom=0;IMLibLocalContext.archive()},construct:function(c){var a;INTERMediatorOnPage.showProgress();if(c===true||c===undefined){a=function(){INTERMediator.constructMain(true)}}else{a=function(){INTERMediator.constructMain(c)}}setTimeout(a,0)},constructMain:function(N,p){var K,F,y=0,B=[],t=[],s,A=1,m=[],H=false,l,r,k,z;IMLibPageNavigation.deleteInsertOnNavi=[];r=[];IMLibEventResponder.setup();INTERMediatorOnPage.retrieveAuthInfo();try{if(Pusher.VERSION){INTERMediator.pusherAvailable=true;if(!INTERMediatorOnPage.clientNotificationKey){INTERMediator.setErrorMessage(Error("Pusher Configuration Error"),INTERMediatorOnPage.getMessages()[1039]);INTERMediator.pusherAvailable=false}}}catch(E){INTERMediator.pusherAvailable=false;if(INTERMediatorOnPage.clientNotificationKey){INTERMediator.setErrorMessage(Error("Pusher Configuration Error"),INTERMediatorOnPage.getMessages()[1038])}}try{if(N===true||N===undefined){this.partialConstructing=false;INTERMediator.buttonIdNum=1;IMLibContextPool.clearAll();u()}else{this.partialConstructing=true;s=false;B=[];try{if(!p){N.removeContext();l=N.original;for(K=0;K<l.length;K++){N.enclosureNode.appendChild(l[K].cloneNode(true))}d(N.enclosureNode,N.foreignValue,N.dependingParentObjectInfo,N)}else{e(N,N.enclosureNode,{recordset:p,targetTotalCount:1,targetCount:1})}}catch(E){if(E=="_im_requath_request_"){throw E}else{INTERMediator.setErrorMessage(E,"EXCEPTION-8")}}for(K=0;K<B.length;K++){document.getElementById(B[K]["id"]).value=B[K]["value"]}IMLibCalc.updateCalculationFields();IMLibPageNavigation.navigationSetup()}}catch(E){if(E=="_im_requath_request_"){if(INTERMediatorOnPage.requireAuthentication){if(!INTERMediatorOnPage.isComplementAuthData()){INTERMediatorOnPage.authChallenge=null;INTERMediatorOnPage.authHashedPassword=null;INTERMediatorOnPage.authenticating(function(){INTERMediator.constructMain(N)});return}}}else{INTERMediator.setErrorMessage(E,"EXCEPTION-7")}}for(K=0;K<m.length;K++){m[K].finish()}INTERMediatorOnPage.hideProgress();for(K=0;K<r.length;K++){F=r[K].targetNode;k=r[K].parentNode;z=r[K].siblingNode;if(F&&k){if(z){k.insertBefore(F,z)}else{k.appendChild(F)}}}for(K=0;K<t.length;K++){F=document.getElementById(t[K].id);if(F){INTERMediatorLib.addEvent(F,t[K].event,t[K].todo)}}if(INTERMediatorOnPage.doAfterConstruct){INTERMediatorOnPage.doAfterConstruct()}INTERMediator.flushMessage();function u(){var R,S,U;IMLibCalc.calculateRequiredObject={};INTERMediator.currentEncNumber=1;INTERMediator.elementIds=[];s=false;S=document.getElementsByTagName("BODY")[0];if(INTERMediator.rootEnclosure===null){INTERMediator.rootEnclosure=S.innerHTML}else{S.innerHTML=INTERMediator.rootEnclosure}B=[];try{d(S,null,null,null)}catch(Q){if(Q=="_im_requath_request_"){throw Q}else{INTERMediator.setErrorMessage(Q,"EXCEPTION-9")}}for(R=0;R<B.length;R++){if(B[R]["value"]==""&&document.getElementById(B[R]["id"]).tagName=="SELECT"){U=document.createElement("option");U.setAttribute("value","");document.getElementById(B[R]["id"]).insertBefore(U,document.getElementById(B[R]["id"]).firstChild)}document.getElementById(B[R]["id"]).value=B[R]["value"]}IMLibLocalContext.bindingDescendant(S);IMLibCalc.updateCalculationFields();IMLibPageNavigation.navigationSetup();if(H&&INTERMediator.pusherAvailable){var P=INTERMediatorOnPage.clientNotificationIdentifier();var T=INTERMediatorOnPage.clientNotificationKey();if(T&&T!="_im_key_isnt_supplied"&&!INTERMediator.pusherObject){try{Pusher.log=function(V){if(window.console&&window.console.log){window.console.log(V)}};INTERMediator.pusherObject=new Pusher(T);INTERMediator.pusherChannel=INTERMediator.pusherObject.subscribe(P);INTERMediator.pusherChannel.bind("update",function(V){IMLibContextPool.updateOnAnotherClient("update",V)});INTERMediator.pusherChannel.bind("create",function(V){IMLibContextPool.updateOnAnotherClient("create",V)});INTERMediator.pusherChannel.bind("delete",function(V){IMLibContextPool.updateOnAnotherClient("delete",V)})}catch(Q){INTERMediator.setErrorMessage(Q,"EXCEPTION-47")}}}f()}function d(S,P,U,Q){var R,X,T,V;if(S.nodeType===1){try{if(INTERMediatorLib.isEnclosure(S,false)){X=INTERMediatorLib.getClassAttributeFromNode(S);V=S.getAttribute("data-im-control");if((X&&X.match(/_im_post/))||(V&&V=="post")){o(S)}else{if(INTERMediator.isIE){try{J(S,P,U,Q)}catch(W){if(W=="_im_requath_request_"){throw W}}}else{J(S,P,U,Q)}}}else{R=S.childNodes;if(R){for(T=0;T<R.length;T++){if(R[T].nodeType===1){d(R[T],P,U,Q)}}}}}catch(W){if(W=="_im_requath_request_"){throw W}else{INTERMediator.setErrorMessage(W,"EXCEPTION-10")}}}}function o(R){var Q,T,U,W,P=false;var S=INTERMediatorLib.getElementsByClassNameOrDataAttr(R,"_im_post");for(var V=1;V<S.length;V++){INTERMediatorLib.addEvent(S[V],"click",(function(){var Y=S[V];return function(){IMLibUI.clickPostOnlyButton(Y)}})())}Q=R.childNodes;s=true;for(V=0;V<Q.length;V++){X(Q[V])}s=false;function X(ac){var ab,aa,Z;if(ac.nodeType===1){try{if(INTERMediatorLib.isWidgetElement(ac)){Z=INTERMediatorLib.getWidgetInfo(ac);if(Z[0]){IMParts_Catalog[Z[0]].instanciate(ac);if(m.indexOf(IMParts_Catalog[Z[0]])<0){m.push(IMParts_Catalog[Z[0]])}}}else{if(INTERMediatorLib.isEnclosure(ac,false)){J(ac,null,null,null)}else{ab=ac.childNodes;for(aa=0;aa<ab.length;aa++){X(ab[aa])}}}}catch(Y){if(Y=="_im_requath_request_"){throw Y}else{INTERMediator.setErrorMessage(Y,"EXCEPTION-11")}}}}}function J(ai,V,ab,ad){var T,Z,U,Y,af,ag,ae,at,X,ar,ah,ac,S,am,W,Q,P,ak,ap,R,aa,an,al,aq,aj;y++;Z=ai.tagName;X=INTERMediatorLib.repeaterTagFromEncTag(Z);U=c(ai,X);Y=q(U);T=INTERMediatorLib.seekLinkedAndWidgetNodes(Y,true).linkedNode;af=x(T);ag=D(af);ae=ag.targettable;INTERMediator.currentEncNumber++;if(!ai.getAttribute("id")){ai.setAttribute("id",v())}if(!ae){for(am=0;am<U.length;am++){P=ai.appendChild(U[am]);if(U[am].getAttribute("selected")!=null){ap=P}if(ap!==undefined){ap.selected=true}d(P,null,ai,ad)}}else{an=new IMLibContext(ae.name);an.enclosureNode=ai;an.repeaterNodes=Y;an.original=U;an.parentContext=ad;an.sequencing=true;at=[];R=ae.calculation;aa=[];for(W in R){aa.push(R[W]["field"])}for(am=0;am<ag.fieldlist.length;am++){if(!aa[ag.fieldlist[am]]){aa.push(ag.fieldlist[am])}}if(V){try{ah=ae.relation;an.setOriginal(U);if(ah){for(ac in ah){if(ah[ac]["portal"]==true){ae.portal=true}ar=ah[ac]["join-field"];an.addForeignValue(ar,V[ar]);for(S in ab){if(S==ah[ac]["join-field"]){an.addDependingObject(ab[S]);an.dependingParentObjectInfo=JSON.parse(JSON.stringify(ab))}}}}}catch(ao){if(ao=="_im_requath_request_"){throw ao}else{INTERMediator.setErrorMessage(ao,"EXCEPTION-25")}}}if(ae.portal===true){ae.currentrecord=V;ak=V["-recid"]}Q=w(ae,at,an.foreignValue);an.registeredId=Q.registeredId;an.nullAcceptable=Q.nullAcceptable;H|=!(INTERMediatorOnPage.notifySupport===false);e(an,ai,Q);G(ae,ak,ai,an.foreignValue);a(an,ai);O(ae,ai);an.sequencing=false}y--}function e(af,aq,ar){var aa,aN,an,aO,av,al,Y,aD,aJ,R,S,ab,aM,X,at,ah,aH,aI,aG,ad,Z,Q,W,aE,az,aB,ag,ax,ay,U,aK,T,aw,aC,ap,aj,ae,P,ao,aL,V,ai,aA,ak,am;aC=aq.tagName;ap=INTERMediatorLib.repeaterTagFromEncTag(aC);ai={};ae=af.original;V=af.getContextDef();P=ar.recordset;ao=ar.totalCount;if(ar.count==0){for(aL=0;aL<ae.length;aL++){aa=ae[aL].cloneNode(true);aN=INTERMediatorLib.getClassAttributeFromNode(aa);an=aa.getAttribute("data-im-control");if(aN==INTERMediator.noRecordClassName||an=="noresult"){aq.appendChild(aa);n(aa)}}}aO=0;am=false;for(aj=0;aj<P.length;aj++){try{aO++;av=h(ae);al=INTERMediatorLib.seekLinkedAndWidgetNodes(av,true);Y=al.widgetNode;aD=al.linkedNode;aJ=[];for(aL=0;aL<av.length;aL++){n(av[aL]);aJ.push(av[aL].getAttribute("id"))}R=INTERMediatorOnPage.getDBSpecification();if(R["db-class"]!=null&&R["db-class"]=="FileMaker_FX"){S=V.key?V.key:"-recid"}else{S=V.key?V.key:"id"}if(V.relation){for(aL=0;aL<Object.keys(V.relation).length;aL++){if(V.relation[aL]["portal"]&&Number(V.relation[aL]["portal"])===1){am=true}}}if(am===true){S="-recid";ab=V.name+"::-recid";aM=P[aj][ab];X=ab+"="+aM}else{X="=";aM=null}at=P[aj][S];ah=S+"="+at;for(aH=0;aH<aD.length;aH++){aI=aD[aH].getAttribute("id");aG=n(aD[aH]);aE=aG.getAttribute("type");if(aE=="checkbox"||aE=="radio"){ad=aG.parentNode.childNodes;for(aL=0;aL<ad.length;aL++){if(ad[aL].nodeType===1&&ad[aL].tagName=="LABEL"&&aI==ad[aL].getAttribute("for")){ad[aL].setAttribute("for",aG.getAttribute("id"));break}}}}for(aH=0;aH<Y.length;aH++){Z=INTERMediatorLib.getWidgetInfo(Y[aH]);if(Z[0]){IMParts_Catalog[Z[0]].instanciate(Y[aH]);if(m.indexOf(IMParts_Catalog[Z[0]])<0){m.push(IMParts_Catalog[Z[0]])}}}}catch(aF){if(aF=="_im_requath_request_"){throw aF}else{INTERMediator.setErrorMessage(aF,"EXCEPTION-26")}}if(V.portal!=true||(V.portal==true&&ao>0)){Q={};for(aH=0;aH<aD.length;aH++){try{W=aD[aH].tagName;aI=aD[aH].getAttribute("id");if(INTERMediatorLib.isWidgetElement(aD[aH])){aI=aD[aH]._im_getComponentId()}aE=aD[aH].getAttribute("type");az=INTERMediatorLib.getLinkedElementInfo(aD[aH]);if(aE=="radio"){aB=az.join("|");if(!Q[aB]){Q[aB]=A;A++}ag=Q[aB];ax=aD[aH].getAttribute("name");if(ax){aD[aH].setAttribute("name",ax+"-"+ag)}else{aD[aH].setAttribute("name","IM-R-"+ag)}}var au=false;for(aK=0;aK<az.length;aK++){ay=INTERMediatorLib.getNodeInfoArray(az[aK]);U=P[aj][ay.field];if(!INTERMediator.isDBDataPreferable||U!=null){IMLibCalc.updateCalculationInfo(V,aI,ay,P[aj])}if(ay.table==V.name){au=true;T=ay.target;if(U===null){if(IMLibElement.setValueToIMNode(aD[aH],T,"")){B.push({id:aI,value:U})}}else{if((typeof U=="object"||U instanceof Object)){if(U&&U.length>0){if(IMLibElement.setValueToIMNode(aD[aH],T,U[0])){B.push({id:aI,value:U[0]})}}}else{if(IMLibElement.setValueToIMNode(aD[aH],T,U)){B.push({id:aI,value:U})}}}af.setValue(ah,ay.field,U,aI,T,aM);ai[ay.field]=aI}}if(au&&!s&&(W=="INPUT"||W=="SELECT"||W=="TEXTAREA")){var ac=function(aP){var aQ=aP;return function(){IMLibUI.valueChange(aQ)}};t.push({id:aI,event:"change",todo:ac(aI)});if(W!="SELECT"){t.push({id:aI,event:"keydown",todo:IMLibUI.keyDown});t.push({id:aI,event:"keyup",todo:IMLibUI.keyUp})}}}catch(aF){if(aF=="_im_requath_request_"){throw aF}else{INTERMediator.setErrorMessage(aF,"EXCEPTION-27")}}}}if(am==true){S="-recid";ab=V.name+"::-recid";aM=P[aj][ab];X=ab+"="+aM}else{ab="";aM="";X="="}I(aC,ap,av[av.length-1],V,S,at,ab,aM,aJ);M(aC,ap,av[av.length-1],V,S,at,ab,aM);if(V.portal!=true||(V.portal==true&&ao>0)){aw=[];ak=null;if(!af.sequencing){aA=af.checkOrder(P[aj]);ak=af.getRepeaterEndNode(aA+1)}for(aL=0;aL<av.length;aL++){aa=av[aL];aN=INTERMediatorLib.getClassAttributeFromNode(aa);an=aa.getAttribute("data-im-control");if((aN!=INTERMediator.noRecordClassName)&&(an!="noresult")){if(!ak){aq.appendChild(aa)}else{ak.parentNode.insertBefore(aa,ak)}aw.push(aa);n(aa);af.setValue(ah,"_im_repeater","",aa.id,"",aM);ai[ay.field]=aI;d(aa,P[aj],ai,af)}}g(V,aq,aw)}af.rearrangePendingOrder()}}function w(Y,ah,ai){var U,R,Q,Z,ae,aa,W,T,ac,X,ag,S=[],P,af,ab,V=[];if(Y.cache==true){try{if(!INTERMediatorOnPage.dbCache[Y.name]){INTERMediatorOnPage.dbCache[Y.name]=INTERMediator_DBAdapter.db_query({name:Y.name,records:null,paging:null,fields:ah,parentkeyvalue:null,conditions:null,useoffset:false})}if(ai===null){Q=INTERMediatorOnPage.dbCache[Y.name]}else{Q={recordset:[],count:0};Z=0;for(U in INTERMediatorOnPage.dbCache[Y.name].recordset){ae=INTERMediatorOnPage.dbCache[Y.name].recordset[U];aa=true;W=0;for(R in ai){T=Y.relation[W]["foreign-key"];if(ae[T]!=ai[R]){aa=false;break}W++}if(aa){P=Y.paging?Y.paging:false;af=Y.records?Y.records:10000000000;if(!P||(P&&(Z>=INTERMediator.startFrom))){Q.recordset.push(ae);Q.count++;if(af<=Q.count){break}}Z++}}}}catch(ad){if(ad=="_im_requath_request_"){throw ad}else{INTERMediator.setErrorMessage(ad,"EXCEPTION-24")}}}else{try{if(Y.portal==true){for(ac in INTERMediator.additionalCondition){S.push(INTERMediator.additionalCondition[ac]);break}}ag=false;if(Y.records&&Y.paging){ag=true}if(Y.maxrecords&&ag&&Number(INTERMediator.pagedSize)>0&&Number(Y.maxrecords)>=Number(INTERMediator.pagedSize)){X=Number(INTERMediator.pagedSize)}else{X=Number(Y.records)}Q={};if(Y.portal===true){for(ab=0;ab<Object.keys(Y.currentrecord).length;ab++){if(Y.currentrecord[ab]){V.push(Y.currentrecord[ab])}}Q.recordset=V}else{Q=INTERMediator_DBAdapter.db_query({name:Y.name,records:isNaN(X)?100000000:X,paging:Y.paging,fields:ah,parentkeyvalue:ai,conditions:S,useoffset:true,uselimit:ag})}}catch(ad){if(ad=="_im_requath_request_"){throw ad}else{INTERMediator.setErrorMessage(ad,"EXCEPTION-12")}}}return Q}function n(T){var R,S,P,Q=true;if(T.getAttribute("id")===null){T.setAttribute("id",v())}else{if(INTERMediator.elementIds.indexOf(T.getAttribute("id"))>=0){S=INTERMediatorLib.getLinkedElementInfo(T);for(R=0;R<S.length;R++){P=S[R].split(INTERMediator.separator);if(P[2]=="#id"){Q=false}}if(Q){T.setAttribute("id",v())}}INTERMediator.elementIds.push(T.getAttribute("id"))}return T}function v(){INTERMediator.linkedElmCounter++;return C()}function C(){return"IM"+INTERMediator.currentEncNumber+"-"+INTERMediator.linkedElmCounter}function g(S,R,Q){try{if(INTERMediatorOnPage.additionalExpandingRecordFinish[S.name]){INTERMediatorOnPage.additionalExpandingRecordFinish[S.name](R);INTERMediator.setDebugMessage("Call the post enclosure method 'INTERMediatorOnPage.additionalExpandingRecordFinish["+S.name+"] with the context.",2)}}catch(P){if(P=="_im_requath_request_"){throw P}else{INTERMediator.setErrorMessage(P,"EXCEPTION-33: hint: post-repeater of "+S.name)}}try{if(INTERMediatorOnPage.expandingRecordFinish!=null){INTERMediatorOnPage.expandingRecordFinish(S.name,Q);INTERMediator.setDebugMessage("Call INTERMediatorOnPage.expandingRecordFinish with the context: "+S.name,2)}if(S["post-repeater"]){INTERMediatorOnPage[S["post-repeater"]](Q);INTERMediator.setDebugMessage("Call the post repeater method 'INTERMediatorOnPage."+S["post-repeater"]+"' with the context: "+S.name,2)}}catch(P){if(P=="_im_requath_request_"){throw P}else{INTERMediator.setErrorMessage(P,"EXCEPTION-23")}}}function O(R,Q){try{if(INTERMediatorOnPage.additionalExpandingEnclosureFinish[R.name]){INTERMediatorOnPage.additionalExpandingEnclosureFinish[R.name](Q);INTERMediator.setDebugMessage("Call the post enclosure method 'INTERMediatorOnPage.additionalExpandingEnclosureFinish["+R.name+"] with the context.",2)}}catch(P){if(P=="_im_requath_request_"){throw P}else{INTERMediator.setErrorMessage(P,"EXCEPTION-32: hint: post-enclosure of "+R.name)}}try{if(INTERMediatorOnPage.expandingEnclosureFinish!=null){INTERMediatorOnPage.expandingEnclosureFinish(R.name,Q);INTERMediator.setDebugMessage("Call INTERMediatorOnPage.expandingEnclosureFinish with the context: "+R.name,2)}}catch(P){if(P=="_im_requath_request_"){throw P}else{INTERMediator.setErrorMessage(P,"EXCEPTION-21")}}try{if(R["post-enclosure"]){INTERMediatorOnPage[R["post-enclosure"]](Q);INTERMediator.setDebugMessage("Call the post enclosure method 'INTERMediatorOnPage."+R["post-enclosure"]+"' with the context: "+R.name,2)}}catch(P){if(P=="_im_requath_request_"){throw P}else{INTERMediator.setErrorMessage(P,"EXCEPTION-22: hint: post-enclosure of "+R.name)}}}function c(S,P){var R,T=[],Q;Q=S.childNodes;for(R=0;R<Q.length;R++){if(Q[R].nodeType===1&&Q[R].tagName==P){T.push(Q[R])}}return T}function q(T){var R,U=[],S,P,Q;for(R=0;R<T.length;R++){S=T[R];P=T[R].parentNode;Q=T[R].cloneNode(true);U.push(Q);Q.setAttribute("id",v());P.removeChild(S)}return U}function x(T){var R=[],S,Q,P;for(Q=0;Q<T.length;Q++){S=INTERMediatorLib.getLinkedElementInfo(T[Q]);if(S!==null){for(P=0;P<S.length;P++){R.push(S[P])}}}return R}function D(Y){var W,aa,R,T,S,U,Z,P,Q,V=[],X=[];for(W=0;W<Y.length;W++){aa=INTERMediatorLib.getNodeInfoArray(Y[W]);R=aa.field;T=aa.table;P=aa.tableindex;if(T!=IMLibLocalContext.contextName){if(R!=null&&R.length!=0&&T.length!=0&&T!=null){if(!X[P]){X[P]=[]}X[P].push(R);if(!V[P]){V[P]=1}else{++V[P]}}else{INTERMediator.setErrorMessage(INTERMediatorLib.getInsertedStringFromErrorNumber(1006,[Y[W]]))}}}S=-1;U="";for(Z in V){if(S<V[Z]){S=V[Z];U=Z.substring(10)}}Q=INTERMediatorLib.getNamedObject(INTERMediatorOnPage.getDataSources(),"name",U);return{targettable:Q,fieldlist:X["_im_index_"+U]}}function h(R){var Q,P=[];for(Q=0;Q<R.length;Q++){P.push(R[Q].cloneNode(true))}return P}function I(Z,ab,ac,aa,T,W,Q,R,V){var P,U,S,Y,X;if(!aa["repeat-control"]||!aa["repeat-control"].match(/delete/i)){return}if(aa.relation||aa.records===undefined||(aa.records>1&&Number(INTERMediator.pagedSize)!=1)){P=document.createElement("BUTTON");INTERMediatorLib.setClassAttributeToNode(P,"IM_Button_Delete");P.appendChild(document.createTextNode(INTERMediatorOnPage.getMessages()[6]));U="IM_Button_"+INTERMediator.buttonIdNum;P.setAttribute("id",U);INTERMediator.buttonIdNum++;S=function(am,al,ak,aj,ah){var ae=am,af=al,ag=ak,ai=aj,ad=ah;return function(){IMLibUI.deleteButton(ae,af,ag,Q,R,ai,ad)}};t.push({id:U,event:"click",todo:S(aa.name,T,W,V,aa["repeat-control"].match(/confirm-delete/i))});switch(Z){case"TBODY":Y=ac.getElementsByTagName("TD");X=Y[Y.length-1];X.appendChild(P);break;case"UL":case"OL":ac.appendChild(P);break;case"DIV":case"SPAN":if(ab=="DIV"||ab=="SPAN"){ac.appendChild(P)}break}}else{IMLibPageNavigation.deleteInsertOnNavi.push({kind:"DELETE",name:aa.name,key:T,value:W,confirm:aa["repeat-control"].match(/confirm-delete/i)})}}function G(Y,ad,ac,ak){var R,af,ag,V,aa,ah,aj,ab,W,ae,Z,ai,U,Q,P,X,T,S;T=ac.tagName;S=INTERMediatorLib.repeaterTagFromEncTag(T);if(Y["repeat-control"]&&Y["repeat-control"].match(/insert/i)){if(ak.length>0||!Y.paging||Y.paging===false){R=document.createElement("BUTTON");INTERMediatorLib.setClassAttributeToNode(R,"IM_Button_Insert");R.appendChild(document.createTextNode(INTERMediatorOnPage.getMessages()[5]));X="IM_Button_"+INTERMediator.buttonIdNum;R.setAttribute("id",X);INTERMediator.buttonIdNum++;af=[];switch(T){case"TBODY":ai="TFOOT";if(Y["repeat-control"].match(/top/i)){ai="THEAD"}ag=ac.parentNode;Z=ag.childNodes;V=null;for(ae=0;ae<Z.length;ae++){if(Z[ae].tagName===ai){V=Z[ae];break}}if(V===null){V=document.createElement(ai);ag.appendChild(V)}U=INTERMediatorLib.getElementsByClassName(V,"IM_Button_Insert");if(U.length==0){aa=document.createElement("TR");ah=document.createElement("TD");n(aa);V.appendChild(aa);aa.appendChild(ah);ah.appendChild(R);af=[aa.getAttribute("id")]}break;case"UL":case"OL":aj=document.createElement("LI");U=INTERMediatorLib.getElementsByClassName(aj,"IM_Button_Insert");if(U.length==0){aj.appendChild(R);if(Y["repeat-control"].match(/top/i)){ac.insertBefore(aj,ac.firstChild)}else{ac.appendChild(aj)}}break;case"DIV":case"SPAN":if(S=="DIV"||S=="SPAN"){ab=document.createElement(S);U=INTERMediatorLib.getElementsByClassName(ab,"IM_Button_Insert");if(U.length==0){ab.appendChild(R);if(Y["repeat-control"].match(/top/i)){ac.insertBefore(ab,ac.firstChild)}else{ac.appendChild(ab)}}}break}W=function(av,au,at,ar,ap){var an=av,ao=au,al=at,aq=ar,am=ap;return function(){IMLibUI.insertButton(an,ad,ao,al,aq,am)}};INTERMediatorLib.addEvent(R,"click",W(Y.name,ak,ac.getAttribute("id"),af,Y["repeat-control"].match(/confirm-insert/i)))}else{P=INTERMediatorOnPage.getDBSpecification();if(P["db-class"]!=null&&P["db-class"]=="FileMaker_FX"){Q=Y.key?Y.key:"-recid"}else{Q=Y.key?Y.key:"id"}IMLibPageNavigation.deleteInsertOnNavi.push({kind:"INSERT",name:Y.name,key:Q,confirm:Y["repeat-control"].match(/confirm-insert/i)})}}}function M(V,U,ah,X,R,ae,ac,T){var S,W,P,ab,ag,Y,af,Z,ad,aa,Q;if(!X["navi-control"]||!X["navi-control"].match(/master/i)){return}Z=X["navi-control"].match(/hide/i);Q=Z&&(X.paging==true);if(INTERMediator.detailNodeOriginalDisplay){ad=IMLibContextPool.getDetailContext();if(ad){aa=ad.enclosureNode;if(aa.tagName=="TBODY"){aa=aa.parentNode}INTERMediator.detailNodeOriginalDisplay=aa.style.display}}S=document.createElement("BUTTON");INTERMediatorLib.setClassAttributeToNode(S,"IM_Button_Master");S.appendChild(document.createTextNode(INTERMediatorOnPage.getMessages()[12]));W="IM_Button_"+INTERMediator.buttonIdNum;S.setAttribute("id",W);INTERMediator.buttonIdNum++;P=function(at,an,ap,al,am,aj,aw){var aq=an,av=ap,ai=al,ao=am;var ak={},ar=at,au=aj,ax=aw;ak[ai]=ao;return function(){var az,ay,aC,aB,aD,aA;az=IMLibContextPool.getMasterContext();ay=IMLibContextPool.getDetailContext();if(ay){af=ay.getContextDef();aC=af.name;aA=INTERMediator.additionalCondition;aA[aC]={field:aq,operator:"=",value:av};INTERMediator.additionalCondition=aA;INTERMediator.constructMain(ay);if(au){aB=az.enclosureNode;if(ar=="TBODY"){aB=aB.parentNode}INTERMediator.masterNodeOriginalDisplay=aB.style.display;aB.style.display="none";aD=ay.enclosureNode;if(aD.tagName=="TBODY"){aD=aD.parentNode}aD.style.display=INTERMediator.detailNodeOriginalDisplay}if(ax){document.getElementById("IM_NAVIGATOR").style.display="none"}}}};t.push({id:W,event:"click",todo:P(V,R,ae,ac,T,Z,Q)});switch(V){case"TBODY":ab=ah.getElementsByTagName("TD");ag=ab[0];Y=ag.childNodes[0];if(Y){ag.insertBefore(S,Y)}else{ag.appendChild(S)}break;case"UL":case"OL":Y=ah.childNodes[0];if(Y){ah.insertBefore(S,Y)}else{ah.appendChild(S)}break;case"DIV":case"SPAN":if(U=="DIV"||U=="SPAN"){Y=ah.childNodes[0];if(Y){ah.insertBefore(S,Y)}else{ah.appendChild(S)}}break}}function a(Q,ad){var R,ag,ai,V,aa,aj,al,ac,W,af,Z,ak,U,ae,ah,X,T,Y,ab,S,P;Y=Q.getContextDef();if(!Y["navi-control"]||!Y["navi-control"].match(/detail/i)){return}ae=IMLibContextPool.getMasterContext();ah=ae.getContextDef()["navi-control"];if(!ah||(!ah.match(/hide/i))){return}P=ae.getContextDef()["paging"]==true;ab=Q.enclosureNode;if(ab.tagName=="TBODY"){ab=ab.parentNode}if(INTERMediator.detailNodeOriginalDisplay){INTERMediator.detailNodeOriginalDisplay=ab.style.display}ab.style.display="none";R=document.createElement("BUTTON");INTERMediatorLib.setClassAttributeToNode(R,"IM_Button_BackNavi");R.appendChild(document.createTextNode(INTERMediatorOnPage.getMessages()[13]));X="IM_Button_"+INTERMediator.buttonIdNum;R.setAttribute("id",X);INTERMediator.buttonIdNum++;ag=[];switch(ad.tagName){case"TBODY":if(Y["navi-control"].match(/top/i)){ak="THEAD"}else{if(Y["navi-control"].match(/bottom/i)){ak="TFOOT"}else{ak="THEAD"}}ai=ad.parentNode;Z=ai.childNodes;S=null;for(af=0;af<Z.length;af++){if(Z[af].tagName===ak){S=Z[af];break}}if(S===null){S=document.createElement(ak);r.push({targetNode:S,parentNode:ai,siblingNode:(ak=="THEAD")?ai.firstChild:null})}U=INTERMediatorLib.getElementsByClassName(S,"IM_Button_BackNavi");if(U.length==0){aa=document.createElement("TR");aj=document.createElement("TD");n(aa);S.appendChild(aa);aa.appendChild(aj);aj.appendChild(R);ag=[aa.getAttribute("id")]}break;case"UL":case"OL":al=document.createElement("LI");U=INTERMediatorLib.getElementsByClassName(al,"IM_Button_BackNavi");if(U.length==0){al.appendChild(R);if(Y["repeat-control"].match(/bottom/i)){ad.appendChild(al)}else{ad.insertBefore(al,ad.firstChild)}}break;case"DIV":case"SPAN":T=INTERMediatorLib.repeaterTagFromEncTag(ad.tagName);if(T=="DIV"||T=="SPAN"){ac=document.createElement(T);U=INTERMediatorLib.getElementsByClassName(ac,"IM_Button_BackNavi");if(U.length==0){ac.appendChild(R);if(Y["repeat-control"].match(/bottom/i)){ad.appendChild(ac)}else{ad.insertBefore(ac,ad.firstChild)}}}break}W=function(an,am,ar){var ao=an,ap=am,aq=ar;return function(){var at;at=ap.enclosureNode;if(at.tagName=="TBODY"){at=at.parentNode}at.style.display="none";at=ao.enclosureNode;if(at.tagName=="TBODY"){at=at.parentNode}at.style.display=INTERMediator.masterNodeOriginalDisplay;if(aq){document.getElementById("IM_NAVIGATOR").style.display="block"}}};INTERMediatorLib.addEvent(R,"click",W(ae,Q,P))}function L(R,U,V){var T,S,W,X,Q,P;if(R.nodeType==1){W=INTERMediatorLib.getLinkedElementInfo(R);for(S=0;S<W.length;S++){X=INTERMediatorLib.getNodeInfoArray(W[S]);if(X.table==U&&X.field==V){return R}}}Q=R.childNodes;for(T=0;T<Q.length;T++){P=L(Q[T],U,V);if(P!==null){return P}}return null}function f(){var S,T,R,P,Q;if(document.getElementById("IM_CREDIT")===null){S=document.getElementsByTagName("BODY")[0];T=document.createElement("div");S.appendChild(T);T.setAttribute("id","IM_CREDIT");T.setAttribute("class","IM_CREDIT");R=document.createElement("div");T.appendChild(R);R.style.backgroundColor="#F6F7FF";R.style.height="2px";R=document.createElement("div");T.appendChild(R);R.style.backgroundColor="#EBF1FF";R.style.height="2px";R=document.createElement("div");T.appendChild(R);R.style.backgroundColor="#E1EAFF";R.style.height="2px";R=document.createElement("div");T.appendChild(R);R.setAttribute("align","right");R.style.backgroundColor="#D7E4FF";R.style.padding="2px";P=document.createElement("span");R.appendChild(P);R.style.color="#666666";R.style.fontSize="7pt";Q=document.createElement("a");Q.appendChild(document.createTextNode("INTER-Mediator"));Q.setAttribute("href","http://inter-mediator.com/");Q.setAttribute("target","_href");P.appendChild(document.createTextNode("Generated by "));P.appendChild(Q);P.appendChild(document.createTextNode(" Ver.5.0(2015-02-20)"))}}},getLocalProperty:function(c,a){var d;d=IMLibLocalContext.getValue(c);return d===null?a:d},setLocalProperty:function(a,c){IMLibLocalContext.setValue(a,c,true)},addCondition:function(c,d){var a=INTERMediator.additionalCondition;if(a[c]){a[c].push(d)}else{a[c]=[d]}INTERMediator.additionalCondition=a;IMLibLocalContext.archive()},clearCondition:function(c){var a=INTERMediator.additionalCondition;if(a[c]){delete a[c];INTERMediator.additionalCondition=a;IMLibLocalContext.archive()}},addSortKey:function(d,a){var c=INTERMediator.additionalSortKey;if(c[d]){c[d].push(a)}else{c[d]=[a]}INTERMediator.additionalSortKey=c;IMLibLocalContext.archive()},clearSortKey:function(c){var a=INTERMediator.additionalSortKey;if(a[c]){delete a[c];INTERMediator.additionalSortKey=a;IMLibLocalContext.archive()}}};if(!Object.keys){Object.keys=function(c){var a=[],d;if(c!==Object(c)){throw new TypeError("Object.keys called on a non-object")}for(d in c){if(Object.prototype.hasOwnProperty.call(c,d)){a.push(d)}}return a}}if(!Array.indexOf){var isWebkit="WebkitAppearance" in document.documentElement.style;if(!isWebkit){Array.prototype.indexOf=function(c){var a;for(a=0;a<this.length;a++){if(this[a]===c){return a}}return -1}}}if(typeof String.prototype.trim!=="function"){String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}}var IMLibElement={setValueToIMNode:function(k,f,q,g){var c,p,r,l,e,a,d,m=false,o,n,h;if(q===undefined){return false}if(!k){return false}if(q===null||q===false){q=""}o=k.tagName;if(g===true&&f==""){switch(o){case"INPUT":switch(k.getAttribute("type")){case"text":k.value="";break;default:break}case"SELECT":break;default:while(k.childNodes.length>0){k.removeChild(k.childNodes[0])}break}}if(f!=null&&f.length>0){if(f.charAt(0)=="#"){f=f.substring(1);if(f=="innerHTML"){if(INTERMediator.isIE&&o=="TEXTAREA"){q=q.replace(/\r\n/g,"\r").replace(/\n/g,"\r").replace(/\r/g,"<br>")}k.innerHTML+=q}else{if(f=="textNode"||f=="script"){d=document.createTextNode(q);if(o=="TEXTAREA"){q=q.replace(/\r\n/g,"\r").replace(/\n/g,"\r")}k.appendChild(d)}else{if(f.indexOf("style.")==0){c=f.substring(6,f.length);k.style[c]=q}else{r=k.getAttribute(f);k.setAttribute(f,r+q)}}}}else{if(f.charAt(0)=="$"){f=f.substring(1);if(f=="innerHTML"){if(INTERMediator.isIE&&o=="TEXTAREA"){q=q.replace(/\r\n/g,"\r").replace(/\n/g,"\r").replace(/\r/g,"<br>")}k.innerHTML=k.innerHTML.replace("$",q)}else{if(f=="textNode"||f=="script"){if(o=="TEXTAREA"){q=q.replace(/\r\n/g,"\r").replace(/\n/g,"\r")}k.innerHTML=k.innerHTML.replace("$",q)}else{if(f.indexOf("style.")==0){c=f.substring(6,f.length);k.style[c]=q}else{r=k.getAttribute(f);k.setAttribute(f,r.replace("$",q))}}}}else{if(INTERMediatorLib.isWidgetElement(k)){k._im_setValue(q)}else{if(f=="innerHTML"){if(INTERMediator.isIE&&o=="TEXTAREA"){q=q.replace(/\r\n/g,"\r").replace(/\n/g,"\r").replace(/\r/g,"<br>")}k.innerHTML=q}else{if(f=="textNode"){if(o=="TEXTAREA"){q=q.replace(/\r\n/g,"\r").replace(/\n/g,"\r")}d=document.createTextNode(q);k.appendChild(d)}else{if(f=="script"){d=document.createTextNode(q);if(o=="SCRIPT"){k.appendChild(d)}else{l=document.createElement("script");l.type="text/javascript";l.appendChild(d);k.appendChild(l)}}else{if(f.indexOf("style.")==0){c=f.substring(6,f.length);k.style[c]=q}else{k.setAttribute(f,q)}}}}}}}}else{if(INTERMediatorLib.isWidgetElement(k)){k._im_setValue(q)}else{if(o=="INPUT"){e=k.getAttribute("type");if(e=="checkbox"||e=="radio"){a=k.value;n=q.toString().split("\n");if(e=="checkbox"&&n.length>1){for(h=0;h<n.length;h++){if(a==n[h]&&!INTERMediator.dontSelectRadioCheck){if(INTERMediator.isIE){k.setAttribute("checked","checked")}else{k.checked=true}}}}else{if(a==q&&!INTERMediator.dontSelectRadioCheck){if(INTERMediator.isIE){k.setAttribute("checked","checked")}else{k.checked=true}}else{k.checked=false}}}else{k.value=q}}else{if(o=="SELECT"){m=true;k.value=q}else{if(INTERMediator.defaultTargetInnerHTML){if(INTERMediator.isIE&&o=="TEXTAREA"){q=q.replace(/\r\n/g,"\r").replace(/\n/g,"\r").replace(/\r/g,"<br/>")}k.innerHTML=q}else{if(o=="TEXTAREA"){if(INTERMediator.isTrident&&INTERMediator.ieVersion>=11){q=q.replace(/\r\n/g,"\n").replace(/\r/g,"\n")}else{q=q.replace(/\r\n/g,"\r").replace(/\n/g,"\r")}}d=document.createTextNode(q);k.appendChild(d)}}}}}return m},getValueFromIMNode:function(g){var h,e,c,a,l,m,f,d;if(g){h=g.tagName;e=g.getAttribute("type")}else{return""}if(INTERMediatorLib.isWidgetElement(g)||(INTERMediatorLib.isWidgetElement(g.parentNode))){c=g._im_getValue()}else{if(h=="INPUT"){if(e=="checkbox"){a=INTERMediatorOnPage.getDBSpecification();if(a["db-class"]!=null&&a["db-class"]=="FileMaker_FX"){l=[];m=g.parentNode.getElementsByTagName("INPUT");for(f=0;f<m.length;f++){if(m[f].checked){l.push(m[f].getAttribute("value"))}}c=l.join("\n")}else{d=g.getAttribute("value");if(g.checked){c=d}else{c=""}}}else{if(e=="radio"){c=g.value}else{c=g.value}}}else{if(h=="SELECT"){c=g.value}else{if(h=="TEXTAREA"){c=g.value}else{c=g.innerHTML}}}}return c},checkOptimisticLock:function(c,y){var f,w,x,s,n,u,h,r,o,a,q,l,z,m,d,p,g,e,v;if(!c){return false}f=INTERMediatorLib.getLinkedElementInfo(c);w=INTERMediatorLib.getNodeInfoArray(f[0]);if(w.table==IMLibLocalContext.contextName){return false}x=c.getAttribute("id");s=IMLibContextPool.getContextInfoFromId(x,y);if(INTERMediator.ignoreOptimisticLocking){return true}l=s.context;q=s.field;n=s.record.split("=");u=n[0];n.shift();h=n.join("=");r={name:s.context.contextName,records:1,paging:false,fields:[q],parentkeyvalue:null,conditions:[{field:u,operator:"=",value:h}],useoffset:false,primaryKeyOnly:true};try{o=INTERMediator_DBAdapter.db_query(r)}catch(t){if(t=="_im_requath_request_"){if(INTERMediatorOnPage.requireAuthentication&&!INTERMediatorOnPage.isComplementAuthData()){INTERMediatorOnPage.authChallenge=null;INTERMediatorOnPage.authHashedPassword=null;INTERMediatorOnPage.authenticating(function(){INTERMediator.db_query(r)});return}}else{INTERMediator.setErrorMessage(t,"EXCEPTION-1")}}if(s.portal){p=false;g=s.context.contextName+"::-recid";if(o.recordset&&o.recordset[0]){for(e in o.recordset[0]){var k=o.recordset[0][e];if(k[g]&&k[q]!==undefined&&k[g]==s.portal){v=k[q];p=true}}}if(!p){alert(INTERMediatorLib.getInsertedString(INTERMediatorOnPage.getMessages()[1003],[q]));return false}}else{if(o.recordset===null||o.recordset[0]===null||o.recordset[0][q]===undefined){alert(INTERMediatorLib.getInsertedString(INTERMediatorOnPage.getMessages()[1003],[q]));return false}if(o.totalCount>1){a=confirm(INTERMediatorOnPage.getMessages()[1024]);if(!a){return false}}v=o.recordset[0][q]}z=l.getValue(s.record,q,s.portal);switch(c.tagName){case"INPUT":switch(c.getAttribute("type")){case"checkbox":if(z==c.value){d=false}else{if(!parseInt(v)){d=false}else{d=true}}break;default:d=(z!=v);break}break;default:d=(z!=v);break}if(d){m=IMLibElement.getValueFromIMNode(c);if(!confirm(INTERMediatorLib.getInsertedString(INTERMediatorOnPage.getMessages()[1001],[z,m,v]))){window.setTimeout(function(){c.focus()},0);return false}INTERMediatorOnPage.retrieveAuthInfo()}return true},deleteNodes:function(o){var c,a,m,l,h,f,d,g,e,q,p;for(p in o){c=document.getElementById(o[p]);a=INTERMediatorLib.getElementsByIMManaged(c);if(a){for(m=0;m<a.length;m++){f=a[m].id;if(f in IMLibCalc.calculateRequiredObject){delete IMLibCalc.calculateRequiredObject[f]}}for(m=0;m<a.length;m++){f=a[m].id;for(d in IMLibCalc.calculateRequiredObject){g=IMLibCalc.calculateRequiredObject[d];e={};q={};for(l in g.referes){e[l]=[],q[l]=[];for(h=0;h<g.referes[l].length;h++){if(f!=g.referes[l][h]){e[l].push(g.referes[l][h]);q[l].push(g.values[l][h])}}}g.referes=e;g.values=q}}}try{c.parentNode.removeChild(c)}catch(n){}}}};IMLibEventResponder={isSetup:false,setup:function(){var a;if(IMLibEventResponder.isSetup){return}IMLibEventResponder.isSetup=true;IMLibChangeEventDispatch=new IMLibEventDispatch();IMLibKeyEventDispatch=new IMLibEventDispatch();IMLibMouseEventDispatch=new IMLibEventDispatch();a=document.getElementsByTagName("BODY")[0];INTERMediatorLib.addEvent(a,"change",function(h){var f=h?h:window.event;if(!f){return}var g=f.target;if(!g){g=f.srcElement;if(!g){return}}var d=g.id;if(!d){return}var c=IMLibChangeEventDispatch.dispatchTable[d];if(!c){return}c(d)});INTERMediatorLib.addEvent(a,"keydown",function(k){var g,c,h,f;g=k?k:window.event;if(g.charCode){c=g.charCode}else{c=g.keyCode}if(!g){return}h=g.target;if(!h){h=g.srcElement;if(!h){return}}f=h.id;if(!f){return}if(!IMLibKeyEventDispatch.dispatchTable[f]){return}var d=IMLibKeyEventDispatch.dispatchTable[f][c];if(!d){return}d(g)});INTERMediatorLib.addEvent(a,"click",function(g){var c,h,d,n,k,f,m,l;c=g?g:window.event;if(!c){return}h=c.target;if(!h){h=c.srcElement;if(!h){return}}d=h.id;if(!d){return}n=IMLibMouseEventDispatch.dispatchTable[d];if(n){n(c);return}k=INTERMediatorLib.getLinkedElementInfo(h);for(f=0;f<k.length;f++){n=IMLibMouseEventDispatch.dispatchTableTarget[k[f]];if(n){m=INTERMediatorLib.getNodeInfoArray(k[f]);if(m.target){l=h.getAttribute(m.target)}else{l=IMLibElement.getValueFromIMNode(h)}n(l,h);return}}})}};var IMLibChangeEventDispatch;var IMLibKeyEventDispatch;var IMLibMouseEventDispatch;function IMLibEventDispatch(){this.dispatchTable={};this.dispatchTableTarget={};this.clearAll=function(){this.dispatchTable={};this.dispatchTableTarget={}};this.setExecute=function(c,a){if(c&&a){this.dispatchTable[c]=a}};this.setTargetExecute=function(c,a){if(c&&a){this.dispatchTableTarget[c]=a}};this.setExecuteByCode=function(d,c,a){if(d&&c){if(!this.dispatchTable[d]){this.dispatchTable[d]={}}this.dispatchTable[d][c]=a}}}IMLibContextPool={poolingContexts:null,clearAll:function(){this.poolingContexts=null},registerContext:function(a){if(this.poolingContexts==null){this.poolingContexts=[a]}else{this.poolingContexts.push(a)}},excludingNode:null,synchronize:function(a,c,n,m,g,k){var e,d,l,f,h,o=false;l=a.viewName;if(this.poolingContexts==null){return null}if(k){for(e=0;e<this.poolingContexts.length;e++){if(this.poolingContexts[e].viewName===l&&this.poolingContexts[e].binding[c]!==undefined&&this.poolingContexts[e].binding[c][n]!==undefined&&this.poolingContexts[e].binding[c][n][k]!==undefined&&this.poolingContexts[e].store[c]!==undefined&&this.poolingContexts[e].store[c][n]!==undefined&&this.poolingContexts[e].store[c][n][k]!==undefined){this.poolingContexts[e].store[c][n][k]=m;h=this.poolingContexts[e].binding[c][n][k];for(d=0;d<h.length;d++){f=document.getElementById(h[d].id);if(f){IMLibElement.setValueToIMNode(f,h[d].target,m,true)}}}}}else{for(e=0;e<this.poolingContexts.length;e++){if(this.poolingContexts[e].viewName===l&&this.poolingContexts[e].binding[c]!==undefined&&this.poolingContexts[e].binding[c][n]!==undefined&&this.poolingContexts[e].store[c]!==undefined&&this.poolingContexts[e].store[c][n]!==undefined){this.poolingContexts[e].store[c][n]=m;h=this.poolingContexts[e].binding[c][n];for(d=0;d<h.length;d++){f=document.getElementById(h[d].id);if(f){IMLibElement.setValueToIMNode(f,h[d].target,m,true)}}}}}return o},getContextInfoFromId:function(a,h){var e,c,f,g,k,d,l=null;if(!a){return l}f=document.getElementById(a);g=INTERMediatorLib.getLinkedElementInfo(f);if(!g&&INTERMediatorLib.isWidgetElement(f.parentNode)){g=INTERMediatorLib.getLinkedElementInfo(f.parentNode)}k=INTERMediatorLib.getNodeInfoArray(g[0]);d=h===""?"_im_no_target":h;for(e=0;e<this.poolingContexts.length;e++){c=this.poolingContexts[e];if(c.contextInfo[a]&&c.contextInfo[a][d]&&c.contextInfo[a][d].context.contextName==k.table){l=c.contextInfo[a][d]}}return l},getKeyFieldValueFromId:function(a,e){var c=this.getContextInfoFromId(a,e);if(!c){return null}var g=c.context.contextName;var d=IMLibContextPool.getContextDef(g);if(!d){return null}var f=d.key?d.key:"id";return c.record.substr(f.length+1)},getContextDef:function(a){return INTERMediatorLib.getNamedObject(INTERMediatorOnPage.getDataSources(),"name",a)},updateContext:function(a,e){var c,d;c=IMLibContextPool.getContextInfoFromId(a,e);d=IMLibElement.getValueFromIMNode(document.getElementById(a));if(c){c.context.setValue(c.record,c.field,d,false,e,c.portal)}},contextFromEnclosureId:function(a){var c,d;if(!a){return false}for(c=0;c<this.poolingContexts.length;c++){d=this.poolingContexts[c].enclosureNode;if(d.getAttribute("id")==a){return this.poolingContexts[c]}}return null},contextFromName:function(a){var c;if(!a){return false}for(c=0;c<this.poolingContexts.length;c++){if(this.poolingContexts[c].contextName==a){return this.poolingContexts[c]}}return null},getContextFromName:function(c){var d,a=[];if(!c){return false}for(d=0;d<this.poolingContexts.length;d++){if(this.poolingContexts[d].contextName==c){a.push(this.poolingContexts[d])}}return a},getContextsFromNameAndForeignValue:function(c,d,g){var f,e,a=[],g;if(!c){return false}for(f=0;f<this.poolingContexts.length;f++){if(this.poolingContexts[f].contextName==c&&this.poolingContexts[f].foreignValue[g]==d){a.push(this.poolingContexts[f])}}return a},dependingObjects:function(c){var e,d,a=[];if(!c){return false}for(e=0;e<this.poolingContexts.length;e++){for(d=0;d<this.poolingContexts[e].dependingObject.length;d++){if(this.poolingContexts[e].dependingObject[d]==c){a.push(this.poolingContexts[e])}}}return a.length==0?false:a},getChildContexts:function(c){var d,a=[];for(d=0;d<this.poolingContexts.length;d++){if(this.poolingContexts[d].parentContext==c){a.push(this.poolingContexts[d])}}return a},childContexts:null,removeContextsFromPool:function(e){var a,d=[],c=[];for(a=0;a<this.poolingContexts.length;a++){if(e.indexOf(this.poolingContexts[a])>-1){d.push(this.poolingContexts[a].registeredId);c.push(a)}}for(a=c.length-1;a>-1;a--){this.poolingContexts.splice(c[a],1)}return d},removeRecordFromPool:function(n){var f,e,d,h,l,k=[],m=-1,c,g=null,a;for(f=0;f<this.poolingContexts.length;f++){for(h in this.poolingContexts[f].binding){for(l in this.poolingContexts[f].binding[h]){if(l=="_im_repeater"){for(e=0;e<this.poolingContexts[f].binding[h][l].length;e++){if(n==this.poolingContexts[f].binding[h][l][e].id){g=this.poolingContexts[f].binding[h];c=h;m=f}}}}}}for(l in g){for(e=0;e<g[l].length;e++){k.push(g[l][e].id)}}if(m>-1){for(a in this.poolingContexts[m].contextInfo){if(k.indexOf(a)>=0){delete this.poolingContexts[m].contextInfo[a]}}delete this.poolingContexts[m].binding[c];delete this.poolingContexts[m].store[c]}this.poolingContexts=this.poolingContexts.filter(function(o){return k.indexOf(o.enclosureNode.id)<0})},updateOnAnotherClient:function(m,a){var h,g,f,o=a.entity,l,p,e,c;if(m=="update"){for(h=0;h<this.poolingContexts.length;h++){l=this.getContextDef(this.poolingContexts[h].contextName);p=l.view?l.view:l.name;if(p==o){e=l.key;c=e+"="+a.pkvalue;this.poolingContexts[h].setValue(c,a.field[0],a.value[0]);var d=this.poolingContexts[h].binding[c][a.field[0]];for(g=0;g<d.length;g++){var n=IMLibContextPool.dependingObjects(d[g].id);for(f=0;f<n.length;f++){n[f].foreignValue={};n[f].foreignValue[a.field[0]]=a.value[0];if(n[f]){INTERMediator.constructMain(n[f])}}}}}IMLibCalc.recalculation()}else{if(m=="create"){for(h=0;h<this.poolingContexts.length;h++){l=this.getContextDef(this.poolingContexts[h].contextName);p=l.view?l.view:l.name;if(p==o){if(this.poolingContexts[h].isContaining(a.value[0])){INTERMediator.constructMain(this.poolingContexts[h],a.value)}}}IMLibCalc.recalculation()}else{if(m=="delete"){for(h=0;h<this.poolingContexts.length;h++){l=this.getContextDef(this.poolingContexts[h].contextName);p=l.view?l.view:l.name;if(p==o){this.poolingContexts[h].removeEntry(a.pkvalue)}}IMLibCalc.recalculation()}}}},getMasterContext:function(){var a,c;if(!this.poolingContexts){return null}for(a=0;a<this.poolingContexts.length;a++){c=this.poolingContexts[a].getContextDef();if(c["navi-control"]&&c["navi-control"].match(/master/)){return this.poolingContexts[a]}}return null},getDetailContext:function(){var a,c;if(!this.poolingContexts){return null}for(a=0;a<this.poolingContexts.length;a++){c=this.poolingContexts[a].getContextDef();if(c["navi-control"]&&c["navi-control"].match(/detail/)){return this.poolingContexts[a]}}return null}};IMLibContext=function(a){this.contextName=a;this.tableName=null;this.viewName=null;this.store={};this.binding={};this.contextInfo={};this.modified={};this.recordOrder=[];this.pendingOrder=[];IMLibContextPool.registerContext(this);this.foreignValue={};this.enclosureNode=null;this.repeaterNodes=null;this.dependingObject=[];this.original=null;this.nullAcceptable=true;this.parentContext=null;this.registeredId=null;this.sequencing=false;this.dependingParentObjectInfo=null;this.getInsertOrder=function(d){var c,k=[],h,g,f=[],e=[];for(c in INTERMediator.additionalSortKey){if(c==this.contextName){k.push(INTERMediator.additionalSortKey[c])}}h=this.getContextDef();if(h.sort){k.push(h.sort)}for(g=0;g<k.length;g++){if(f.indexOf(k[g].field)<0){f.push(k[g].field);e.push(k[g].direction)}}};this.clearAll=function(){this.store={};this.binding={}};this.setContextName=function(c){this.contextName=c};this.setTableName=function(c){this.tableName=c};this.setViewName=function(c){this.viewName=c};this.addDependingObject=function(c){this.dependingObject.push(c)};this.addForeignValue=function(d,c){this.foreignValue[d]=c};this.setOriginal=function(d){var c;this.original=[];for(c=0;c<d.length;c++){this.original.push(d[c].cloneNode(true))}};this.setTable=function(c){var d;if(!c||!INTERMediatorOnPage.getDataSources){this.tableName=this.contextName;this.viewName=this.contextName;return}d=this.getContextDef();if(d){this.viewName=d.view?d.view:d.name;this.tableName=d.table?d.table:d.name}};this.removeContext=function(){var e=[],d=[];c(this);e=IMLibContextPool.removeContextsFromPool(d);while(this.enclosureNode.firstChild){this.enclosureNode.removeChild(this.enclosureNode.firstChild)}INTERMediator_DBAdapter.unregister(e);function c(h){var g,f;d.push(h);e.push(h.registeredId);f=IMLibContextPool.getChildContexts(h);for(g=0;g<f.length;g++){c(f[g])}}};this.setModified=function(e,c,d){if(this.modified[e]===undefined){this.modified[e]={}}this.modified[e][c]=d};this.getModified=function(){return this.modified};this.clearModified=function(){this.modified={}};this.getContextDef=function(){var c;c=INTERMediatorLib.getNamedObject(INTERMediatorOnPage.getDataSources(),"name",this.contextName);return c};this.checkOrder=function(m,q){var e,h=[],n=[],r,l,f,p,k,c,d,g,o;if(q!==true){if(INTERMediator&&INTERMediator.additionalSortKey[this.contextName]){for(e=0;e<INTERMediator.additionalSortKey[this.contextName].length;e++){r=INTERMediator.additionalSortKey[this.contextName][e];if(!r.field in h){h.push(r.field);n.push(r.direction)}}}l=this.getContextDef();if(l&&l.sort){for(e=0;e<l.sort.length;e++){r=l.sort[e];if(!r.field in h){h.push(r.field);n.push(r.direction)}}}}else{h=["field1","field2"]}f=0;p=this.recordOrder.length;for(e=0;e<h.length;e++){if(m[h[e]]){k=parseInt((p+f)/2);do{c=this.store[this.recordOrder[k]];d=c[h[e]];g=m[h[e]];if(d<g){f=k}else{if(d>g){p=k}else{f=p=k}}k=parseInt((p+f)/2)}while(p-f>1);c=this.store[this.recordOrder[k]];d=c[h[e]];if(d==g){f=p=k;o=false;do{c=this.store[this.recordOrder[f-1]];if(c&&c[h[e]]&&c[h[e]]==g){f--}else{o=true}}while(!o);o=false;do{c=this.store[this.recordOrder[p+1]];if(c&&c[h[e]]&&c[h[e]]==g){p++}else{o=true}}while(!o);if(f==p){break}p++}else{if(d<g){break}else{if(d>g){k--;break}}}}}if(q===true){console.log("#lower="+f+",upper="+p+",index="+k+",contextValue="+d+",checkingValue="+g)}return k};this.rearrangePendingOrder=function(f){var e,d,c;for(e=0;e<this.pendingOrder.length;e++){c=this.store[this.pendingOrder[e]];d=this.checkOrder(c,f);if(d>=-1){this.recordOrder.splice(d+1,0,this.pendingOrder[e])}else{}}this.pendingOrder=[]};this.getRepeaterEndNode=function(l){var d,n,k=[],m,f,g,o,h,c;var e=this.recordOrder[l];for(n in this.binding[e]){d=this.binding[e][n].nodeId;m=INTERMediatorLib.getParentRepeater(document.getElementById(d));if(!m in k){k.push(m)}}if(k.length<1){return null}f=k[0];h=INTERMediatorLib.getParentEnclosure(f);c=h.childNodes;for(g=0;g<c.length;g++){if(c[g] in k){f=k[g];break}}return f};this.setDataAtLastRecord=function(d,f){var c,e;var g=Object.keys(this.store);if(g.length>0){c=g[g.length-1];this.setValue(c,d,f);e=c.split("=");INTERMediator_DBAdapter.db_update({name:this.contextName,conditions:[{field:e[0],operator:"=",value:e[1]}],dataset:[{field:d,value:f}]});IMLibCalc.recalculation();INTERMediator.flushMessage()}};this.setDataWithKey=function(f,e,k){var c,h,g,d;var l=Object.keys(this.store);h=this.getContextDef();if(!h){return}c=h.key+"="+f;d=this.store[c];if(d){this.setValue(c,e,k);INTERMediator_DBAdapter.db_update({name:this.contextName,conditions:[{field:h.key,operator:"=",value:f}],dataset:[{field:e,value:k}]});INTERMediator.flushMessage()}};this.setValue=function(h,d,e,g,f,c){if(h!=undefined&&h!=null){if(this.store[h]===undefined){this.store[h]={}}if(c&&this.store[h][d]===undefined){this.store[h][d]={}}if(this.binding[h]===undefined){this.binding[h]={};if(this.sequencing){this.recordOrder.push(h)}else{this.pendingOrder.push(h)}}if(this.binding[h][d]===undefined){this.binding[h][d]=[]}if(c&&this.binding[h][d][c]===undefined){if(this.binding[h][d].length<1){this.binding[h][d]={}}this.binding[h][d][c]=[]}if(d!=undefined&&d!=null){if(c){this.store[h][d][c]=e}else{this.store[h][d]=e}if(g){if(c){this.binding[h][d][c].push({id:g,target:f})}else{this.binding[h][d].push({id:g,target:f})}if(this.contextInfo[g]===undefined){this.contextInfo[g]={}}this.contextInfo[g][f==""?"_im_no_target":f]={context:this,record:h,field:d};if(c){this.contextInfo[g][f==""?"_im_no_target":f].portal=c}}else{IMLibContextPool.synchronize(this,h,d,e,f,c)}}}};this.getValue=function(g,e,c){var f;try{if(c){f=this.store[g][e][c]}else{f=this.store[g][e]}return f===undefined?null:f}catch(d){return null}};this.getContextInfo=function(f,e){try{var d=this.contextInfo[f][e==""?"_im_no_target":e];return d===undefined?null:d}catch(c){return null}};this.getContextValue=function(g,f){try{var e=this.contextInfo[g][f==""?"_im_no_target":f];var d=e.context.getValue(e.record,e.field);return d===undefined?null:d}catch(c){return null}};this.removeEntry=function(d){var e,k,c,h,l,n,f,g,m=[];h=this.getContextDef();e=h.key;k=e+"="+d;c=this.binding[k];if(c){n=c._im_repeater;if(n){for(f=0;f<n.length;f++){m.push(n[f].id)}}}if(m.length>0){for(f=0;f<m.length;f++){IMLibContextPool.removeRecordFromPool(m[f])}for(f=0;f<m.length;f++){l=document.getElementById(m[f]);if(l){g=INTERMediatorLib.getParentRepeater(l);if(g){g.parentNode.removeChild(l)}}}}};this.isContaining=function(l){var h,e,p=[],g,n,q,o,d,m,k,c;h=this.getContextDef();e=h.name;if(h.query){for(g in h.query){p.push(f(h.query[g],l))}}if(INTERMediator.additionalCondition[e]){for(g=0;g<INTERMediator.additionalCondition[e].length;g++){p.push(f(INTERMediator.additionalCondition[e][g],l))}}q=true;if(p.length!=0){o=p.indexOf("D");if(o>-1){d=p.slice(0,o);m=o.slice(o+1);if(m.length==0){q=(d.indexOf(false)<0)}else{k=(d.indexOf(false)<0);c=(m.indexOf(false)<0);q=k||c}}else{o=p.indexOf("EX");if(o>-1){d=p.slice(0,o);m=o.slice(o+1);if(m.length==0){q=(d.indexOf(true)>-1)}else{k=(d.indexOf(true)>-1);c=(m.indexOf(true)>-1);q=k&&c}}else{o=p.indexOf(false);if(o>-1){q=(p.indexOf(false)<0)}}}if(q==false){return false}}if(this.foreignValue){for(n in this.foreignValue){if(h.relation){for(g in h.relation){if(h.relation[g]["join-field"]==n){q&=(f({field:h.relation[g]["foreign-key"],operator:"=",value:this.foreignValue[n]},l))}}}}}return q;function f(s,r){var t;if(s.field=="__operation__"){return s.operator=="ex"?"EX":"D"}t=r[s.field];if(!t){return false}switch(s.operator){case"=":case"eq":return t==s.value;break;case">":case"gt":return t>s.value;break;case"<":case"lt":return t<s.value;break;case">=":case"gte":return t>=s.value;break;case"<=":case"lte":return t<=s.value;break;case"!=":case"neq":return t!=s.value;break;default:return false}}};this.insertEntry=function(h,c,d){var e,g,f;for(e=0;e<c.length;e++){g=c[e];f=d[e];this.setValue(h,g,f)}};this.setTable(this)};IMLibLocalContext={contextName:"_",store:{},binding:{},clearAll:function(){this.store={}},setValue:function(e,h,c){var d,g,a,f;g=false;if(e!=undefined&&e!=null){if(h===undefined||h===null){delete this.store[e]}else{this.store[e]=h;g=true;a=this.binding[e];if(a){for(d=0;d<a.length;d++){f=document.getElementById(a[d]);IMLibElement.setValueToIMNode(f,"",h,true)}}}}if(g&&!(c===true)){this.archive()}},getValue:function(a){var c=this.store[a];return c===undefined?null:c},archive:function(){var c;INTERMediatorOnPage.removeCookie("_im_localcontext");if(INTERMediator.isIE&&INTERMediator.ieVersion<9){this.store._im_additionalCondition=INTERMediator.additionalCondition;this.store._im_additionalSortKey=INTERMediator.additionalSortKey;this.store._im_startFrom=INTERMediator.startFrom;this.store._im_pagedSize=INTERMediator.pagedSize;c=JSON.stringify(this.store,function(e,d){return d===""?"":d})}else{c=JSON.stringify(this.store)}if(INTERMediator.useSessionStorage===true&&typeof sessionStorage!=="undefined"&&sessionStorage!==null){try{sessionStorage.setItem("_im_localcontext"+document.URL,c)}catch(a){INTERMediatorOnPage.setCookieWorker("_im_localcontext",c,false,0)}}else{INTERMediatorOnPage.setCookieWorker("_im_localcontext",c,false,0)}},unarchive:function(){var c="";if(INTERMediator.useSessionStorage===true&&typeof sessionStorage!=="undefined"&&sessionStorage!==null){try{c=sessionStorage.getItem("_im_localcontext"+document.URL)}catch(a){c=INTERMediatorOnPage.getCookie("_im_localcontext")}}else{c=INTERMediatorOnPage.getCookie("_im_localcontext")}if(c&&c.length>0){this.store=JSON.parse(c);if(INTERMediator.isIE&&INTERMediator.ieVersion<9){if(this.store._im_additionalCondition){INTERMediator.additionalCondition=this.store._im_additionalCondition}if(this.store._im_additionalSortKey){INTERMediator.additionalSortKey=this.store._im_additionalSortKey}if(this.store._im_startFrom){INTERMediator.startFrom=this.store._im_startFrom}if(this.store._im_pagedSize){INTERMediator.pagedSize=this.store._im_pagedSize}}this.updateAll()}},binding:function(c){var l,k,a,e,h,d;if(c.nodeType!=1){return}l=INTERMediatorLib.getLinkedElementInfo(c);for(e=0;e<l.length;e++){k=INTERMediatorLib.getNodeInfoArray(l[e]);if(k.table==this.contextName){if(!c.id){c.id=g()}a=c.id;if(!this.binding[k.field]){this.binding[k.field]=[]}this.binding[k.field].push(a);d=k.field.split(":");switch(d[0]){case"addorder":IMLibMouseEventDispatch.setExecute(a,IMLibUI.eventAddOrderHandler);break;case"update":IMLibMouseEventDispatch.setExecute(a,(function(){var m=d[1];return function(){IMLibUI.eventUpdateHandler(m)}})());break;case"condition":IMLibKeyEventDispatch.setExecuteByCode(a,13,(function(){var m=d[1];return function(){INTERMediator.startFrom=0;IMLibUI.eventUpdateHandler(m)}})());break;case"limitnumber":IMLibChangeEventDispatch.setExecute(a,(function(){var m=d[1];return function(){INTERMediator.pagedSize=document.getElementById(a).value;IMLibUI.eventUpdateHandler(m)}})());break;default:IMLibChangeEventDispatch.setExecute(a,IMLibUI.valueChange);break}h=this.store[k.field];IMLibElement.setValueToIMNode(c,k.target,h,true)}}function g(){INTERMediator.linkedElmCounter++;return f()}function f(){return"IM"+INTERMediator.currentEncNumber+"-"+INTERMediator.linkedElmCounter}},update:function(a){var f,c,g,e,d;f=document.getElementById(a);c=IMLibElement.getValueFromIMNode(f);g=INTERMediatorLib.getLinkedElementInfo(f);for(d=0;d<g.length;d++){e=INTERMediatorLib.getNodeInfoArray(g[d]);if(e.table==this.contextName){this.setValue(e.field,c)}}},updateAll:function(){var c,e,d,a,f;for(e in this.binding){d=this.binding[e];for(c=0;c<d.length;c++){a=d[c];f=document.getElementById(a);if(f&&(f.tagName=="INPUT"||f.tagName=="TEXTAREA"||f.tagName=="SELECT")){IMLibLocalContext.update(a);break}}}},bindingDescendant:function(c){var a=this;d(c);function d(h){var g,f;if(h.nodeType===1){try{a.binding(h);g=h.childNodes;if(g){for(f=0;f<g.length;f++){d(g[f])}}}catch(e){if(e=="_im_requath_request_"){throw e}else{INTERMediator.setErrorMessage(e,"EXCEPTION-31")}}}}}};var INTERMediatorLib={ignoreEnclosureRepeaterClassName:"_im_ignore_enc_rep",ignoreEnclosureRepeaterControlName:"ignore_enc_rep",rollingRepeaterClassName:"_im_repeater",rollingEnclosureClassName:"_im_enclosure",rollingRepeaterDataControlName:"repeater",rollingEnclosureDataControlName:"enclosure",cachedDigitSeparator:null,initialize:function(){var c,g,a,f,e;try{c=new Number(1000.1);g=c.toLocaleString();a=g.substr(-2,1);g=g.substring(0,g.length-2);f=g.match(/[^0-9]/)[0];e=g.length-g.indexOf(f)-1;INTERMediatorLib.cachedDigitSeparator=[a,f,e]}catch(d){INTERMediatorLib.cachedDigitSeparator=[".",",",3]}IMLibLocalContext.unarchive();return null},setup:function(){if(window.addEventListener){window.addEventListener("load",this.initialize,false)}else{if(window.attachEvent){window.attachEvent("onload",this.initialize)}else{window.onload=this.initialize}}return null},digitSeparator:function(){return this.cachedDigitSeparator},generatePasswordHash:function(e){var g,f,d,h,a,c;g=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F"];f="";d="";for(i=0;i<4;i++){h=Math.floor(Math.random()*(128-32)+32);a=h&15;c=(h>>4)&15;f+=String.fromCharCode(h);d+=g[c]+g[a]}return encodeURIComponent(SHA1(e+f)+d)},getParentRepeater:function(c){var a=c;while(a!=null){if(INTERMediatorLib.isRepeater(a,true)){return a}a=a.parentNode}return null},getParentEnclosure:function(c){var a=c;while(a!=null){if(INTERMediatorLib.isEnclosure(a,true)){return a}a=a.parentNode}return null},isEnclosure:function(g,h){var d,f,c,a,e;if(!g||g.nodeType!==1){return false}f=INTERMediatorLib.getClassAttributeFromNode(g);if(f&&f.indexOf(INTERMediatorLib.ignoreEnclosureRepeaterClassName)>=0){return false}e=g.getAttribute("data-im-control");if(e&&e.indexOf(INTERMediatorLib.ignoreEnclosureRepeaterControlName)>=0){return false}d=g.tagName;if((d==="TBODY")||(d==="UL")||(d==="OL")||(d==="SELECT")||((d==="DIV"||d==="SPAN")&&f&&f.indexOf(INTERMediatorLib.rollingEnclosureClassName)>=0)||((d==="DIV"||d==="SPAN")&&e&&e.indexOf(INTERMediatorLib.rollingEnclosureDataControlName)>=0)){if(h){return true}else{c=g.childNodes;for(a=0;a<c.length;a++){if(INTERMediatorLib.isRepeater(c[a],true)){return true}}}}return false},isRepeater:function(h,l){var e,g,d,c,f;if(!h||h.nodeType!==1){return false}g=INTERMediatorLib.getClassAttributeFromNode(h);if(g&&g.indexOf(INTERMediatorLib.ignoreEnclosureRepeaterClassName)>=0){return false}f=h.getAttribute("data-im-control");if(f&&f.indexOf(INTERMediatorLib.ignoreEnclosureRepeaterControlName)>=0){return false}e=h.tagName;if((e==="TR")||(e==="LI")||(e==="OPTION")||((e==="DIV"||e==="SPAN")&&g&&g.indexOf(INTERMediatorLib.rollingRepeaterClassName)>=0)||((e==="DIV"||e==="SPAN")&&f&&f.indexOf(INTERMediatorLib.rollingRepeaterDataControlName)>=0)){if(l){return true}else{return a(h)}}return false;function a(k){if(INTERMediatorLib.isLinkedElement(k)){return true}d=k.childNodes;for(c=0;c<d.length;c++){if(d[c].nodeType===1){if(INTERMediatorLib.isLinkedElement(d[c])){return true}else{if(a(d[c])){return true}}}}return false}},isLinkedElement:function(d){var e,c,a;if(d!=null){a=d.getAttribute("data-im");if(a){return true}if(INTERMediator.titleAsLinkInfo){if(d.getAttribute("TITLE")!=null&&d.getAttribute("TITLE").length>0){return true}}if(INTERMediator.classAsLinkInfo){e=INTERMediatorLib.getClassAttributeFromNode(d);if(e!=null){c=e.match(/IM\[.*\]/);if(c){return true}}}}return false},isWidgetElement:function(e){var f,d,c,a;if(!e){return false}if(INTERMediatorLib.getLinkedElementInfo(e)){c=e.getAttribute("data-im-widget");if(c){return true}f=INTERMediatorLib.getClassAttributeFromNode(e);if(f!=null){d=f.match(/IM_WIDGET\[.*\]/);if(d){return true}}}else{a=e.parentNode;if(!a&&INTERMediatorLib.getLinkedElementInfo(a)){c=a.getAttribute("data-im-widget");if(c){return true}f=INTERMediatorLib.getClassAttributeFromNode(a);if(f!=null){d=f.match(/IM_WIDGET\[.*\]/);if(d){return true}}}}return false},isNamedElement:function(c){var d,a;if(c!=null){d=c.getAttribute("data-im-group");if(d){return true}d=c.getAttribute("name");if(d){a=d.match(/IM\[.*\]/);if(a){return true}}}return false},getEnclosureSimple:function(a){if(INTERMediatorLib.isEnclosure(a,true)){return a}return INTERMediatorLib.getEnclosureSimple(a.parentNode)},getEnclosure:function(e){var d,c;d=e;while(d!=null){if(INTERMediatorLib.isRepeater(d,true)){c=d}else{if(a(c,d)){c=null;return d}}d=d.parentNode}return null;function a(o,m){var n,g,h,f,k,l,p;if(!o||!m){return false}n=o.tagName;g=m.tagName;if((n==="TR"&&g==="TBODY")||(n==="OPTION"&&g==="SELECT")||(n==="LI"&&g==="OL")||(n==="LI"&&g==="UL")){return true}if((g==="DIV"||g==="SPAN")){h=INTERMediatorLib.getClassAttributeFromNode(m);k=m.getAttribute("data-im-control");if((h&&h.indexOf("_im_enclosure")>=0)||(k&&k=="enclosure")){f=INTERMediatorLib.getClassAttributeFromNode(o);l=o.getAttribute("data-im-control");if((n==="DIV"||n==="SPAN")&&((f&&f.indexOf("_im_repeater")>=0)||(l&&l=="repeater"))){return true}else{if(n==="INPUT"){p=o.getAttribute("type");if(p&&((p.indexOf("radio")>=0||p.indexOf("check")>=0))){return true}}}}}return false}},getLinkedElementInfo:function(k){var d=[],e,h,f,c,a;if(INTERMediatorLib.isLinkedElement(k)){c=k.getAttribute("data-im");if(c!==null&&c.length>0){h=new RegExp("[\\s"+INTERMediator.defDivider+"]+");e=c.split(h);for(f=0;f<e.length;f++){if(e[f]&&e[f].length>0){d.push(g(e[f]))}}return d}if(INTERMediator.titleAsLinkInfo&&k.getAttribute("TITLE")!=null){e=k.getAttribute("TITLE").split(INTERMediator.defDivider);for(f=0;f<e.length;f++){d.push(g(e[f]))}return d}if(INTERMediator.classAsLinkInfo){c=INTERMediatorLib.getClassAttributeFromNode(k);if(c!==null&&c.length>0){a=c.match(/IM\[([^\]]*)\]/);e=a[1].split(INTERMediator.defDivider);for(f=0;f<e.length;f++){d.push(g(e[f]))}}return d}}return false;function g(m){var l=INTERMediatorOnPage.getOptionsAliases();if(l!=null&&l[m]!=null){return l[m]}return m}},getWidgetInfo:function(h){var c=[],d,f,e,a,g;if(INTERMediatorLib.isWidgetElement(h)){e=h.getAttribute("data-im-widget");if(e&&e.length>0){g=new RegExp("[\\s"+INTERMediator.defDivider+"]+");d=e.split(g);for(f=0;f<d.length;f++){if(d[f]&&d[f].length>0){c.push(d[f])}}return c}e=INTERMediatorLib.getClassAttributeFromNode(h);if(e&&e.length>0){a=e.match(/IM_WIDGET\[([^\]]*)\]/);d=a[1].split(INTERMediator.defDivider);for(f=0;f<d.length;f++){c.push(d[f])}return c}}return false},getNamedInfo:function(h){var c=[],d,f,e,a,g;if(INTERMediatorLib.isNamedElement(h)){e=h.getAttribute("data-im-group");if(e&&e.length>0){g=new RegExp("[\\s"+INTERMediator.defDivider+"]+");d=e.split(g);for(f=0;f<d.length;f++){if(d[f]&&d[f].length>0){c.push(d[f])}}return c}e=h.getAttribute("name");if(e&&e.length>0){a=e.match(/IM\[([^\]]*)\]/);d=a[1].split(INTERMediator.defDivider);for(f=0;f<d.length;f++){c.push(d[f])}return c}}return false},repeaterTagFromEncTag:function(a){if(a=="TBODY"){return"TR"}else{if(a=="SELECT"){return"OPTION"}else{if(a=="UL"){return"LI"}else{if(a=="OL"){return"LI"}else{if(a=="DIV"){return"DIV"}else{if(a=="SPAN"){return"SPAN"}}}}}}return null},getNodeInfoArray:function(c){var f,a,e,d;if(!c||!c.split){return{table:null,field:null,target:null,tableindex:null}}f=c.split(INTERMediator.separator);a="",e="",d="";if(f.length==3){a=f[0];e=f[1];d=f[2]}else{if(f.length==2){a=f[0];e=f[1]}else{e=c}}return{table:a,field:e,target:d,tableindex:"_im_index_"+a}},getCalcNodeInfoArray:function(c){var f,a,e,d;if(!c){return null}f=c.split(INTERMediator.separator);a="",e="",d="";if(f.length==3){a=f[0];e=f[1];d=f[2]}else{if(f.length==2){e=f[0];d=f[1]}else{e=c}}return{table:a,field:e,target:d,tableindex:"_im_index_"+a}},getClassAttributeFromNode:function(a){var c="";if(a===null){return""}if(INTERMediator.isIE&&INTERMediator.ieVersion<8){c=a.getAttribute("className")}else{c=a.getAttribute("class")}return c},setClassAttributeToNode:function(c,a){if(c===null){return}if(INTERMediator.isIE&&INTERMediator.ieVersion<8){c.setAttribute("className",a)}else{c.setAttribute("class",a)}},eventInfos:[],addEvent:function(d,a,c){if(d.addEventListener){d.addEventListener(a,c,false);this.eventInfos.push({node:d,event:a,"function":c});return this.eventInfos.length-1}else{if(d.attachEvent){d.attachEvent("on"+a,c);this.eventInfos.push({node:d,event:a,"function":c});return this.eventInfos.length-1}}return -1},removeEvent:function(a){if(eventInfos[a].node.removeEventListener){eventInfos[a].node.removeEventListener(eventInfos[a].evt,eventInfos[a].func,false)}else{if(eventInfos[a].node.detachEvent){eventInfos[a].node.detachEvent("on"+eventInfos[a].evt,eventInfos[a].func)}}},toNumber:function(e){var d="",a,f;e=(new String(e)).toString();for(a=0;a<e.length;a++){f=e.charAt(a);if((f>="0"&&f<="9")||f=="."||f=="-"||f==this.cachedDigitSeparator[0]){d+=f}}return parseFloat(d)},RoundHalfToEven:function(a,c){return a},Round:function(c,d){var a=Math.pow(10,d);return Math.round(c*a)/a},numberFormat:function(h,m){var p,d,e,a,o,k,g,l,c,f;d=this.toNumber(h);e="";if(d<0){e="-";d=-d}o=(m===undefined)?0:this.toNumber(m);a=Math.pow(10,o);l=Math.round(d*a);c=(o>0)?l%a:0;f=(l-c)/a;k=(o>0)?new String(c):"";while(k.length<o){k="0"+k}d=f;p=[];for(d=Math.floor(d);d>0;d=Math.floor(d/1000)){if(d>=1000){g="000"+(d%1000).toString();p.push(g.substr(g.length-3))}else{p.push(d)}}return e+p.reverse().join(this.cachedDigitSeparator[1])+(k==""?"":this.cachedDigitSeparator[0]+k)},objectToString:function(d){var e,c,a;if(d===null){return"null"}if(typeof d=="object"){e="";if(d.constractor===Array){for(c=0;c<d.length;c++){e+=INTERMediatorLib.objectToString(d[c])+", "}return"["+e+"]"}else{for(a in d){e+="'"+a+"':"+INTERMediatorLib.objectToString(d[a])+", "}return"{"+e+"}"}}else{return"'"+d+"'"}},getTargetTableForRetrieve:function(a){if(a.view!=null){return a.view}return a.name},getTargetTableForUpdate:function(a){if(a.table!=null){return a.table}return a.name},getInsertedString:function(c,a){var e,d;e=c;if(a!=null){for(d=1;d<=a.length;d++){e=e.replace("@"+d+"@",a[d-1])}}return e},getInsertedStringFromErrorNumber:function(c,a){var e,d;e=INTERMediatorOnPage.getMessages()[c];if(a!=null){for(d=1;d<=a.length;d++){e=e.replace("@"+d+"@",a[d-1])}}return e},getNamedObject:function(e,d,a){var c;for(c in e){if(e[c][d]==a){return e[c]}}return null},getNamedObjectInObjectArray:function(c,e,a){var d;for(d=0;d<c.length;d++){if(c[d][e]==a){return c[d]}}return null},getNamedValueInObject:function(d,f,c,g){var a=[],e;for(e in d){if(d[e][f]==c){a.push(d[e][g])}}if(a.length===0){return null}else{if(a.length===1){return a[0]}else{return a}}},is_array:function(a){return a&&typeof a==="object"&&typeof a.length==="number"&&typeof a.splice==="function"&&!(a.propertyIsEnumerable("length"))},getNamedValuesInObject:function(d,h,f,g,c,k){var a=[],e;for(e in d){if(d[e][h]==f&&d[e][g]==c){a.push(d[e][k])}}if(a.length===0){return null}else{if(a.length===1){return a[0]}else{return a}}},getRecordsetFromFieldValueObject:function(c){var d={},a;for(a in c){d[c[a]["field"]]=c[a]["value"]}return d},getNodePath:function(a){var c="";if(a.tagName===null){return""}else{return INTERMediatorLib.getNodePath(a.parentNode)+"/"+a.tagName}},isPopupMenu:function(a){if(!a||!a.tagName){return false}if(a.tagName=="SELECT"){return true}return false},getElementsByClassNameOrDataAttr:function(f,a){var d=[];var g=(a.length>5)?a.substr(4):null;var e=new RegExp(a);c(f);return d;function c(m){var l,h;if(m.nodeType!=1){return}l=INTERMediatorLib.getClassAttributeFromNode(m);h=m.getAttribute("data-im-control");if((l&&l.match(e))||(h&&g&&h==g)){d.push(m)}for(var k=0;k<m.children.length;k++){c(m.children[k])}}},getElementsByClassName:function(f,a){var d=[];var e=new RegExp(a);c(f);return d;function c(k){var h,g;if(k.nodeType!=1){return}h=INTERMediatorLib.getClassAttributeFromNode(k);if(h&&h.match(e)){d.push(k)}for(var g=0;g<k.children.length;g++){c(k.children[g])}}},getElementsByIMManaged:function(e){var c=[];var d=new RegExp(/^IM/);a(e);return c;function a(g){var h,f;if(g.nodeType!=1){return}h=g.getAttribute("id");if(h&&h.match(d)){c.push(g)}for(var f=0;f<g.children.length;f++){a(g.children[f])}}},seekLinkedAndWidgetNodes:function(d,a){var h=[];var g=[];var f,e=a;if(a===undefined||a===null){e=false}for(f=0;f<d.length;f++){c(d[f])}return{linkedNode:h,widgetNode:g};function c(o){var k,p,n,l,m;k=o.nodeType;if(k===1){if(INTERMediatorLib.isLinkedElement(o)){p=e?INTERMediatorLib.getEnclosure(o):null;if(p===null){h.push(o)}else{return p}}if(INTERMediatorLib.isWidgetElement(o)){p=e?INTERMediatorLib.getEnclosure(o):null;if(p===null){g.push(o)}else{return p}}n=o.childNodes;for(m=0;m<n.length;m++){l=c(n[m])}}return null}},createErrorMessageNode:function(a,d){var c;c=document.createElement(a);INTERMediatorLib.setClassAttributeToNode(c,"_im_alertmessage");c.appendChild(document.createTextNode(d));return c},clearErrorMessage:function(c){var d,a;d=INTERMediatorLib.getElementsByClassName(c.parentNode,"_im_alertmessage");for(a=0;a<d.length;a++){d[a].parentNode.removeChild(d[a])}}};INTERMediatorLib.initialize();var IMLibNodeGraph={nodes:[],edges:[],clear:function(){this.nodes=[];this.edges=[]},addNode:function(a){if(this.nodes.indexOf(a)<0){this.nodes.push(a)}},addEdge:function(c,a){if(this.nodes.indexOf(c)<0){this.addNode(c)}if(this.nodes.indexOf(a)<0){this.addNode(a)}this.edges.push({from:c,to:a})},getAllNodesInEdge:function(){var c,a=[];for(c=0;c<this.edges.length;c++){if(a.indexOf(this.edges[c].from)<0){a.push(this.edges[c].from)}if(a.indexOf(this.edges[c].to)<0){a.push(this.edges[c].to)}}return a},getLeafNodes:function(){var a,d=[],e=[],c=this.getAllNodesInEdge();for(a=0;a<this.edges.length;a++){d.push(this.edges[a].from)}for(a=0;a<this.edges.length;a++){if(d.indexOf(this.edges[a].to)<0&&e.indexOf(this.edges[a].to)<0){e.push(this.edges[a].to)}}for(a=0;a<this.nodes.length;a++){if(c.indexOf(this.nodes[a])<0){e.push(this.nodes[a])}}return e},getLeafNodesWithRemoving:function(){var c,a=[],d=this.getLeafNodes();for(c=0;c<this.edges.length;c++){if(d.indexOf(this.edges[c].to)<0){a.push(this.edges[c])}}this.edges=a;for(c=0;c<d.length;c++){this.nodes.splice(this.nodes.indexOf(d[c]),1)}return d},applyToAllNodes:function(c){var a;for(a=0;a<this.nodes.length;a++){c(this.nodes[a])}}};var IMLibCalc={calculateRequiredObject:null,updateCalculationInfo:function(f,m,u,e){var d,k,a,n,r,g,v,o,t,c,l,h,p,q;d=f.calculation;a=null;k=null;for(g in d){p=d[g]["field"].indexOf("@");q=d[g]["field"].length;h=d[g]["field"].substring(0,p>=0?p:q);if(h==u.field){try{k=d[g]["expression"];a=d[g]["field"];n=Parser.parse(k).variables();o=INTERMediatorLib.getCalcNodeInfoArray(a);v=m+(o.target.length>0?(INTERMediator.separator+o.target):"")}catch(s){INTERMediator.setErrorMessage(s,INTERMediatorLib.getInsertedString(INTERMediatorOnPage.getMessages()[1036],[a,k]))}if(n){c={};l={};for(r=0;r<n.length;r++){t=n[r];if(t){c[t]=[e[t]];l[t]=[undefined]}}IMLibCalc.calculateRequiredObject[v]={field:a,expression:k,nodeInfo:u,values:c,referes:l}}}}},updateCalculationFields:function(){var l,f,s,g,m,p,c,u,o;var d,e,a,t,k,n,r,h,q;IMLibCalc.setUndefinedToAllValues();IMLibNodeGraph.clear();for(l in IMLibCalc.calculateRequiredObject){p=IMLibCalc.calculateRequiredObject[l];if(p){o=INTERMediatorLib.getCalcNodeInfoArray(l);d=document.getElementById(o.field);q=false;for(a in p.referes){for(c=0;c<p.referes[a].length;c++){IMLibNodeGraph.addEdge(l,p.referes[a][c]);q=false}}if(!q){IMLibNodeGraph.addEdge(l)}}}do{m=IMLibNodeGraph.getLeafNodesWithRemoving();for(r=0;r<m.length;r++){p=IMLibCalc.calculateRequiredObject[m[r]];o=INTERMediatorLib.getCalcNodeInfoArray(m[r]);if(p){d=document.getElementById(o.field);f=p.expression;s=p.nodeInfo;g=p.values;u=p.referes;for(a in g){t=[];for(c=0;c<g[a].length;c++){if(g[a][c]==undefined){k=document.getElementById(u[a][c]);t.push(IMLibElement.getValueFromIMNode(k))}else{t.push(g[a][c])}}p.values[a]=t}IMLibElement.setValueToIMNode(d,o.target.length>0?o.target:p.nodeInfo.target,Parser.evaluate(f,g),true)}else{}}}while(m.length>0);if(IMLibNodeGraph.nodes.length>0){INTERMediator.setErrorMessage(new Exception(),INTERMediatorLib.getInsertedString(INTERMediatorOnPage.getMessages()[1037],[]))}},recalculation:function(r){var m,f,o,q,d,p,s,u=false;var e,n,a,t,g,v,c,k,w,h;var y,x,l;if(r===undefined){u=true;g=[];v=[]}else{n=IMLibElement.getValueFromIMNode(document.getElementById(r));g=[r];v=[n]}IMLibCalc.setUndefinedToAllValues();IMLibNodeGraph.clear();for(m in IMLibCalc.calculateRequiredObject){q=IMLibCalc.calculateRequiredObject[m];p=INTERMediatorLib.getCalcNodeInfoArray(m);e=document.getElementById(p.field);for(a in q.referes){for(d=0;d<q.referes[a].length;d++){IMLibNodeGraph.addEdge(m,q.referes[a][d])}}}do{o=IMLibNodeGraph.getLeafNodesWithRemoving();for(t=0;t<o.length;t++){q=IMLibCalc.calculateRequiredObject[o[t]];p=INTERMediatorLib.getCalcNodeInfoArray(o[t]);if(q){e=document.getElementById(p.field);k=q.expression;w=q.nodeInfo;h=q.values;y=q.referes;for(a in h){x=[];for(d=0;d<h[a].length;d++){if(h[a][d]==undefined){l=document.getElementById(y[a][d]);x.push(IMLibElement.getValueFromIMNode(l))}else{x.push(h[a][d])}}q.values[a]=x}if(u){f=true}else{f=false;for(a in q.referes){for(d=0;d<q.referes[a].length;d++){c=g.indexOf(q.referes[a][d]);if(c>=0){q.values[a][d]=v[c];f=true}}}}if(f){s=Parser.evaluate(q.expression,q.values);IMLibElement.setValueToIMNode(document.getElementById(p.field),p.target,s,true);g.push(p.field);v.push(s)}}else{}}}while(o.length>0);if(IMLibNodeGraph.nodes.length>0){}},setUndefinedToAllValues:function(){var k,d,c,e,h,g,f,a;for(k in IMLibCalc.calculateRequiredObject){d=IMLibCalc.calculateRequiredObject[k];e=INTERMediatorLib.getCalcNodeInfoArray(k);h=document.getElementById(e.field);for(g in d.values){if(g.indexOf(INTERMediator.separator)>-1){f=g}else{f=d.nodeInfo.table+INTERMediator.separator+g}do{a=INTERMediatorOnPage.getNodeIdsHavingTargetFromRepeater(h,f);if(a&&a.length>0){break}a=INTERMediatorOnPage.getNodeIdsHavingTargetFromEnclosure(h,f);if(a&&a.length>0){break}h=INTERMediatorLib.getParentRepeater(INTERMediatorLib.getParentEnclosure(h))}while(h);if(INTERMediatorLib.is_array(a)){d.referes[g]=[];d.values[g]=[];for(c=0;c<a.length;c++){d.referes[g].push(a[c]);d.values[g].push(undefined)}}}}}};var INTERMediatorOnPage;INTERMediatorOnPage={authCountLimit:4,authCount:0,authUser:"",authHashedPassword:"",authUserSalt:"",authUserHexSalt:"",authChallenge:"",requireAuthentication:false,clientId:null,authRequiredContext:null,authStoring:"cookie",authExpired:3600,isOnceAtStarting:true,publickey:null,isNativeAuth:false,httpuser:null,httppasswd:null,mediaToken:null,realm:"",dbCache:{},isEmailAsUsername:false,isShowChangePassword:true,isSetDefaultStyle:true,authPanelTitle:null,additionalExpandingEnclosureFinish:{},additionalExpandingRecordFinish:{},getMessages:function(){return null},getURLParametersAsArray:function(){var d,g,f,a,c,e;a={};g=location.search.substring(1).split("&");for(d=0;d<g.length;d++){f=g[d].indexOf("=");if(f>0){c=g[d].substring(0,f);e=g[d].substring(f+1);a[c]=decodeURIComponent(e)}}return a},getContextInfo:function(d){var e,c,a;e=INTERMediatorOnPage.getDataSources();for(a in e){if(e[a].name==d){return e[a]}}return null},isComplementAuthData:function(){if(this.authUser!=null&&this.authUser.length>0&&this.authHashedPassword!=null&&this.authHashedPassword.length>0&&this.authUserSalt!=null&&this.authUserSalt.length>0&&this.authChallenge!=null&&this.authChallenge.length>0){return true}return false},retrieveAuthInfo:function(){if(this.requireAuthentication){if(this.isOnceAtStarting){switch(this.authStoring){case"cookie":case"cookie-domainwide":this.authUser=this.getCookie("_im_username");this.authHashedPassword=this.getCookie("_im_credential");this.mediaToken=this.getCookie("_im_mediatoken");break;default:this.removeCookie("_im_username");this.removeCookie("_im_credential");this.removeCookie("_im_mediatoken");break}this.isOnceAtStarting=false}if(this.authUser.length>0){if(!INTERMediator_DBAdapter.getChallenge()){INTERMediator.flushMessage()}}}},logout:function(){this.authUser="";this.authHashedPassword="";this.authUserSalt="";this.authChallenge="";this.clientId="";this.removeCookie("_im_username");this.removeCookie("_im_credential");this.removeCookie("_im_mediatoken");if(INTERMediator.useSessionStorage===true&&typeof sessionStorage!=="undefined"&&sessionStorage!==null){try{sessionStorage.removeItem("_im_localcontext")}catch(a){this.removeCookie("_im_localcontext")}}else{this.removeCookie("_im_localcontext")}},storeCredencialsToCookie:function(){switch(INTERMediatorOnPage.authStoring){case"cookie":if(INTERMediatorOnPage.authUser){INTERMediatorOnPage.setCookie("_im_username",INTERMediatorOnPage.authUser)}if(INTERMediatorOnPage.authHashedPassword){INTERMediatorOnPage.setCookie("_im_credential",INTERMediatorOnPage.authHashedPassword)}if(INTERMediatorOnPage.mediaToken){INTERMediatorOnPage.setCookie("_im_mediatoken",INTERMediatorOnPage.mediaToken)}break;case"cookie-domainwide":if(INTERMediatorOnPage.authUser){INTERMediatorOnPage.setCookieDomainWide("_im_username",INTERMediatorOnPage.authUser)}if(INTERMediatorOnPage.authHashedPassword){INTERMediatorOnPage.setCookieDomainWide("_im_credential",INTERMediatorOnPage.authHashedPassword)}if(INTERMediatorOnPage.mediaToken){INTERMediatorOnPage.setCookieDomainWide("_im_mediatoken",INTERMediatorOnPage.mediaToken)}break}},defaultBackgroundImage:"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAAXNSR0IArs4c6QAAACF0RVh0U29mdHdhcmUAR3JhcGhpY0NvbnZlcnRlciAoSW50ZWwpd4f6GQAAAHRJREFUeJzs0bENAEAMAjHWzBC/f5sxkPIurkcmSV65KQcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAL4AaA9oHwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOA6wAAAA//8DAF3pMFsPzhYWAAAAAElFTkSuQmCC)",defaultBackgroundColor:null,loginPanelHTML:null,authenticating:function(h){var c,k,r,y,l,g,v,f,m,w,n,a,s,e,p,q,d,u,t,x,o;if(this.authCount>this.authCountLimit){this.authenticationError();this.logout();INTERMediator.flushMessage();return}c=document.getElementsByTagName("BODY")[0];k=document.createElement("div");c.insertBefore(k,c.childNodes[0]);k.style.height="100%";k.style.width="100%";if(INTERMediatorOnPage.defaultBackgroundImage){k.style.backgroundImage=INTERMediatorOnPage.defaultBackgroundImage}if(INTERMediatorOnPage.defaultBackgroundColor){k.style.backgroundColor=INTERMediatorOnPage.defaultBackgroundColor}k.style.position="absolute";k.style.padding=" 50px 0 0 0";k.style.top="0";k.style.left="0";k.style.zIndex="999998";if(INTERMediatorOnPage.loginPanelHTML){k.innerHTML=INTERMediatorOnPage.loginPanelHTML;n=document.getElementById("_im_password");v=document.getElementById("_im_username");e=document.getElementById("_im_authbutton");s=document.getElementById("_im_changebutton")}else{r=document.createElement("div");if(INTERMediatorOnPage.isSetDefaultStyle){r.style.width="450px";r.style.backgroundColor="#333333";r.style.color="#DDDDAA";r.style.margin="50px auto 0 auto";r.style.padding="20px";r.style.borderRadius="10px";r.style.position="relative"}r.id="_im_authpanel";k.appendChild(r);p="";if(INTERMediatorOnPage.authPanelTitle&&INTERMediatorOnPage.authPanelTitle.length>0){p=INTERMediatorOnPage.authPanelTitle}else{if(INTERMediatorOnPage.realm&&INTERMediatorOnPage.realm.length>0){p=INTERMediatorOnPage.realm}}if(p&&p.length>0){x=document.createElement("DIV");x.appendChild(document.createTextNode(p));x.style.textAlign="left";r.appendChild(x);a=document.createElement("HR");r.appendChild(a)}y="200px";l=document.createElement("LABEL");r.appendChild(l);g=document.createElement("span");if(INTERMediatorOnPage.isSetDefaultStyle){g.style.width=y;g.style.textAlign="right";g.style.cssFloat="left"}INTERMediatorLib.setClassAttributeToNode(g,"_im_authlabel");l.appendChild(g);f=INTERMediatorOnPage.isEmailAsUsername?2011:2002;g.appendChild(document.createTextNode(INTERMediatorLib.getInsertedStringFromErrorNumber(f)));v=document.createElement("INPUT");v.type="text";v.id="_im_username";v.size="24";v.setAttribute("autocapitalize","off");l.appendChild(v);a=document.createElement("BR");a.clear="all";r.appendChild(a);m=document.createElement("LABEL");r.appendChild(m);w=document.createElement("SPAN");if(INTERMediatorOnPage.isSetDefaultStyle){w.style.minWidth=y;w.style.textAlign="right";w.style.cssFloat="left"}INTERMediatorLib.setClassAttributeToNode(w,"_im_authlabel");m.appendChild(w);w.appendChild(document.createTextNode(INTERMediatorLib.getInsertedStringFromErrorNumber(2003)));n=document.createElement("INPUT");n.type="password";n.id="_im_password";n.size="24";m.appendChild(n);e=document.createElement("BUTTON");e.appendChild(document.createTextNode(INTERMediatorLib.getInsertedStringFromErrorNumber(2004)));r.appendChild(e);a=document.createElement("BR");a.clear="all";r.appendChild(a);if(this.isShowChangePassword&&!INTERMediatorOnPage.isNativeAuth){a=document.createElement("HR");r.appendChild(a);q=document.createElement("LABEL");r.appendChild(q);d=document.createElement("SPAN");if(INTERMediatorOnPage.isSetDefaultStyle){d.style.minWidth=y;d.style.textAlign="right";d.style.cssFloat="left";d.style.fontSize="0.7em";d.style.paddingTop="4px"}INTERMediatorLib.setClassAttributeToNode(d,"_im_authlabel");q.appendChild(d);d.appendChild(document.createTextNode(INTERMediatorLib.getInsertedStringFromErrorNumber(2006)));u=document.createElement("INPUT");u.type="password";u.id="_im_newpassword";u.size="12";q.appendChild(u);s=document.createElement("BUTTON");s.appendChild(document.createTextNode(INTERMediatorLib.getInsertedStringFromErrorNumber(2005)));r.appendChild(s);t=document.createElement("DIV");t.style.textAlign="center";t.style.textSize="10pt";t.style.color="#994433";r.appendChild(t)}}n.onkeydown=function(z){o=(window.event)?window.event.which:z.keyCode;if(o==13){e.onclick()}};v.value=INTERMediatorOnPage.authUser;v.onkeydown=function(z){o=(window.event)?window.event.which:z.keyCode;if(o==13){n.focus()}};e.onclick=function(){var B,z,A;B=document.getElementById("_im_username").value;z=document.getElementById("_im_password").value;INTERMediatorOnPage.authUser=B;c.removeChild(k);if(B!=""&&(INTERMediatorOnPage.authChallenge===null||INTERMediatorOnPage.authChallenge.length<24)){INTERMediatorOnPage.authHashedPassword="need-hash-pls";A=INTERMediator_DBAdapter.getChallenge();if(!A){INTERMediator.flushMessage();return}}if(INTERMediatorOnPage.isNativeAuth){INTERMediatorOnPage.authHashedPassword=INTERMediatorOnPage.publickey.biEncryptedString(z)}else{INTERMediatorOnPage.authHashedPassword=SHA1(z+INTERMediatorOnPage.authUserSalt)+INTERMediatorOnPage.authUserHexSalt}if(INTERMediatorOnPage.authUser.length>0){INTERMediatorOnPage.storeCredencialsToCookie()}h();INTERMediator.flushMessage()};if(s){s.onclick=function(){var F,A,B,C,E,z;F=document.getElementById("_im_username").value;A=document.getElementById("_im_password").value;B=document.getElementById("_im_newpassword").value;if(F===""||A===""||B===""){t.appendChild(document.createTextNode(INTERMediatorLib.getInsertedStringFromErrorNumber(2007)));return}INTERMediatorOnPage.authUser=F;if(F!=""&&(INTERMediatorOnPage.authChallenge===null||INTERMediatorOnPage.authChallenge.length<24)){INTERMediatorOnPage.authHashedPassword="need-hash-pls";C=INTERMediator_DBAdapter.getChallenge();if(!C){newPasswordMessageappendChild(document.createTextNode(INTERMediatorLib.getInsertedStringFromErrorNumber(2008)));INTERMediator.flushMessage();return}}INTERMediatorOnPage.authHashedPassword=SHA1(A+INTERMediatorOnPage.authUserSalt)+INTERMediatorOnPage.authUserHexSalt;E="access=changepassword&newpass="+INTERMediatorLib.generatePasswordHash(B);try{z=INTERMediator_DBAdapter.server_access(E,1029,1030)}catch(D){z={newPasswordResult:false}}t.appendChild(document.createTextNode(INTERMediatorLib.getInsertedStringFromErrorNumber(z.newPasswordResult===true?2009:2010)));INTERMediator.flushMessage()}}window.scroll(0,0);v.focus();INTERMediatorOnPage.authCount++},authenticationError:function(){var d,c,a;INTERMediatorOnPage.hideProgress();d=document.getElementsByTagName("BODY")[0];c=document.createElement("div");d.insertBefore(c,d.childNodes[0]);c.style.height="100%";c.style.width="100%";c.style.backgroundImage="url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAAXNSR0IArs4c6QAAACF0RVh0U29mdHdhcmUAR3JhcGhpY0NvbnZlcnRlciAoSW50ZWwpd4f6GQAAAHlJREFUeJzs0UENACAQA8EzdAl2EIEg3CKjyTGP/TfTur1OuJ2sAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAJwDRAekDAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADzAR4AAAD//wMAkUKRPI/rh/AAAAAASUVORK5CYII=)";c.style.position="absolute";c.style.padding=" 50px 0 0 0";c.style.top="0";c.style.left="0";c.style.zIndex="999999";a=document.createElement("div");a.style.width="240px";a.style.backgroundColor="#333333";a.style.color="#DD6666";a.style.fontSize="16pt";a.style.margin="50px auto 0 auto";a.style.padding="20px 4px 20px 4px";a.style.borderRadius="10px";a.style.position="relatvie";a.style.textAlign="Center";a.onclick=function(){d.removeChild(c)};c.appendChild(a);a.appendChild(document.createTextNode(INTERMediatorLib.getInsertedStringFromErrorNumber(2001)))},INTERMediatorCheckBrowser:function(l){var e,n,k,p,c,d,q,r,g,s,m,a,o,t,h,f;e=INTERMediatorOnPage.browserCompatibility();n=false;k=false;p;for(c in e){if(navigator.userAgent.toUpperCase().indexOf(c.toUpperCase())>-1){n=true;if(e[c] instanceof Object){for(d in e[c]){if(navigator.platform.toUpperCase().indexOf(d.toUpperCase())>-1){k=true;p=e[c][d];break}}}else{k=true;p=e[c];break}}}q=false;if(n&&k){r=parseInt(p);if(navigator.appVersion.indexOf("MSIE")>-1){s=navigator.appVersion.indexOf("MSIE");m=navigator.appVersion.indexOf(".",s);g=parseInt(navigator.appVersion.substring(s+4,m))}else{m=navigator.appVersion.indexOf(".");g=parseInt(navigator.appVersion.substring(0,m))}if(p.indexOf("-")>-1){q=(r>=g)}else{if(p.indexOf("+")>-1){q=(r<=g)}else{q=(r==g)}}if(document.documentMode){q=(r<=document.documentMode)}}if(q){if(l!=null){l.parentNode.removeChild(l)}}else{a=document.getElementsByTagName("BODY")[0];o=document.createElement("div");o.setAttribute("align","center");t=document.createElement("font");t.setAttribute("color","gray");h=document.createElement("font");h.setAttribute("size","+2");h.appendChild(document.createTextNode(INTERMediatorOnPage.getMessages()[1022]));t.appendChild(h);t.appendChild(document.createElement("br"));t.appendChild(document.createTextNode(INTERMediatorOnPage.getMessages()[1023]));t.appendChild(document.createElement("br"));t.appendChild(document.createTextNode(navigator.userAgent));o.appendChild(t);for(f=a.childNodes.length-1;f>=0;f--){a.removeChild(a.childNodes[f])}a.appendChild(o)}return q},getNodeIdFromIMDefinition:function(d,f,a){var c;if(a){c=f}else{c=INTERMediatorLib.getParentRepeater(f)}return e(c,d);function e(m,g){var k,h,n,l;if(m.nodeType!=1){return null}k=m.childNodes;if(k){for(h=0;h<k.length;h++){if(k[h].nodeType==1){if(INTERMediatorLib.isLinkedElement(k[h])){n=INTERMediatorLib.getLinkedElementInfo(k[h]);if(n.indexOf(g)>-1){l=k[h].getAttribute("id");return l}}l=e(k[h],g);if(l!==null){return l}}}}return null}},getNodeIdFromIMDefinitionOnEnclosure:function(c,e){var a;a=INTERMediatorLib.getParentEnclosure(e);return d(a,c);function d(l,f){var h,g,m,k;if(l.nodeType!=1){return null}h=l.childNodes;if(h){for(g=0;g<h.length;g++){if(h[g].nodeType==1){if(INTERMediatorLib.isLinkedElement(h[g])){m=INTERMediatorLib.getLinkedElementInfo(h[g]);if(m.indexOf(f)>-1&&h[g].getAttribute){k=h[g].getAttribute("id");return k}}k=d(h[g],f);if(k!==null){return k}}}}return null}},getNodeIdsFromIMDefinition:function(d,h,a){var c,e,g;if(a===true){c=h}else{if(a===false){c=INTERMediatorLib.getParentEnclosure(h)}else{c=INTERMediatorLib.getParentRepeater(h)}}if(c!=null){e=[];f(c,d)}return e;function f(n,k){var m,l,o;if(n.nodeType!=1){return}m=n.childNodes;if(m){for(l=0;l<m.length;l++){if(m[l].nodeType==1){o=INTERMediatorLib.getLinkedElementInfo(m[l]);if(o&&o.indexOf(k)>-1){e.push(m[l].getAttribute("id"))}}f(m[l],k)}}}},getNodeIdsHavingTargetFromNode:function(c,a){return INTERMediatorOnPage.getNodeIdsFromIMDefinition(a,c,true)},getNodeIdsHavingTargetFromRepeater:function(c,a){return INTERMediatorOnPage.getNodeIdsFromIMDefinition(a,c,"")},getNodeIdsHavingTargetFromEnclosure:function(c,a){return INTERMediatorOnPage.getNodeIdsFromIMDefinition(a,c,false)},getKeyWithRealm:function(a){if(INTERMediatorOnPage.realm.length>0){return a+"_"+INTERMediatorOnPage.realm}return a},getCookie:function(d){var e,c,a;e=document.cookie.split("; ");a=this.getKeyWithRealm(d);for(c=0;c<e.length;c++){if(e[c].indexOf(a+"=")==0){return decodeURIComponent(e[c].substring(e[c].indexOf("=")+1))}}return""},removeCookie:function(a){document.cookie=this.getKeyWithRealm(a)+"=; path=/; max-age=0; expires=Thu, 1-Jan-1900 00:00:00 GMT;";document.cookie=this.getKeyWithRealm(a)+"=; max-age=0;  expires=Thu, 1-Jan-1900 00:00:00 GMT;"},setCookie:function(a,c){this.setCookieWorker(this.getKeyWithRealm(a),c,false,INTERMediatorOnPage.authExpired)},setCookieDomainWide:function(a,c){this.setCookieWorker(this.getKeyWithRealm(a),c,true,INTERMediatorOnPage.authExpired)},setCookieWorker:function(c,h,a,e){var f;var g=new Date();g.setTime(g.getTime()+e*1000);f=c+"="+encodeURIComponent(h)+(a?";path=/":"")+";";if(e>0){f+="max-age="+e+";expires="+g.toGMTString()+";"}if(document.URL.substring(0,8)=="https://"){f+="secure;"}document.cookie=f},hideProgress:function(){var a;a=document.getElementById("_im_progress");if(a){a.parentNode.removeChild(a)}},showProgress:function(){var e,c,a,d;c=document.getElementById("_im_progress");if(!c){e=document.getElementsByTagName("BODY")[0];c=document.createElement("div");c.setAttribute("id","_im_progress");c.style.backgroundColor="#000000";c.style.textAlign="center";c.style.width="130px";c.style.height="55px";c.style.left="0";c.style.top="0";c.style.color="#DDDDAA";c.style.fontSize="6px";c.style.position="absolute";c.style.padding="6px";c.style.borderRadius="0 0 10px 0";c.style.borderRight=c.style.borderBottom="solid 4px #779933";c.style.zIndex="999999";if(e.firstChild){e.insertBefore(c,e.firstChild)}else{e.appendChild(c)}d=document.createElement("img");d.setAttribute("src","data:image/gif;base64,R0lGODlhKAAoAOYAAAIGBAQIBgYKCAoODAwQDg4SEBEVExQYFhodGx0gHiIlIyQoJiYqKCotKy4yMDI1NDQ4Njo9Oz5BPz5BQEFEQ0VIRkdJSEtOTE5QT09SUFNVVFVYVldaWFpcWl1gXl9hYGFkYmZoZ2psa29xcHJ0c3Z4dnp8e36Afn+BgIKEg4aJtYeJh4mMt4uMi46Qjo6RuZCTupKTkpaYlpqcv5ucmp2fwJ+gn6GioaGjwaqsxqusqq+wr7Cxr7S0s7O1yre4tru8u7u8zr/AvsPEwsfIxsfI1MjJx8vMy8zN18/QztDQz9PU2tTU09fY19jY19zc297f4ODg3+Pj4ujn5ejo5+vr6fHw7/T08wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAQAAAAAIf8LSUNDUkdCRzEwMTL/AAAHqGFwcGwCIAAAbW50clJHQiBYWVogB9kAAgAZAAsAGgALYWNzcEFQUEwAAAAAYXBwbAAAAAAAAAAAAAAAAAAAAAAAAPbWAAEAAAAA0y1hcHBsAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALZGVzYwAAAQgAAABvZHNjbQAAAXgAAAVsY3BydAAABuQAAAA4d3RwdAAABxwAAAAUclhZWgAABzAAAAAUZ1hZWgAAB0QAAAAUYlhZWgAAB1gAAAAUclRSQwAAB2wAAAAOY2hhZAAAB3wAAAAsYlRSQwAAB2wAAAAOZ1RS/0MAAAdsAAAADmRlc2MAAAAAAAAAFEdlbmVyaWMgUkdCIFByb2ZpbGUAAAAAAAAAAAAAABRHZW5lcmljIFJHQiBQcm9maWxlAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABtbHVjAAAAAAAAAB4AAAAMc2tTSwAAACgAAAF4aHJIUgAAACgAAAGgY2FFUwAAACQAAAHIcHRCUgAAACYAAAHsdWtVQQAAACoAAAISZnJGVQAAACgAAAI8emhUVwAAABYAAAJkaXRJVAAAACgAAAJ6bmJOTwAAACYAAAKia29LUgAAABYAAP8CyGNzQ1oAAAAiAAAC3mhlSUwAAAAeAAADAGRlREUAAAAsAAADHmh1SFUAAAAoAAADSnN2U0UAAAAmAAAConpoQ04AAAAWAAADcmphSlAAAAAaAAADiHJvUk8AAAAkAAADomVsR1IAAAAiAAADxnB0UE8AAAAmAAAD6G5sTkwAAAAoAAAEDmVzRVMAAAAmAAAD6HRoVEgAAAAkAAAENnRyVFIAAAAiAAAEWmZpRkkAAAAoAAAEfHBsUEwAAAAsAAAEpHJ1UlUAAAAiAAAE0GFyRUcAAAAmAAAE8mVuVVMAAAAmAAAFGGRhREsAAAAuAAAFPgBWAWEAZQBvAGIAZQD/YwBuAP0AIABSAEcAQgAgAHAAcgBvAGYAaQBsAEcAZQBuAGUAcgBpAQ0AawBpACAAUgBHAEIAIABwAHIAbwBmAGkAbABQAGUAcgBmAGkAbAAgAFIARwBCACAAZwBlAG4A6AByAGkAYwBQAGUAcgBmAGkAbAAgAFIARwBCACAARwBlAG4A6QByAGkAYwBvBBcEMAQzBDAEOwRMBD0EOAQ5ACAEPwRABD4ERAQwBDkEOwAgAFIARwBCAFAAcgBvAGYAaQBsACAAZwDpAG4A6QByAGkAcQB1AGUAIABSAFYAQpAadSgAIABSAEcAQgAggnJfaWPPj/AAUAByAG8AZgBp/wBsAG8AIABSAEcAQgAgAGcAZQBuAGUAcgBpAGMAbwBHAGUAbgBlAHIAaQBzAGsAIABSAEcAQgAtAHAAcgBvAGYAaQBsx3y8GAAgAFIARwBCACDVBLhc0wzHfABPAGIAZQBjAG4A/QAgAFIARwBCACAAcAByAG8AZgBpAGwF5AXoBdUF5AXZBdwAIABSAEcAQgAgBdsF3AXcBdkAQQBsAGwAZwBlAG0AZQBpAG4AZQBzACAAUgBHAEIALQBQAHIAbwBmAGkAbADBAGwAdABhAGwA4QBuAG8AcwAgAFIARwBCACAAcAByAG8AZgBpAGxmbpAaACAAUgBHAEIAIGPPj//wZYdO9k4AgiwAIABSAEcAQgAgMNcw7TDVMKEwpDDrAFAAcgBvAGYAaQBsACAAUgBHAEIAIABnAGUAbgBlAHIAaQBjA5MDtQO9A7kDugPMACADwAPBA78DxgOvA7sAIABSAEcAQgBQAGUAcgBmAGkAbAAgAFIARwBCACAAZwBlAG4A6QByAGkAYwBvAEEAbABnAGUAbQBlAGUAbgAgAFIARwBCAC0AcAByAG8AZgBpAGUAbA5CDhsOIw5EDh8OJQ5MACAAUgBHAEIAIA4XDjEOSA4nDkQOGwBHAGUAbgBlAGwAIABSAEcAQgAgAFAAcgBvAGYAaQBsAGkAWQBsAGX/AGkAbgBlAG4AIABSAEcAQgAtAHAAcgBvAGYAaQBpAGwAaQBVAG4AaQB3AGUAcgBzAGEAbABuAHkAIABwAHIAbwBmAGkAbAAgAFIARwBCBB4EMQRJBDgEOQAgBD8EQAQ+BEQEOAQ7BEwAIABSAEcAQgZFBkQGQQAgBioGOQYxBkoGQQAgAFIARwBCACAGJwZEBjkGJwZFAEcAZQBuAGUAcgBpAGMAIABSAEcAQgAgAFAAcgBvAGYAaQBsAGUARwBlAG4AZQByAGUAbAAgAFIARwBCAC0AYgBlAHMAawByAGkAdgBlAGwAcwBldGV4dAAAAABDb3B5cmlnaHQgMjAwrzcgQXBwbGUgSW5jLiwgYWxsIHJpZ2h0cyByZXNlcnZlZC4AWFlaIAAAAAAAAPNSAAEAAAABFs9YWVogAAAAAAAAdE0AAD3uAAAD0FhZWiAAAAAAAABadQAArHMAABc0WFlaIAAAAAAAACgaAAAVnwAAuDZjdXJ2AAAAAAAAAAEBzQAAc2YzMgAAAAAAAQxCAAAF3v//8yYAAAeSAAD9kf//+6L///2jAAAD3AAAwGwALAAAAAAoACgAAAf/gFJSVYRVVIKIiYqLjIxGNjc3Nj+Nik9ElVGNVS0AAgIAGVWVglQ6F4eLnEOMnAADAwAbo6RVKQZHjRA0tImusAAcvZsdADHDUlNAAiLIg53AHc6WD6HItgARrS6vsdKkUkMGAgi5ihIA5aox3QDflVU2AQMBMsPiAwI31+zAHtOIqpB4BUBDL2yxSPBr9wEgogrzBiRgkojCvAAU1rUD4VAKEwWw6PEShA8WAiWKqvSLxbESFSAEQrobVWVFt3w6hqmMCKDlJm4hByigKMWiTBM6ZfD02QrEzXz7hhwIGsBCSqXAmD5ZFEFAUHdXoAUd6gsry1FFZsCogQTREQRB/2EpeGIhYlAeB832rIKEhQq/L5YM0hE3ZAq4cQGkyLu0So6/LPz6GJTiaUgEMQcQyBwAA+OsVXBA9ptj0IZXAiYgpmrhgdcBC5wE1MvRx2gVQaY8ceAVwAoKr0MGoPHhZo9UVWhXeTJDhXMcUMIZgCWgR+W4CZ5cj7WCVvLGUp4EyREkepUbEQ0QAVLgawcrhIEZFPQddKsS3RQ0kdI1pL4qb1HXwFaDxADeIlRccJE2VZhwU2yCuAZLAUAcshMwDTHyBAPRGMIeMCHQVAwwLtC0EgD/LKJMe7EgJUgEEe1A03YzFdjOO74YCMtwNJ3gyQMEVhFfPg5spdKNzlQhQv83BFQoiBAGAOCiIAHCYoAQNnbICIwmoYSIBAMIMUUi/cXCy5FaWlIBag9oQh8K2vhSHD0gGHniLBqSQEBB9+zjSycEpICcWHxuooMCI3Q0SA8I+ElfDAUccEABOKqSBCvgeDQEMk8YccSnRGUqaioIhsfEqU8c8cQTRKW6aquCaOIEqlIcQRGriAxBAhU36NACCT+0QIN2KeQkrHYxpHBEC6yS8AQQJpgAhAw2pDCEDCnIcAi0McSgxLVXmECDFCu00IMt4wqqAw0tSBFDCTFcoYMOQ7RwRb00uLCPkPR2wAQQ9pqgg3Y08JLCDVEInAITKUALBAlH6HADEyYoEUM2DzGwS+URALK6KRATswKEFEDYwMQPPGw1hBFMVKHEES9XMQQNxw3xhM2YtqKKFFSQCs+YiQQCADs=");d.style.marginRight="12px";c.appendChild(d);a=document.createElement("img");a.setAttribute("src","data:image/gif;base64,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");c.appendChild(a);c.appendChild(document.createElement("BR"));c.appendChild(document.createTextNode("INTER-Mediator working"))}}};var IMParts_Catalog={};IMParts_Catalog.fileupload={html5DDSuported:false,progressSupported:false,forceOldStyleForm:false,uploadId:"sign"+Math.random(),instanciate:function(g){var l,a,d;var e=g.getAttribute("id")+"-e";var n=document.createElement("DIV");INTERMediatorLib.setClassAttributeToNode(n,"_im_fileupload");n.setAttribute("id",e);this.ids.push(e);if(this.forceOldStyleForm){this.html5DDSuported=false}else{this.html5DDSuported=true;try{var m=new FileReader();var k=new FormData()}catch(h){this.html5DDSuported=false}}if(this.html5DDSuported){n.dropzone="copy";n.style.width="200px";n.style.height="100px";n.style.paddingTop="20px";n.style.backgroundColor="#AAAAAA";n.style.border="3px dotted #808080";n.style.textAlign="center";n.style.fontSize="75%";var c=INTERMediatorOnPage.getMessages()[3101].split(/\n/);for(var f=0;f<c.length;f++){if(f>0){n.appendChild(document.createElement("BR"))}n.appendChild(document.createTextNode(c[f]))}}else{a=document.createElement("FORM");a.setAttribute("method","post");a.setAttribute("action",INTERMediatorOnPage.getEntryPath()+"?access=uploadfile");a.setAttribute("enctype","multipart/form-data");n.appendChild(a);if(this.progressSupported){l=document.createElement("INPUT");l.setAttribute("type","hidden");l.setAttribute("name","APC_UPLOAD_PROGRESS");l.setAttribute("id","progress_key");l.setAttribute("value",this.uploadId+(this.ids.length-1));a.appendChild(l)}l=document.createElement("INPUT");l.setAttribute("type","hidden");l.setAttribute("name","_im_redirect");l.setAttribute("value",location.href);a.appendChild(l);l=document.createElement("INPUT");l.setAttribute("type","hidden");l.setAttribute("name","_im_contextnewrecord");l.setAttribute("value","uploadfile");a.appendChild(l);l=document.createElement("INPUT");l.setAttribute("type","hidden");l.setAttribute("name","access");l.setAttribute("value","uploadfile");a.appendChild(l);l=document.createElement("INPUT");l.setAttribute("type","file");l.setAttribute("accept","*/*");l.setAttribute("name","_im_uploadfile");a.appendChild(l);d=document.createElement("BUTTON");d.setAttribute("type","submit");d.appendChild(document.createTextNode(""));a.appendChild(d);this.formFromId[e]=a}g.appendChild(n);n._im_getValue=function(){var o=n;return o.value};g._im_getValue=function(){var o=n;return o.value};g._im_getComponentId=function(){var o=e;return o};g._im_setValue=function(p){var o=n;if(this.html5DDSuported){}else{}}},ids:[],formFromId:{},finish:function(){var e,a;if(this.html5DDSuported){for(var g=0;g<this.ids.length;g++){var f=this.ids[g];var l=document.getElementById(f);var h=IMLibContextPool.getContextInfoFromId(f);if(l){INTERMediatorLib.addEvent(l,"dragleave",function(q){q.preventDefault();q.target.style.backgroundColor="#AAAAAA"});INTERMediatorLib.addEvent(l,"dragover",function(q){q.preventDefault();q.target.style.backgroundColor="#AADDFF"});var m=this.progressSupported;var o=this.ids.length;var d=this.uploadId;INTERMediatorLib.addEvent(l,"drop",(function(){var u=g;var r=m;var q=o;var t=d;var s=f;return function(z){var y,A;z.preventDefault();var B=z.currentTarget;if(r){var x=document.createElement("iframe");x.setAttribute("id","upload_frame"+q);x.setAttribute("name","upload_frame");x.setAttribute("frameborder","0");x.setAttribute("border","0");x.setAttribute("scrolling","no");x.setAttribute("scrollbar","no");x.style.width="100%";x.style.height="24px";B.appendChild(x)}for(var w=0;w<z.dataTransfer.files.length;w++){y=z.dataTransfer.files[w];A=document.createElement("DIV");A.appendChild(document.createTextNode(INTERMediatorOnPage.getMessages()[3102]+y.name));A.style.marginTop="20px";A.style.backgroundColor="#FFFFFF";A.style.textAlign="center";z.target.appendChild(A)}var v=IMLibContextPool.getContextInfoFromId(B.getAttribute("id"),"");if(r){x.style.display="block";setTimeout(function(){x.setAttribute("src","upload_frame.php?up_id="+t+u)})}INTERMediator_DBAdapter.uploadFile("&_im_contextname="+encodeURIComponent(v.context.contextName)+"&_im_field="+encodeURIComponent(v.field)+"&_im_keyfield="+encodeURIComponent(v.record.split("=")[0])+"&_im_keyvalue="+encodeURIComponent(v.record.split("=")[1])+"&_im_contextnewrecord="+encodeURIComponent("uploadfile")+(r?("&APC_UPLOAD_PROGRESS="+encodeURIComponent(t+u)):""),{fileName:y.name,content:y},function(F){var K,H,I=null,C,G,D;D=IMLibContextPool.getContextDef(v.context.contextName);if(D["file-upload"]){var E="";for(var J in D["file-upload"]){if(D["file-upload"][J]["field"]==v.field){E=D["file-upload"][J]["context"];break}}C=IMLibContextPool.getKeyFieldValueFromId(s,"");I=IMLibContextPool.getContextsFromNameAndForeignValue(E,C,D.key)}else{I=IMLibContextPool.getContextFromName(v.context.contextName)}H=IMLibContextPool.getContextInfoFromId(s,"");H.context.setValue(H.record,H.field,F);if(I){for(G=0;G<I.length;G++){K=I[G];INTERMediator.construct(K)}}INTERMediator.flushMessage()})}})())}}}else{for(var g=0;g<this.ids.length;g++){var l=document.getElementById(this.ids[g]);if(l){var k=IMLibContextPool.getContextInfoFromId(this.ids[g],"");var c=l.getElementsByTagName("FORM")[0];var n=document.createElement("INPUT");n.setAttribute("type","hidden");n.setAttribute("name","_im_contextname");n.setAttribute("value",k.context.contextName);c.appendChild(n);n=document.createElement("INPUT");n.setAttribute("type","hidden");n.setAttribute("name","_im_field");n.setAttribute("value",k.field);c.appendChild(n);n=document.createElement("INPUT");n.setAttribute("type","hidden");n.setAttribute("name","_im_keyfield");n.setAttribute("value",k.record.split("=")[0]);c.appendChild(n);n=document.createElement("INPUT");n.setAttribute("type","hidden");n.setAttribute("name","_im_keyvalue");n.setAttribute("value",k.record.split("=")[1]);c.appendChild(n);n=document.createElement("INPUT");n.setAttribute("type","hidden");n.setAttribute("name","clientid");if(INTERMediatorOnPage.authUser.length>0){n.value=INTERMediatorOnPage.clientId}c.appendChild(n);n=document.createElement("INPUT");n.setAttribute("type","hidden");n.setAttribute("name","authuser");if(INTERMediatorOnPage.authUser.length>0){n.value=INTERMediatorOnPage.authUser}c.appendChild(n);n=document.createElement("INPUT");n.setAttribute("type","hidden");n.setAttribute("name","response");if(INTERMediatorOnPage.authUser.length>0){if(INTERMediatorOnPage.isNativeAuth){thisForm.elements.response.value=INTERMediatorOnPage.publickey.biEncryptedString(INTERMediatorOnPage.authHashedPassword+"\n"+INTERMediatorOnPage.authChallenge)}else{if(INTERMediatorOnPage.authHashedPassword&&INTERMediatorOnPage.authChallenge){e=new jsSHA(INTERMediatorOnPage.authHashedPassword,"ASCII");a=e.getHMAC(INTERMediatorOnPage.authChallenge,"ASCII","SHA-256","HEX");n.value=a}else{n.value="dummy"}}}c.appendChild(n);if(this.progressSupported){n=document.createElement("iframe");n.setAttribute("id","upload_frame"+g);n.setAttribute("name","upload_frame");n.setAttribute("frameborder","0");n.setAttribute("border","0");n.setAttribute("scrolling","no");n.setAttribute("scrollbar","no");c.appendChild(n);INTERMediatorLib.addEvent(c,"submit",(function(){var q=g;return function(s){var r=document.getElementById("upload_frame"+q);r.style.display="block";setTimeout(function(){var t=p()+"?uploadprocess="+this.uploadId+q;r.setAttribute("src",t)});return true}})())}}}}this.ids=[];this.formFromId={};function p(){var r=document.getElementsByTagName("SCRIPT");for(var s=0;s<r.length;s++){var q=r[s].getAttribute("src");if(q.match(/\.php/)){return q}}return null}}};IMLibPageNavigation={deleteInsertOnNavi:[],navigationSetup:function(){var d,k,e,l,f,a,o,m,g,h,q,p,c,r,n;d=document.getElementById("IM_NAVIGATOR");if(d!=null){e=d.childNodes;for(k=0;k<e.length;k++){d.removeChild(e[k])}d.innerHTML="";d.setAttribute("class","IM_NAV_panel");l=INTERMediator.navigationLabel;if(l===null||l[8]!==false){f=document.createElement("SPAN");d.appendChild(f);f.appendChild(document.createTextNode(((l===null||l[8]===null)?INTERMediatorOnPage.getMessages()[2]:l[8])));f.setAttribute("class","IM_NAV_button");INTERMediatorLib.addEvent(f,"click",function(){INTERMediator.initialize();IMLibLocalContext.archive();location.reload()})}if(l===null||l[4]!==false){a=Number(INTERMediator.startFrom);o=Number(INTERMediator.pagedSize);m=Number(INTERMediator.pagedAllCount);g=" IM_NAV_disabled";f=document.createElement("SPAN");d.appendChild(f);f.appendChild(document.createTextNode(((l===null||l[4]===null)?INTERMediatorOnPage.getMessages()[1]:l[4])+(a+1)+((Math.min(a+o,m)-a>1)?(((l===null||l[5]===null)?"-":l[5])+Math.min(a+o,m)):"")+((l===null||l[6]===null)?" / ":l[6])+(m)+((l===null||l[7]===null)?"":l[7])));f.setAttribute("class","IM_NAV_info")}if(l===null||l[0]!==false){f=document.createElement("SPAN");d.appendChild(f);f.appendChild(document.createTextNode((l===null||l[0]===null)?"<<":l[0]));f.setAttribute("class","IM_NAV_button"+(a==0?g:""));INTERMediatorLib.addEvent(f,"click",function(){INTERMediator_DBAdapter.unregister();INTERMediator.startFrom=0;INTERMediator.constructMain(true)});f=document.createElement("SPAN");d.appendChild(f);f.appendChild(document.createTextNode((l===null||l[1]===null)?"<":l[1]));f.setAttribute("class","IM_NAV_button"+(a==0?g:""));q=(a-o>0)?a-o:0;INTERMediatorLib.addEvent(f,"click",function(){INTERMediator_DBAdapter.unregister();INTERMediator.startFrom=q;INTERMediator.constructMain(true)});f=document.createElement("SPAN");d.appendChild(f);f.appendChild(document.createTextNode((l===null||l[2]===null)?">":l[2]));f.setAttribute("class","IM_NAV_button"+(a+o>=m?g:""));p=(a+o<m)?a+o:((m-o>0)?a:0);INTERMediatorLib.addEvent(f,"click",function(){INTERMediator_DBAdapter.unregister();INTERMediator.startFrom=p;INTERMediator.constructMain(true)});f=document.createElement("SPAN");d.appendChild(f);f.appendChild(document.createTextNode((l===null||l[3]===null)?">>":l[3]));f.setAttribute("class","IM_NAV_button"+(a+o>=m?g:""));if(m%o==0){c=m-(m%o)-o}else{c=m-(m%o)}INTERMediatorLib.addEvent(f,"click",function(){INTERMediator_DBAdapter.unregister();INTERMediator.startFrom=(c>0)?c:0;INTERMediator.constructMain(true)});f=document.createElement("SPAN");d.appendChild(f);f.appendChild(document.createTextNode(INTERMediatorOnPage.getMessages()[10]));h=document.createElement("INPUT");h.setAttribute("class","IM_NAV_JUMP");h.setAttribute("type","text");h.setAttribute("value",Math.ceil(INTERMediator.startFrom/o+1));f.appendChild(h);f.appendChild(document.createTextNode(INTERMediatorOnPage.getMessages()[11]));INTERMediatorLib.addEvent(h,"change",function(){if(this.value<1){this.value=1}var s=Math.ceil(m/o);if(s<this.value){this.value=s}INTERMediator.startFrom=(~~this.value-1)*o;INTERMediator.construct(true)})}if(l===null||l[9]!==false){for(k=0;k<IMLibPageNavigation.deleteInsertOnNavi.length;k++){switch(IMLibPageNavigation.deleteInsertOnNavi[k]["kind"]){case"INSERT":f=document.createElement("SPAN");d.appendChild(f);f.appendChild(document.createTextNode(INTERMediatorOnPage.getMessages()[3]+": "+IMLibPageNavigation.deleteInsertOnNavi[k]["name"]));f.setAttribute("class","IM_NAV_button");r=function(t,s,x){var w=t,v=s,u=x;return function(){IMLibPageNavigation.insertRecordFromNavi(w,v,u)}};INTERMediatorLib.addEvent(f,"click",r(IMLibPageNavigation.deleteInsertOnNavi[k]["name"],IMLibPageNavigation.deleteInsertOnNavi[k]["key"],IMLibPageNavigation.deleteInsertOnNavi[k]["confirm"]?true:false));break;case"DELETE":f=document.createElement("SPAN");d.appendChild(f);f.appendChild(document.createTextNode(INTERMediatorOnPage.getMessages()[4]+": "+IMLibPageNavigation.deleteInsertOnNavi[k]["name"]));f.setAttribute("class","IM_NAV_button");n=function(t,s,z,y){var x=t,v=s,w=z,u=y;return function(){IMLibPageNavigation.deleteRecordFromNavi(x,v,w,u)}};INTERMediatorLib.addEvent(f,"click",n(IMLibPageNavigation.deleteInsertOnNavi[k]["name"],IMLibPageNavigation.deleteInsertOnNavi[k]["key"],IMLibPageNavigation.deleteInsertOnNavi[k]["value"],IMLibPageNavigation.deleteInsertOnNavi[k]["confirm"]?true:false));break}}}if(l===null||l[10]!==false){if(INTERMediatorOnPage.getOptionsTransaction()=="none"){f=document.createElement("SPAN");d.appendChild(f);f.appendChild(document.createTextNode((l===null||l[10]===null)?INTERMediatorOnPage.getMessages()[7]:l[10]));f.setAttribute("class","IM_NAV_button");INTERMediatorLib.addEvent(f,"click",IMLibPageNavigation.saveRecordFromNavi)}}if(l===null||l[11]!==false){if(INTERMediatorOnPage.requireAuthentication){f=document.createElement("SPAN");d.appendChild(f);f.appendChild(document.createTextNode(INTERMediatorOnPage.getMessages()[8]+INTERMediatorOnPage.authUser));f.setAttribute("class","IM_NAV_info");f=document.createElement("SPAN");d.appendChild(f);f.appendChild(document.createTextNode((l===null||l[11]===null)?INTERMediatorOnPage.getMessages()[9]:l[11]));f.setAttribute("class","IM_NAV_button");INTERMediatorLib.addEvent(f,"click",function(){INTERMediatorOnPage.logout();location.reload()})}}}},insertRecordFromNavi:function(e,d,g){var c,l,h,f,a;if(g){if(!confirm(INTERMediatorOnPage.getMessages()[1026])){return}}INTERMediatorOnPage.showProgress();f=INTERMediatorLib.getNamedObject(INTERMediatorOnPage.getDataSources(),"name",e);if(f===null){alert("no targetname :"+e);INTERMediatorOnPage.hideProgress();return}try{INTERMediatorOnPage.retrieveAuthInfo();a=INTERMediator_DBAdapter.db_createRecord({name:e,dataset:[]});c=a.newKeyValue}catch(k){if(k=="_im_requath_request_"){if(INTERMediatorOnPage.requireAuthentication){if(!INTERMediatorOnPage.isComplementAuthData()){INTERMediatorOnPage.authChallenge=null;INTERMediatorOnPage.authHashedPassword=null;INTERMediatorOnPage.authenticating(function(){IMLibPageNavigation.insertRecordFromNavi(e,d,g)});INTERMediator.flushMessage();return}}}else{INTERMediator.setErrorMessage(k,"EXCEPTION-5")}}if(c>-1){restore=INTERMediator.additionalCondition;INTERMediator.startFrom=0;if(f.records<=1){l=INTERMediator.additionalCondition;l[e]={field:d,value:c};INTERMediator.additionalCondition=l;IMLibLocalContext.archive()}INTERMediator_DBAdapter.unregister();INTERMediator.constructMain(true);INTERMediator.additionalCondition=restore}IMLibCalc.recalculation();INTERMediatorOnPage.hideProgress();INTERMediator.flushMessage()},deleteRecordFromNavi:function(c,f,e,d){if(d){if(!confirm(INTERMediatorOnPage.getMessages()[1025])){return}}INTERMediatorOnPage.showProgress();try{INTERMediatorOnPage.retrieveAuthInfo();INTERMediator_DBAdapter.db_delete({name:c,conditions:[{field:f,operator:"=",value:e}]})}catch(a){if(a=="_im_requath_request_"){INTERMediatorOnPage.authChallenge=null;INTERMediatorOnPage.authHashedPassword=null;INTERMediatorOnPage.authenticating(function(){IMLibPageNavigation.deleteRecordFromNavi(c,f,e,d)});INTERMediator.flushMessage();return}else{INTERMediator.setErrorMessage(a,"EXCEPTION-6")}}if(INTERMediator.pagedAllCount-INTERMediator.startFrom<2){INTERMediator.startFrom--;if(INTERMediator.startFrom<0){INTERMediator.startFrom=0}}INTERMediator.constructMain(true);INTERMediatorOnPage.hideProgress();INTERMediator.flushMessage()},saveRecordFromNavi:function(k){var t,p,a,l,r,h,n,o,f,m,u,g,d,s=true,c,e;INTERMediatorOnPage.showProgress();INTERMediatorOnPage.retrieveAuthInfo();for(o=0;o<IMLibContextPool.poolingContexts.length;o++){c=IMLibContextPool.poolingContexts[o];e=c.getModified();for(p in e){u=[];g=[];for(a in e[p]){u.push(a);g.push({field:a,value:e[p][a]})}if(!INTERMediator.ignoreOptimisticLocking){l=p.split("=");r=l[0];l.shift();h=l.join("=");n={name:c.contextName,records:1,paging:false,fields:u,parentkeyvalue:null,conditions:[{field:r,operator:"=",value:h}],useoffset:false,primaryKeyOnly:true};try{m=INTERMediator_DBAdapter.db_query(n)}catch(q){if(q=="_im_requath_request_"){if(INTERMediatorOnPage.requireAuthentication&&!INTERMediatorOnPage.isComplementAuthData()){INTERMediatorOnPage.authChallenge=null;INTERMediatorOnPage.authHashedPassword=null;INTERMediatorOnPage.authenticating(function(){INTERMediator.db_query(n)});return}}else{INTERMediator.setErrorMessage(q,"EXCEPTION-28")}}if(m.recordset==null||m.recordset[0]===null){alert(INTERMediatorLib.getInsertedString(INTERMediatorOnPage.getMessages()[1003],[u.join(",")]));return}if(m.count>1){response=confirm(INTERMediatorOnPage.getMessages()[1024]);if(!response){return}}d=false;for(a in e[p]){f=c.getValue(p,a);if(f!=m.recordset[0][a]){d+=INTERMediatorLib.getInsertedString(INTERMediatorOnPage.getMessages()[1035],[a,m.recordset[0][a],e[p][a]])}}if(d!==false){if(!confirm(INTERMediatorLib.getInsertedString(INTERMediatorOnPage.getMessages()[1034],[d]))){return}INTERMediatorOnPage.retrieveAuthInfo()}}try{INTERMediator_DBAdapter.db_update({name:c.contextName,conditions:[{field:r,operator:"=",value:h}],dataset:g})}catch(q){if(q=="_im_requath_request_"){if(INTERMediatorOnPage.requireAuthentication&&!INTERMediatorOnPage.isComplementAuthData()){INTERMediatorOnPage.authChallenge=null;INTERMediatorOnPage.authHashedPassword=null;INTERMediatorOnPage.authenticating(function(){IMLibPageNavigation.deleteRecordFromNavi(targetName,keyField,keyValue,isConfirm)});return}}else{INTERMediator.setErrorMessage(q,"EXCEPTION-29")}}c.clearModified()}}if(s&&(k!==true)){INTERMediator.constructMain(true)}INTERMediatorOnPage.hideProgress();INTERMediator.flushMessage()}};var IMLibUI={isShiftKeyDown:false,isControlKeyDown:false,keyDown:function(a){var c=(window.event)?a.which:a.keyCode;if(c==16){IMLibUI.isShiftKeyDown=true}if(c==17){IMLibUI.isControlKeyDown=true}},keyUp:function(a){var c=(window.event)?a.which:a.keyCode;if(c==16){IMLibUI.isShiftKeyDown=false}if(c==17){IMLibUI.isControlKeyDown=false}},valueChange:function(e){var g,d,l,k,n,f,o,c,m,p;if(IMLibUI.isShiftKeyDown&&IMLibUI.isControlKeyDown){INTERMediator.setDebugMessage("Canceled to update the value with shift+control keys.");INTERMediator.flushMessage();IMLibUI.isShiftKeyDown=false;IMLibUI.isControlKeyDown=false;return}IMLibUI.isShiftKeyDown=false;IMLibUI.isControlKeyDown=false;g=document.getElementById(e);if(g!=null){if(g.readOnly){return}if(!h(g)){return}d=g.getAttribute("type");if(d=="radio"&&!g.checked){INTERMediatorOnPage.hideProgress();return}m=INTERMediatorLib.getLinkedElementInfo(g);if(!m&&INTERMediatorLib.isWidgetElement(g.parentNode)){m=INTERMediatorLib.getLinkedElementInfo(g.parentNode)}p=INTERMediatorLib.getNodeInfoArray(m[0]);l=IMLibContextPool.getContextInfoFromId(e,p.target);if(l){c=IMLibElement.getValueFromIMNode(g);if(INTERMediatorOnPage.getOptionsTransaction()=="none"){l.context.setModified(l.record,l.field,c)}else{INTERMediatorOnPage.showProgress();if(!IMLibElement.checkOptimisticLock(g,p.target)){INTERMediatorOnPage.hideProgress()}else{IMLibContextPool.updateContext(e,p.target);a(g,e,p.target);n=IMLibContextPool.dependingObjects(e);for(k=0;k<n.length;k++){n[k].foreignValue={};n[k].foreignValue[l.field]=c;if(n[k]){INTERMediator.constructMain(n[k]);f=n[k].enclosureNode;if(INTERMediatorLib.isPopupMenu(f)){o=l.context.getContextValue(f.id,"");IMLibElement.setValueToIMNode(f,"",o,false)}}}}}}IMLibCalc.recalculation(e);INTERMediator.flushMessage()}function h(t){var y,s,r,v,z,x,w,B,q,u;try{y=INTERMediatorLib.getLinkedElementInfo(t);x=false;B=true;if(y.length>0){s=y[0].match(/([^@]+)/);if(s[1]!=IMLibLocalContext.contextName){r=INTERMediatorLib.getNamedObject(INTERMediatorOnPage.getDataSources(),"name",s[1]);if(r.validation!=null){for(v=0;v<y.length;v++){s=y[v].match(/([^@]+)@([^@]+)/);for(z in r.validation){if(r.validation[z]["field"]==s[2]){x=true;B=Parser.evaluate(r.validation[z]["rule"],{value:t.value,target:t});if(!B){switch(r.validation[z]["notify"]){case"inline":INTERMediatorLib.clearErrorMessage(t);q=INTERMediatorLib.createErrorMessageNode("SPAN",r.validation[z].message);t.parentNode.insertBefore(q,t.nextSibling);break;case"end-of-sibling":INTERMediatorLib.clearErrorMessage(t);q=INTERMediatorLib.createErrorMessageNode("DIV",r.validation[z].message);t.parentNode.appendChild(q);break;default:alert(r.validation[z]["message"])}w=IMLibContextPool.getContextInfoFromId(e,"");t.value=w.context.getValue(w.record,w.field);window.setTimeout(function(){t.focus()},0);if(INTERMediatorOnPage.doAfterValidationFailure!=null){INTERMediatorOnPage.doAfterValidationFailure(t,y[v])}return B}else{switch(r.validation[z]["notify"]){case"inline":case"end-of-sibling":INTERMediatorLib.clearErrorMessage(t);break}}}}}}}if(x){if(INTERMediatorOnPage.doAfterValidationSucceed!=null){INTERMediatorOnPage.doAfterValidationSucceed(t,y[v])}}}return B}catch(A){if(A=="_im_requath_request_"){throw A}else{INTERMediator.setErrorMessage(A,"EXCEPTION-32: on the validation process.")}return false}}function a(w,q,u){var t,r,v;INTERMediatorOnPage.retrieveAuthInfo();r=IMLibContextPool.getContextInfoFromId(q,u);t=IMLibElement.getValueFromIMNode(w);if(t!=null){v=r.record.split("=");try{INTERMediator_DBAdapter.db_update({name:r.context.contextName,conditions:[{field:v[0],operator:"=",value:v[1]}],dataset:[{field:r.field+(r.portal?("."+r.portal):""),value:t}]})}catch(s){if(s=="_im_requath_request_"){if(INTERMediatorOnPage.requireAuthentication&&!INTERMediatorOnPage.isComplementAuthData()){INTERMediatorOnPage.authChallenge=null;INTERMediatorOnPage.authHashedPassword=null;INTERMediatorOnPage.authenticating(function(){a(w,q)});return}}else{INTERMediator.setErrorMessage(s,"EXCEPTION-2")}}}INTERMediatorOnPage.hideProgress()}},deleteButton:function(f,d,e,a,c,l,h){var g;if(h){if(!confirm(INTERMediatorOnPage.getMessages()[1025])){return}}INTERMediatorOnPage.showProgress();try{INTERMediatorOnPage.retrieveAuthInfo();currentContext=INTERMediatorLib.getNamedObject(INTERMediatorOnPage.getDataSources(),"name",f);relationDef=currentContext.relation;if(relationDef){for(index in relationDef){if(relationDef[index]["portal"]==true){currentContext.portal=true}}}if(a!=""&&currentContext.portal==true){INTERMediator_DBAdapter.db_update({name:f,conditions:[{field:d,operator:"=",value:e}],dataset:[{field:"-delete.related",operator:"=",value:a.replace("::-recid","")+"."+c}]})}else{INTERMediator_DBAdapter.db_delete({name:f,conditions:[{field:d,operator:"=",value:e}]})}}catch(k){if(k=="_im_requath_request_"){if(INTERMediatorOnPage.requireAuthentication&&!INTERMediatorOnPage.isComplementAuthData()){INTERMediatorOnPage.authChallenge=null;INTERMediatorOnPage.authHashedPassword=null;INTERMediatorOnPage.authenticating(function(){IMLibUI.deleteButton(f,d,e,a,c,l,false)});return}}else{INTERMediator.setErrorMessage(k,"EXCEPTION-3")}}for(g=0;g<l.length;g++){IMLibContextPool.removeRecordFromPool(l[g])}IMLibElement.deleteNodes(l);IMLibCalc.recalculation();INTERMediatorOnPage.hideProgress();INTERMediator.flushMessage()},insertButton:function(r,y,x,q,w,n){var h,s,l,E,m,z,u,B,D,p,c,t=false,f,v,e,o,d,k,g,C,a;if(n){if(!confirm(INTERMediatorOnPage.getMessages()[1026])){return}}INTERMediatorOnPage.showProgress();h=INTERMediatorLib.getNamedObject(INTERMediatorOnPage.getDataSources(),"name",r);s=[],f=[];if(x!=null){for(l in h.relation){s.push({field:h.relation[l]["foreign-key"],value:x[h.relation[l]["join-field"]]})}}try{INTERMediatorOnPage.retrieveAuthInfo();u=h.relation;if(u){for(l in u){if(u[l]["portal"]==true){h.portal=true}}}if(h.portal==true){f=[];for(l in h["default-values"]){f.push({field:r+"::"+h["default-values"][l]["field"]+".0",value:h["default-values"][l]["value"]})}if(f.length==0){c="";B=INTERMediator_DBAdapter.db_query({name:r,records:1,conditions:[{field:h.key?h.key:"-recid",operator:"=",value:y}]});for(D in B.recordset[0][0]){if(D.indexOf(r+"::")>-1&&D!==r+"::-recid"){t=true;p=D;if(D==r+"::"+s[0]["field"]){c=s[0]["value"];break}if(D!=r+"::id"&&D!=r+"::"+s[0]["field"]){break}}}if(t==false){B=INTERMediator_DBAdapter.db_query({name:r,records:0,conditions:[{field:h.key?h.key:"-recid",operator:"=",value:y}]});for(D in B.recordset){if(D.indexOf(r+"::")>-1&&D!==r+"::-recid"){p=D;if(D==r+"::"+s[0]["field"]){c=s[0]["value"];break}if(D!=r+"::id"&&D!=r+"::"+s[0]["field"]){break}}}}f.push({field:p+".0",value:c})}INTERMediator_DBAdapter.db_update({name:r,conditions:[{field:h.key?h.key:"-recid",operator:"=",value:y}],dataset:f});B=INTERMediator_DBAdapter.db_query({name:r,records:1,conditions:[{field:h.key?h.key:"-recid",operator:"=",value:y}]});k={};a=-1;for(g in B.recordset[0]){if(g==Number(g)&&B.recordset[0][g][r+"::-recid"]){C=parseInt(B.recordset[0][g][r+"::-recid"],10);if(C>a){a=C;k.recordset=[];k.recordset.push(B.recordset[0][g])}}}}else{k=INTERMediator_DBAdapter.db_createRecord({name:r,dataset:s});v=k.newKeyValue}}catch(A){if(A=="_im_requath_request_"){INTERMediatorOnPage.authChallenge=null;INTERMediatorOnPage.authHashedPassword=null;INTERMediatorOnPage.authenticating(function(){IMLibUI.insertButton(r,y,x,q,w,false)});INTERMediator.flushMessage();return}else{INTERMediator.setErrorMessage(A,"EXCEPTION-4")}}e=h.key?h.key:"-recid";o=IMLibContextPool.contextFromEnclosureId(q);if(o){o.foreignValue=x;if(h.portal==true&&t==false){m=INTERMediator.additionalCondition;m[r]={field:e,operator:"=",value:y};INTERMediator.additionalCondition=m}d=[{}];d[0][e]=v;INTERMediator.constructMain(o,k.recordset)}IMLibCalc.recalculation();INTERMediatorOnPage.hideProgress();INTERMediator.flushMessage()},clickPostOnlyButton:function(t){var x,w,f,m,z,s,h,y,C;var o,B,e,v,d,p,r;var g,u,n,a;var l=t.parentNode;while(!INTERMediatorLib.isEnclosure(l,true)){l=l.parentNode;if(!l){return}}g=[];u=[];for(x=0;x<l.childNodes.length;x++){c(l.childNodes[x])}s={};for(x=0;x<g.length;x++){m=INTERMediatorLib.getLinkedElementInfo(g[x]);for(w=0;w<m.length;w++){z=m[w].split(INTERMediator.separator);if(!s[z[w]]){s[z[w]]=0}s[z[w]]++}}if(s.length<1){return}var q=-100;for(var A in s){if(q<s[A]){q=s[A];h=A;y=INTERMediatorOnPage.getContextInfo(A)}}r="";f=[];a=false;for(x=0;x<g.length;x++){m=INTERMediatorLib.getLinkedElementInfo(g[x]);for(w=0;w<m.length;w++){z=m[w].split(INTERMediator.separator);if(z[0]==h){if(y.validation){for(n in y.validation){C=y.validation[n];if(C&&C.field==z[1]){switch(C.notify){case"inline":case"end-of-sibling":INTERMediatorLib.clearErrorMessage(g[x]);break}}}for(n in y.validation){C=y.validation[n];if(C.field==z[1]){if(C){p=Parser.evaluate(C.rule,{value:g[x].value,target:g[x]});if(!p){a=true;switch(C.notify){case"inline":INTERMediatorLib.clearErrorMessage(g[x]);d=INTERMediatorLib.createErrorMessageNode("SPAN",C.message);g[x].parentNode.insertBefore(d,g[x].nextSibling);break;case"end-of-sibling":INTERMediatorLib.clearErrorMessage(g[x]);d=INTERMediatorLib.createErrorMessageNode("DIV",C.message);g[x].parentNode.appendChild(d);break;default:r+=C.message+"\n"}if(INTERMediatorOnPage.doAfterValidationFailure!=null){INTERMediatorOnPage.doAfterValidationFailure(g[x])}}}}}}if(INTERMediatorLib.isWidgetElement(g[x])){f.push({field:z[1],value:g[x]._im_getValue()})}else{if(g[x].tagName=="SELECT"){f.push({field:z[1],value:g[x].value})}else{if(g[x].tagName=="TEXTAREA"){f.push({field:z[1],value:g[x].value})}else{if(g[x].tagName=="INPUT"){if((g[x].getAttribute("type")=="radio")||(g[x].getAttribute("type")=="checkbox")){if(g[x].checked){f.push({field:z[1],value:g[x].value})}}else{f.push({field:z[1],value:g[x].value})}}}}}}}}for(x=0;x<u.length;x++){m=INTERMediatorLib.getNamedInfo(u[x]);for(w=0;w<m.length;w++){z=m[w].split(INTERMediator.separator);if(z[0]==h){o=[];B=u[x].getElementsByTagName("INPUT");for(v=0;v<B.length;v++){e=B[v].getAttribute("type");if(e=="radio"||e=="checkbox"){if(B[v].checked){o.push(B[v].value)}}else{o.push(B[v].value)}}f.push({field:z[1],value:o.join("\n")+"\n"})}}}if(r.length>0){window.alert(r);return}if(a){return}if(INTERMediatorOnPage.processingBeforePostOnlyContext){if(!INTERMediatorOnPage.processingBeforePostOnlyContext(l)){return}}y=INTERMediatorLib.getNamedObject(INTERMediatorOnPage.getDataSources(),"name",h);INTERMediator_DBAdapter.db_createRecordWithAuth({name:h,dataset:f},function(F){var D,H,G=t,E=y,k=false;INTERMediator.flushMessage();if(INTERMediatorOnPage.processingAfterPostOnlyContext){INTERMediatorOnPage.processingAfterPostOnlyContext(G,F)}if(E["post-dismiss-message"]){H=G.parentNode;H.removeChild(G);D=document.createElement("SPAN");INTERMediatorLib.setClassAttributeToNode(D,"IM_POSTMESSAGE");D.appendChild(document.createTextNode(E["post-dismiss-message"]));H.appendChild(D);k=true}if(E["post-reconstruct"]){setTimeout(function(){INTERMediator.construct(true)},k?INTERMediator.waitSecondsAfterPostMessage*1000:0)}if(E["post-move-url"]){setTimeout(function(){location.href=E["post-move-url"]},k?INTERMediator.waitSecondsAfterPostMessage*1000:0)}});function c(E){var D,k;if(E.nodeType===1){if(INTERMediatorLib.isLinkedElement(E)){g.push(E)}else{if(INTERMediatorLib.isWidgetElement(E)){g.push(E)}else{if(INTERMediatorLib.isNamedElement(E)){u.push(E)}else{D=E.childNodes;for(k=0;k<D.length;k++){c(D[k])}}}}}}},eventUpdateHandler:function(c){IMLibLocalContext.updateAll();var a=IMLibContextPool.getContextFromName(c);INTERMediator.constructMain(a[0])},eventAddOrderHandler:function(h){var a,d,f,g,c;if(h.target){a=h.target.getAttribute("data-im")}else{a=h.srcElement.getAttribute("data-im")}d=a.split(":");if(d[0]!="_@addorder"||d.length<3){return}for(f in IMLibLocalContext.store){g=f.split(":");if(g.length>3&&g[0]=="valueofaddorder"&&g[1]==d[1]){c=IMLibLocalContext.getValue(f);if(c){IMLibLocalContext.store[f]++}}}IMLibLocalContext.setValue("valueof"+a.substring(2),1);IMLibUI.eventUpdateHandler(d[1])}};function SHA1(f){function e(B,A){var z=(B<<A)|(B>>>(32-A));return z}function t(C){var B="";var z;var D;var A;for(z=0;z<=6;z+=2){D=(C>>>(z*4+4))&15;A=(C>>>(z*4))&15;B+=D.toString(16)+A.toString(16)}return B}function v(C){var B="";var A;var z;for(A=7;A>=0;A--){z=(C>>>(A*4))&15;B+=z.toString(16)}return B}function c(A){A=A.replace(/\r\n/g,"\n");var z="";for(var C=0;C<A.length;C++){var B=A.charCodeAt(C);if(B<128){z+=String.fromCharCode(B)}else{if((B>127)&&(B<2048)){z+=String.fromCharCode((B>>6)|192);z+=String.fromCharCode((B&63)|128)}else{z+=String.fromCharCode((B>>12)|224);z+=String.fromCharCode(((B>>6)&63)|128);z+=String.fromCharCode((B&63)|128)}}}return z}var k;var x,w;var d=new Array(80);var o=1732584193;var m=4023233417;var l=2562383102;var h=271733878;var g=3285377520;var u,s,r,q,p;var y;f=c(f);var a=f.length;var n=new Array();for(x=0;x<a-3;x+=4){w=f.charCodeAt(x)<<24|f.charCodeAt(x+1)<<16|f.charCodeAt(x+2)<<8|f.charCodeAt(x+3);n.push(w)}switch(a%4){case 0:x=2147483648;break;case 1:x=f.charCodeAt(a-1)<<24|8388608;break;case 2:x=f.charCodeAt(a-2)<<24|f.charCodeAt(a-1)<<16|32768;break;case 3:x=f.charCodeAt(a-3)<<24|f.charCodeAt(a-2)<<16|f.charCodeAt(a-1)<<8|128;break}n.push(x);while((n.length%16)!=14){n.push(0)}n.push(a>>>29);n.push((a<<3)&4294967295);for(k=0;k<n.length;k+=16){for(x=0;x<16;x++){d[x]=n[k+x]}for(x=16;x<=79;x++){d[x]=e(d[x-3]^d[x-8]^d[x-14]^d[x-16],1)}u=o;s=m;r=l;q=h;p=g;for(x=0;x<=19;x++){y=(e(u,5)+((s&r)|(~s&q))+p+d[x]+1518500249)&4294967295;p=q;q=r;r=e(s,30);s=u;u=y}for(x=20;x<=39;x++){y=(e(u,5)+(s^r^q)+p+d[x]+1859775393)&4294967295;p=q;q=r;r=e(s,30);s=u;u=y}for(x=40;x<=59;x++){y=(e(u,5)+((s&r)|(s&q)|(r&q))+p+d[x]+2400959708)&4294967295;p=q;q=r;r=e(s,30);s=u;u=y}for(x=60;x<=79;x++){y=(e(u,5)+(s^r^q)+p+d[x]+3395469782)&4294967295;p=q;q=r;r=e(s,30);s=u;u=y}o=(o+u)&4294967295;m=(m+s)&4294967295;l=(l+r)&4294967295;h=(h+q)&4294967295;g=(g+p)&4294967295}var y=v(o)+v(m)+v(l)+v(h)+v(g);return y.toLowerCase()}(function(){var r=8,u="",s=0,t=function(z){var x=[],y=(1<<r)-1,B=z.length*r,A;for(A=0;A<B;A+=r){x[A>>5]|=(z.charCodeAt(A/r)&y)<<(32-r-(A%32))}return x},e=function(y){var x=[],B=y.length,A,z;for(A=0;A<B;A+=2){z=parseInt(y.substr(A,2),16);if(!isNaN(z)){x[A>>3]|=z<<(24-(4*(A%8)))}else{return"INVALID HEX STRING"}}return x},h=function(y){var x=(s)?"0123456789ABCDEF":"0123456789abcdef",C="",B=y.length*4,A,z;for(A=0;A<B;A+=1){z=y[A>>2]>>((3-(A%4))*8);C+=x.charAt((z>>4)&15)+x.charAt(z&15)}return C},n=function(y){var x="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",D="",B=y.length*4,A,z,C;for(A=0;A<B;A+=3){C=(((y[A>>2]>>8*(3-A%4))&255)<<16)|(((y[A+1>>2]>>8*(3-(A+1)%4))&255)<<8)|((y[A+2>>2]>>8*(3-(A+2)%4))&255);for(z=0;z<4;z+=1){if(A*8+z*6<=y.length*32){D+=x.charAt((C>>6*(3-z))&63)}else{D+=u}}}return D},k=function(y,z){return(y>>>z)|(y<<(32-z))},q=function(y,z){return y>>>z},l=function(A,C,B){return(A&C)^(~A&B)},c=function(A,C,B){return(A&C)^(A&B)^(C&B)},o=function(y){return k(y,2)^k(y,13)^k(y,22)},m=function(y){return k(y,6)^k(y,11)^k(y,25)},w=function(y){return k(y,7)^k(y,18)^q(y,3)},v=function(y){return k(y,17)^k(y,19)^q(y,10)},f=function(z,C){var A=(z&65535)+(C&65535),B=(z>>>16)+(C>>>16)+(A>>>16);return((B&65535)<<16)|(A&65535)},d=function(y,x,C,B){var A=(y&65535)+(x&65535)+(C&65535)+(B&65535),z=(y>>>16)+(x>>>16)+(C>>>16)+(B>>>16)+(A>>>16);return((z&65535)<<16)|(A&65535)},a=function(y,x,D,C,B){var A=(y&65535)+(x&65535)+(D&65535)+(C&65535)+(B&65535),z=(y>>>16)+(x>>>16)+(D>>>16)+(C>>>16)+(B>>>16)+(A>>>16);return((z&65535)<<16)|(A&65535)},g=function(G,F,E){var S,R,Q,P,O,N,M,J,D,B,z,L,I,A,y,x=[],C;if(E==="SHA-224"||E==="SHA-256"){L=(((F+65)>>9)<<4)+15;y=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];if(E==="SHA-224"){z=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}else{z=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]}}G[F>>5]|=128<<(24-F%32);G[L]=F;C=G.length;for(I=0;I<C;I+=16){S=z[0];R=z[1];Q=z[2];P=z[3];O=z[4];N=z[5];M=z[6];J=z[7];for(A=0;A<64;A+=1){if(A<16){x[A]=G[A+I]}else{x[A]=d(v(x[A-2]),x[A-7],w(x[A-15]),x[A-16])}D=a(J,m(O),l(O,N,M),y[A],x[A]);B=f(o(S),c(S,R,Q));J=M;M=N;N=O;O=f(P,D);P=Q;Q=R;R=S;S=f(D,B)}z[0]=f(S,z[0]);z[1]=f(R,z[1]);z[2]=f(Q,z[2]);z[3]=f(P,z[3]);z[4]=f(O,z[4]);z[5]=f(N,z[5]);z[6]=f(M,z[6]);z[7]=f(J,z[7])}switch(E){case"SHA-224":return[z[0],z[1],z[2],z[3],z[4],z[5],z[6]];case"SHA-256":return z;default:return[]}},p=function(y,x){this.sha224=null;this.sha256=null;this.strBinLen=null;this.strToHash=null;if("HEX"===x){if(0!==(y.length%2)){return"TEXT MUST BE IN BYTE INCREMENTS"}this.strBinLen=y.length*4;this.strToHash=e(y)}else{if(("ASCII"===x)||("undefined"===typeof(x))){this.strBinLen=y.length*r;this.strToHash=t(y)}else{return"UNKNOWN TEXT INPUT TYPE"}}};p.prototype={getHash:function(y,x){var A=null,z=this.strToHash.slice();switch(x){case"HEX":A=h;break;case"B64":A=n;break;default:return"FORMAT NOT RECOGNIZED"}switch(y){case"SHA-224":if(null===this.sha224){this.sha224=g(z,this.strBinLen,y)}return A(this.sha224);case"SHA-256":if(null===this.sha256){this.sha256=g(z,this.strBinLen,y)}return A(this.sha256);default:return"HASH NOT RECOGNIZED"}},getHMAC:function(G,F,E,C){var B,A,z,x,D,I,H=[],y=[];switch(C){case"HEX":B=h;break;case"B64":B=n;break;default:return"FORMAT NOT RECOGNIZED"}switch(E){case"SHA-224":I=224;break;case"SHA-256":I=256;break;default:return"HASH NOT RECOGNIZED"}if("HEX"===F){if(0!==(G.length%2)){return"KEY MUST BE IN BYTE INCREMENTS"}A=e(G);D=G.length*4}else{if("ASCII"===F){A=t(G);D=G.length*r}else{return"UNKNOWN KEY INPUT TYPE"}}if(64<(D/8)){A=g(A,D,E);A[15]&=4294967040}else{if(64>(D/8)){A[15]&=4294967040}}for(z=0;z<=15;z+=1){H[z]=A[z]^909522486;y[z]=A[z]^1549556828}x=g(H.concat(this.strToHash),512+this.strBinLen,E);x=g(y.concat(x),512+I,E);return(B(x))}};window.jsSHA=p}());var biRadixBase=2;var biRadixBits=16;biRadixBits=biRadixBits-biRadixBits%4;var bitsPerDigit=biRadixBits;var biRadix=1<<biRadixBits;var biHalfRadix=biRadix>>>1;var biRadixSquared=biRadix*biRadix;var maxDigitVal=biRadix-1;var maxInteger=4294967295;var biHexPerDigit=biRadixBits/4;var bigZero=biFromNumber(0);var bigOne=biFromNumber(1);var dpl10=9;var lr10=biFromNumber(1000000000);function BigInt(a){this.isNeg=false;if(a==-1){return}if(a){this.digits=new Array(a);while(a){this.digits[--a]=0}}else{this.digits=[0]}}BigInt.prototype.isZero=function(){return this.digits[0]==0&&biNormalize(this).digits.length==1};BigInt.prototype.isOne=function(){return this.digits[0]==1&&!this.isNeg&&biNormalize(this).digits.length==1};BigInt.prototype.isEqual=function(c){if(this.isNeg!=c.isNeg){return false}if(this.digits.length!=c.digits.length){return false}for(var a=this.digits.length-1;a>-1;a--){if(this.digits[a]!=c.digits[a]){return false}}return true};BigInt.prototype.blankZero=function(){this.digits.length=1;this.digits[0]=0};BigInt.prototype.blankOne=function(){this.digits.length=1;this.digits[0]=1};BigInt.prototype.blankEmpty=function(){this.digits.length=0};function biCopy(c){var a=new BigInt(-1);a.digits=c.digits.slice(0);a.isNeg=c.isNeg;return a}function biAbs(c){var a=new BigInt(-1);a.digits=c.digits.slice(0);a.isNeg=false;return a}function biMinus(c){var a=new BigInt(-1);a.digits=c.digits.slice(0);a.isNeg=!c.isNeg;return a}function biFromNumber(d){if(Math.abs(d)>maxInteger){return(biFromFloat(d))}var a=new BigInt();if(a.isNeg=d<0){d=-d}var c=0;while(d>0){a.digits[c++]=d&maxDigitVal;d>>>=biRadixBits}return a}function biFromFloat(e){var a=new BigInt();if(a.isNeg=e<0){e=-e}var d=0;while(e>0){var f=Math.floor(e/biRadix);a.digits[d++]=e-f*biRadix;e=f}return a}function biFromString(m,l){if(l==16){return biFromHex(m)}var a=m.charAt(0)=="-";var f=(a?1:0)-1;var n=new BigInt();var d=biCopy(bigOne);for(var e=m.length-1;e>f;e--){var g=m.charCodeAt(e);var h=charToHex(g);var k=biMultiplyDigit(d,h);n=biAdd(n,k);d=biMultiplyDigit(d,l)}n.isNeg=a;return biNormalize(n)}function biFromDecimal(a){return biFromString(a,10)}function biFromHex(f){var c=new BigInt();if(f.charAt(0)=="-"){c.isNeg=true;f=substr(f,1)}else{c.isNeg=false}var a=f.length;for(var e=a,d=0;e>0;e-=biHexPerDigit,d++){c.digits[d]=hexToDigit(f.substr(Math.max(e-biHexPerDigit,0),Math.min(e,biHexPerDigit)))}return biNormalize(c)}function reverseStr(d){var a="";for(var c=d.length-1;c>-1;c--){a+=d.charAt(c)}return a}var hexatrigesimalToChar=new Array("0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z");function biToString(d,f){if(f==16){return biToHex(d)}var c=biFromNumber(f);var e=biDivideModulo(biAbs(d),c);var a=hexatrigesimalToChar[e[1].digits[0]];while(!e[0].isZero()){e=biDivideModulo(e[0],c);a+=hexatrigesimalToChar[e[1].digits[0]]}return(d.isNeg?"-":"")+reverseStr(a)}function biToDecimal(a){return biToString(a,10)}var hexToChar=new Array("0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f");function digitToHex(e){var c=15;var a="";for(var d=0;d<biHexPerDigit;d++){a+=hexToChar[e&c];e>>>=4}return reverseStr(a)}function digitToHexTrunk(e){if(e==0){return"0"}var c=15;var a="";for(var d=0;d<biHexPerDigit&&e>0;d++){a+=hexToChar[e&c];e>>>=4}return reverseStr(a)}function biToHex(c){var a=c.isNeg?"-":"";var d=biHighIndex(c);a+=digitToHexTrunk(c.digits[d--]);while(d>-1){a+=digitToHex(c.digits[d--])}return a}function biToNumber(c){var a=0;var e=1;var d=biHighIndex(c)+1;for(var f=0;f<d;f++){a+=c.digits[f]*e;e*=biRadix}return c.isNeg?-a:a}function charToHex(l){var e=48;var d=e+9;var f=97;var k=f+25;var h=65;var g=65+25;var a;if(l>=e&&l<=d){a=l-e}else{if(l>=h&&l<=g){a=10+l-h}else{if(l>=f&&l<=k){a=10+l-f}else{a=0}}}return a}function hexToDigit(e){var c=0;var a=Math.min(e.length,biHexPerDigit);for(var d=0;d<a;d++){c<<=4;c|=charToHex(e.charCodeAt(d))}return c}function biDump(a){return(a.isNeg?"minus ":"plus ")+a.digits.join(" ")}function biNormalize(a){var c=a.digits.length;if(a.digits[c-1]!=0&&!isNaN(a.digits[c-1])){return a}for(var d=c-1;d>0;d--){if(a.digits[d]==0||isNaN(a.digits[d])){a.digits.pop()}else{return a}}if(a.digits.length==1&&a.digits[0]==0){a.isNeg=false}if(isNaN(a.digits[0])){throw new Error("Undefined BigInt: "+biDump(a))}return a}function biHighIndex(a){biNormalize(a);return a.digits.length-1}function biNumBits(e){var g=biHighIndex(e);var f=e.digits[g];var c=(g+1)*bitsPerDigit;var a;for(a=c;a>c-bitsPerDigit;a--){if((f&biHalfRadix)!=0){break}f<<=1}return a}function biCompareAbs(c,f){var a=biHighIndex(c);var e=biHighIndex(f);if(a!=e){return 1-2*((a<e)?1:0)}for(var d=c.digits.length-1;d>-1;d--){if(c.digits[d]!=f.digits[d]){return 1-2*((c.digits[d]<f.digits[d])?1:0)}}return 0}function biCompare(a,c){if(a.isNeg!=c.isNeg){return 1-2*(a.isNeg?1:0)}return a.isNeg?-biCompareAbs(a,c):biCompareAbs(a,c)}function biAddNatural(m,l){var g=biHighIndex(m)+1;var f=biHighIndex(l)+1;var e=0;var h=0;if(g>f){var n=biAbs(m);var a=l;var d=f}else{var n=biAbs(l);var a=m;var d=g}while(e<d){n.digits[e]+=a.digits[e]+h;if(n.digits[e]<biRadix){h=0}else{n.digits[e]&=maxDigitVal;h=1}e++}while(h>0){n.digits[e]=(n.digits[e]||0)+h;if(n.digits[e]<biRadix){h=0}else{n.digits[e]&=maxDigitVal;h=1}e++}return n}function biSubtractNatural(l,k){var g=biHighIndex(l)+1;var f=biHighIndex(k)+1;var n=biAbs(l);var a=n.digits;var d=l.digits;var m=k.digits;var h=0;for(var e=0;e<f;e++){if(d[e]>=m[e]-h){a[e]=d[e]-m[e]+h;h=0}else{a[e]=biRadix+d[e]-m[e]+h;h=-1}}while(h<0&&e<g){if(d[e]>=-h){a[e]=d[e]+h;h=0}else{a[e]=biRadix+d[e]+h;h=-1}e++}return biNormalize(n)}function biAdd(c,e){var a;if(!c.isNeg&&!e.isNeg){return biAddNatural(c,e)}if(c.isNeg&&e.isNeg){a=biAddNatural(c,e);a.isNeg=true;return a}var d=biCompareAbs(c,e);if(d==0){return biFromNumber(0)}if(d>0){a=biSubtractNatural(c,e);a.isNeg=c.isNeg}if(d<0){a=biSubtractNatural(e,c);a.isNeg=e.isNeg}return a}function biSubtract(c,e){var a;if(!c.isNeg&&e.isNeg){return biAddNatural(c,e)}if(c.isNeg&&!e.isNeg){a=biAddNatural(c,e);a.isNeg=true;return a}var d=biCompareAbs(c,e);if(d==0){return biCopy(bigZero)}if(d>0){a=biSubtractNatural(c,e);a.isNeg=c.isNeg}if(d<0){a=biSubtractNatural(e,c);a.isNeg=!c.isNeg}return a}function biMultiply(p,o){var m,r,e,g;var f=biHighIndex(p)+1;var s=biHighIndex(o)+1;if(f==1&&p.digits[0]==0||s==1&&o.digits[0]==0){return new BigInt()}var v=new BigInt(f+s);var a=v.digits;var d=p.digits;var q=o.digits;for(var l=0;l<s;l++){m=0;g=l;for(var h=0;h<f;h++,g++){e=a[g]+d[h]*q[l]+m;a[g]=e&maxDigitVal;m=e>>>biRadixBits}a[l+f]=m}v.isNeg=p.isNeg!=o.isNeg;return biNormalize(v)}function biMultiplyDigit(d,k){var h=biHighIndex(d)+1;var a=new BigInt(h);var g=0;for(var e=0;e<h;e++){var f=a.digits[e]+d.digits[e]*k+g;a.digits[e]=f&maxDigitVal;g=f>>>biRadixBits}a.digits[h]=g;return a}function arrayCopy(g,k,d,h,f){if(k>=g.length){if(d.length==0){d[0]=0}return}for(var e=0;e<h;e++){d[e]=0}var a=Math.min(k+f,g.length);for(var e=k,c=h;e<a;e++,c++){d[c]=g[e]}}function biShiftLeft(c,h){var e=Math.floor(h/bitsPerDigit);var a=new BigInt();arrayCopy(c.digits,0,a.digits,e,c.digits.length);var g=h%bitsPerDigit;var d=bitsPerDigit-g;a.digits[a.digits.length]=a.digits[a.digits.length]>>>d;for(var f=a.digits.length-1;f>0;f--){a.digits[f]=((a.digits[f]<<g)&maxDigitVal)|(a.digits[f-1]>>>d)}a.digits[0]=(a.digits[0]<<g)&maxDigitVal;a.isNeg=c.isNeg;return biNormalize(a)}function biShiftRight(c,h){var d=Math.floor(h/bitsPerDigit);var a=new BigInt();arrayCopy(c.digits,d,a.digits,0,c.digits.length-d);var f=h%bitsPerDigit;var g=bitsPerDigit-f;for(var e=0;e<a.digits.length-1;e++){a.digits[e]=(a.digits[e]>>>f)|((a.digits[e+1]<<g)&maxDigitVal)}a.digits[a.digits.length-1]>>>=f;a.isNeg=c.isNeg;return biNormalize(a)}function biMultiplyByRadixPower(c,d){var a=new BigInt();arrayCopy(c.digits,0,a.digits,d,c.digits.length);return a}function biDivideByRadixPower(c,d){var a=new BigInt();arrayCopy(c.digits,d,a.digits,0,c.digits.length-d);return a}function biModuloByRadixPower(c,d){var a=new BigInt();arrayCopy(c.digits,0,a.digits,0,d);return a}function biMultiplyModByRadixPower(q,o,e){var m,s,f,h;var g=biHighIndex(q)+1;var v=biHighIndex(o)+1;if(g==1&&q.digits[0]==0||v==1&&o.digits[0]==0){return new BigInt()}var w=new BigInt(e);var a=w.digits;var d=q.digits;var r=o.digits;for(var l=0;l<v&&l<e;l++){m=0;h=l;for(j=0;j<g&&h<e;j++,h++){f=a[h]+d[j]*r[l]+m;a[h]=f&maxDigitVal;m=f>>>biRadixBits}a[l+g]=m}w=biModuloByRadixPower(w,e);w.isNeg=q.isNeg!=o.isNeg;return biNormalize(w)}function biDivideModuloNatural(n,l){var c,p,e,o,k;var h=biHighIndex(n);var g=biHighIndex(l);var d=new BigInt(-1);d.digits=[];var a=new BigInt();for(var f=h;f>-1;f--){a.digits.unshift(n.digits[f]);k=biCompareAbs(l,a);if(k>0){d.digits.unshift(0);continue}if(k==0){d.digits.unshift(1);a.blankZero();continue}var m=biHighIndex(a);if(m==g){e=Math.floor((a.digits[m]*biRadix+(a.digits[m-1]||0))/(l.digits[g]*biRadix+(l.digits[g-1]||0)+1))}else{e=Math.floor((a.digits[m]*biRadixSquared+(a.digits[m-1]||0)*biRadix+(a.digits[m-2]||0))/(l.digits[g]*biRadix+(l.digits[g-1]||0)+1))}e=Math.max(0,Math.min(e,maxDigitVal));o=biMultiplyDigit(l,e);a=biSubtract(a,o);if(a.isNeg){while(a.isNeg){a=biAdd(a,l);e--}}else{while(biCompare(a,l)>=0){a=biSubtract(a,l);e++}}d.digits.unshift(e)}return[biNormalize(d),biNormalize(a)]}function biDivideModulo(d,h){var g,f;if(biCompareAbs(d,h)<0){if((d.isNeg&&h.isNeg)||(!d.isNeg&&!h.isNeg)){g=biFromNumber(0);f=biCopy(d)}else{g=biFromNumber(-1);f=biAdd(h,d)}return[g,f]}var e=d.isNeg;var c=h.isNeg;var a=biDivideModuloNatural(biAbs(d),biAbs(h));g=a[0];f=a[1];if(!e&&!c){return[g,f]}else{if(e&&c){f.isNeg=true;return[g,f]}else{g.isNeg=true;g=biSubtract(g,bigOne);f.isNeg=e;f=biAdd(f,h)}}if(f.digits[0]==0&&biHighIndex(f)==0){f.isNeg=false}return[g,f]}function biDivide(a,c){return biDivideModulo(a,c)[0]}function biModulo(a,c){return biDivideModulo(a,c)[1]}function biMultiplyMod(c,d,a){return biModulo(biMultiply(c,d),a)}function biPow(d,f){var c=biCopy(bigOne);var e=d;while(true){if((f&1)!=0){c=biMultiply(c,e)}f>>>=1;if(f==0){break}e=biMultiply(e,e)}return c}function biPowMod(e,h,d){var c=biCopy(bigOne);var f=e;var g=h;while(true){if((g.digits[0]&1)!=0){c=biMultiplyMod(c,f,d)}g=biShiftRight(g,1);if(g.digits[0]==0&&biHighIndex(g)==0){break}f=biMultiplyMod(f,f,d)}return c}function biRandom(c){var a=new BigInt();while(c--){a.digits[c]=Math.floor(Math.random()*maxDigitVal)}return a}function biModularInverse(d,c){d=biModulo(d,c);var a=biExtendedEuclid(c,d);if(!a[2].isOne()){return null}return biModulo(a[1],c)}function biExtendedEuclid(e,d){if(biCompare(e,d)>=0){return biExtendedEuclidNatural(e,d)}var c=biExtendedEuclidNatural(d,e);return[c[1],c[0],c[2]]}function biExtendedEuclidNatural(o,l){var k,d,c,f,e,n,h,m,g;if(l.isZero()){return[biFromNumber(1),biFromNumber(0),o]}f=biFromNumber(0);e=biFromNumber(1);n=biFromNumber(1);h=biFromNumber(0);while(!l.isZero()){k=biDivideModulo(o,l);d=k[0];c=k[1];m=biSubtract(e,biMultiply(d,f));g=biSubtract(h,biMultiply(d,n));o=l;l=c;e=f;f=m;h=n;n=g}return[e,h,o]}function biMontgomeryPowMod(d,f,g){var c=biFromNumber(1);var a=biModulo(biMultiply(d,g.R),g);for(var e=f.bin.length-1;e>-1;e--){if(f.bin.charAt(e)=="1"){c=biMultiply(c,a);c=biMontgomeryModulo(c,g)}a=biMultiply(a,a);a=biMontgomeryModulo(a,g)}return c}function biMontgomeryModulo(c,d){var a=biModuloByRadixPower(c,d.nN);a=biMultiplyModByRadixPower(a,d.Ninv,d.nN);a=biMultiply(a,d);a=biAdd(c,a);a=biDivideByRadixPower(a,d.nN);while(biCompare(a,d)>=0){a=biSubtract(a,d)}return a}function biRSAKeyPair(c,d,a){this.e=biFromHex(c);this.d=biFromHex(d);this.m=biFromHex(a);this.chunkSize=2*biHighIndex(this.m);this.radix=16;this.m.nN=biHighIndex(this.m)+1;this.m.R=biMultiplyByRadixPower(biFromNumber(1),this.m.nN);this.m.EGCD=biExtendedEuclid(this.m.R,this.m);this.m.Ri=this.m.EGCD[0];this.m.Rinv=biModulo(this.m.EGCD[0],this.m);this.m.Ni=biMinus(this.m.EGCD[1]);this.m.Ninv=biModulo(biMinus(this.m.EGCD[1]),this.m.R);this.e.bin=biToString(this.e,2);this.d.bin=biToString(this.d,2)}biRSAKeyPair.prototype.biEncryptedString=biEncryptedString;biRSAKeyPair.prototype.biDecryptedString=biDecryptedString;function biEncryptedString(l){l=biUTF8Encode(l);l=l.replace(/[\x00]/gm,String.fromCharCode(255));l=l+String.fromCharCode(254);var a=l.length;l=l+biRandomPadding(this.chunkSize-a%this.chunkSize);var a=l.length;var m="";var f,e,d,c;c=new BigInt();for(var f=0;f<a;f+=this.chunkSize){c.blankZero();e=0;for(d=f;d<f+this.chunkSize&&d<a;++e){c.digits[e]=l.charCodeAt(d++);c.digits[e]+=(l.charCodeAt(d++)||0)<<8}var h=biMontgomeryPowMod(c,this.e,this.m);var g=biToHex(h);m+=g+","}return m.substring(0,m.length-1)}function biDecryptedString(f){var h=f.split(",");var a="";var e,d,g;for(e=0;e<h.length;++e){var c;c=biFromHex(h[e],10);g=biMontgomeryPowMod(c,this.d,this.m);for(d=0;d<=biHighIndex(g);++d){a+=String.fromCharCode(g.digits[d]&255,g.digits[d]>>8)}}a=a.replace(/\xff/gm,String.fromCharCode(0));a=a.substr(0,a.lastIndexOf(String.fromCharCode(254)));return biUTF8Decode(a)}function biUTF8Encode(e){var d="";var a=e.length;for(var g=0;g<a;g++){var f=e.charCodeAt(g);if(f<128){d+=String.fromCharCode(f)}else{if((f>127)&&(f<2048)){d+=String.fromCharCode((f>>6)|192);d+=String.fromCharCode((f&63)|128)}else{d+=String.fromCharCode((f>>12)|224);d+=String.fromCharCode(((f>>6)&63)|128);d+=String.fromCharCode((f&63)|128)}}}return d}function biUTF8Decode(f){var e="";var a=f.length;var d;for(var h=0;h<a;h++){var g=f.charCodeAt(h);if(g<128){e+=String.fromCharCode(g);d=0}else{if((g>191)&&(g<224)){d=((g&31)<<6);g=f.charCodeAt(++h);d+=(g&63);e+=String.fromCharCode(d)}else{d=((g&15)<<12);g=f.charCodeAt(++h);d+=((g&63)<<6);g=f.charCodeAt(++h);d+=(g&63);e+=String.fromCharCode(d)}}}return e}function biRandomPadding(d){var a="";for(var c=0;c<d;c++){a=a+String.fromCharCode(Math.floor(Math.random()*126)+1)}return a}var INTERMediator_DBAdapter;INTERMediator_DBAdapter={generate_authParams:function(){var c="",d,a;if(INTERMediatorOnPage.authUser.length>0){c="&clientid="+encodeURIComponent(INTERMediatorOnPage.clientId);c+="&authuser="+encodeURIComponent(INTERMediatorOnPage.authUser);if(INTERMediatorOnPage.isNativeAuth){c+="&response="+encodeURIComponent(INTERMediatorOnPage.publickey.biEncryptedString(INTERMediatorOnPage.authHashedPassword+"\n"+INTERMediatorOnPage.authChallenge))}else{if(INTERMediatorOnPage.authHashedPassword&&INTERMediatorOnPage.authChallenge){d=new jsSHA(INTERMediatorOnPage.authHashedPassword,"ASCII");a=d.getHMAC(INTERMediatorOnPage.authChallenge,"ASCII","SHA-256","HEX");c+="&response="+encodeURIComponent(a)}else{c+="&response=dummy"}}}c+="&notifyid=";c+=encodeURIComponent(INTERMediatorOnPage.clientNotificationIdentifier());c+=("&pusher="+(INTERMediator.pusherAvailable?"yes":""));return c},store_challenge:function(a){if(a!==null){INTERMediatorOnPage.authChallenge=a.substr(0,24);INTERMediatorOnPage.authUserHexSalt=a.substr(24,32);INTERMediatorOnPage.authUserSalt=String.fromCharCode(parseInt(a.substr(24,2),16),parseInt(a.substr(26,2),16),parseInt(a.substr(28,2),16),parseInt(a.substr(30,2),16))}},logging_comAction:function(a,e,d,c){INTERMediator.setDebugMessage(INTERMediatorOnPage.getMessages()[a]+"Accessing:"+decodeURI(e)+", Parameters:"+decodeURI(d+c))},logging_comResult:function(d,l,a,e,k,m,c,g,f){var h;if(INTERMediator.debugMode>1){if(d.responseText.length>1000){h=d.responseText.substr(0,1000)+" ...[trancated]"}else{h=d.responseText}INTERMediator.setDebugMessage("myRequest.responseText="+h);INTERMediator.setDebugMessage("Return: resultCount="+l+", dbresult="+INTERMediatorLib.objectToString(a)+"\nReturn: requireAuth="+e+", challenge="+k+", clientid="+m+"\nReturn: newRecordKeyValue="+c+", changePasswordResult="+g+", mediatoken="+f)}},server_access:function(k,f,g){var n="",d="",s=0,v=null,x=null,u=null,p=false,o=null,y=null,m=null,l,c,h,t,r=false,q=false,a="";l=INTERMediatorOnPage.getEntryPath();c=INTERMediator_DBAdapter.generate_authParams();INTERMediator_DBAdapter.logging_comAction(f,l,k,c);INTERMediatorOnPage.notifySupport=r;try{o=new XMLHttpRequest();o.open("POST",l,false,INTERMediatorOnPage.httpuser,INTERMediatorOnPage.httppasswd);o.setRequestHeader("charset","utf-8");o.setRequestHeader("Content-Type","application/x-www-form-urlencoded");o.setRequestHeader("X-Requested-With","XMLHttpRequest");o.send(k+c);h=JSON.parse(o.responseText);s=h.resultCount?h.resultCount:0;v=h.totalCount?h.totalCount:null;d=h.dbresult?h.dbresult:null;p=h.requireAuth?h.requireAuth:false;x=h.challenge?h.challenge:null;u=h.clientid?h.clientid:null;n=h.newRecordKeyValue?h.newRecordKeyValue:"";y=h.changePasswordResult?h.changePasswordResult:null;m=h.mediatoken?h.mediatoken:null;r=h.notifySupport;for(t=0;t<h.errorMessages.length;t++){INTERMediator.setErrorMessage(h.errorMessages[t])}for(t=0;t<h.debugMessages.length;t++){INTERMediator.setDebugMessage(h.debugMessages[t])}q=h.usenull;a=h.hasOwnProperty("registeredid")?h.registeredid:"";INTERMediator_DBAdapter.logging_comResult(o,s,d,p,x,u,n,y,m);INTERMediator_DBAdapter.store_challenge(x);if(u!==null){INTERMediatorOnPage.clientId=u}if(m!==null){INTERMediatorOnPage.mediaToken=m}}catch(w){INTERMediator.setErrorMessage(w,INTERMediatorLib.getInsertedString(INTERMediatorOnPage.getMessages()[g],[w,o.responseText]))}if(p){INTERMediator.setDebugMessage("Authentication Required, user/password panel should be show.");INTERMediatorOnPage.authHashedPassword=null;throw"_im_requath_request_"}if(!k.match(/access=challenge/)){INTERMediatorOnPage.authCount=0}INTERMediatorOnPage.storeCredencialsToCookie();INTERMediatorOnPage.notifySupport=r;return{dbresult:d,resultCount:s,totalCount:v,newRecordKeyValue:n,newPasswordResult:y,registeredId:a,nullAcceptable:q}},changePassowrd:function(k,d,g){var c,h,a;if(k&&d){INTERMediatorOnPage.authUser=k;if(k!=""&&(INTERMediatorOnPage.authChallenge===null||INTERMediatorOnPage.authChallenge.length<24)){INTERMediatorOnPage.authHashedPassword="need-hash-pls";c=INTERMediator_DBAdapter.getChallenge();if(!c){INTERMediator.flushMessage();return false}}INTERMediatorOnPage.authHashedPassword=SHA1(d+INTERMediatorOnPage.authUserSalt)+INTERMediatorOnPage.authUserHexSalt}else{INTERMediatorOnPage.retrieveAuthInfo()}h="access=changepassword&newpass="+INTERMediatorLib.generatePasswordHash(g);try{a=INTERMediator_DBAdapter.server_access(h,1029,1030);if(a.newPasswordResult&&a.newPasswordResult===true){if(INTERMediatorOnPage.isNativeAuth){INTERMediatorOnPage.authHashedPassword=INTERMediatorOnPage.publickey.biEncryptedString(g)}else{INTERMediatorOnPage.authHashedPassword=SHA1(g+INTERMediatorOnPage.authUserSalt)+INTERMediatorOnPage.authUserHexSalt}INTERMediatorOnPage.storeCredencialsToCookie()}}catch(f){return false}return(a.newPasswordResult&&a.newPasswordResult===true)},getChallenge:function(){try{this.server_access("access=challenge",1027,1028)}catch(a){if(a=="_im_requath_request_"){throw a}else{INTERMediator.setErrorMessage(a,"EXCEPTION-19")}}if(INTERMediatorOnPage.authChallenge===null){return false}return true},uploadFile:function(d,o,n){var l="",c="",s=0,x=null,u=null,q=false,p=null,y=null,k=null,h,a,g,f,t;h=INTERMediatorOnPage.getEntryPath();a=INTERMediator_DBAdapter.generate_authParams();g="access=uploadfile"+d;INTERMediator_DBAdapter.logging_comAction(1031,h,g,a);try{p=new XMLHttpRequest();p.open("POST",h,true,INTERMediatorOnPage.httpuser,INTERMediatorOnPage.httppasswd);p.setRequestHeader("charset","utf-8");var w=(g+a).split("&");var m=new FormData();for(var t=0;t<w.length;t++){var r=w[t].split("=");m.append(r[0],decodeURIComponent(r[1]))}m.append("_im_uploadfile",o.content);p.onreadystatechange=function(){switch(p.readyState){case 3:break;case 4:f=JSON.parse(p.responseText);s=f.resultCount?f.resultCount:0;c=f.dbresult?f.dbresult:null;q=f.requireAuth?f.requireAuth:false;x=f.challenge?f.challenge:null;u=f.clientid?f.clientid:null;l=f.newRecordKeyValue?f.newRecordKeyValue:"";y=f.changePasswordResult?f.changePasswordResult:null;k=f.mediatoken?f.mediatoken:null;for(t=0;t<f.errorMessages.length;t++){INTERMediator.setErrorMessage(f.errorMessages[t])}for(t=0;t<f.debugMessages.length;t++){INTERMediator.setDebugMessage(f.debugMessages[t])}INTERMediator_DBAdapter.logging_comResult(p,s,c,q,x,u,l,y,k);INTERMediator_DBAdapter.store_challenge(x);if(u!==null){INTERMediatorOnPage.clientId=u}if(k!==null){INTERMediatorOnPage.mediaToken=k}if(q){INTERMediator.setDebugMessage("Authentication Required, user/password panel should be show.");INTERMediatorOnPage.authHashedPassword=null;throw"_im_requath_request_"}INTERMediatorOnPage.authCount=0;INTERMediatorOnPage.storeCredencialsToCookie();n(c);break}};p.send(m)}catch(v){INTERMediator.setErrorMessage(v,INTERMediatorLib.getInsertedString(INTERMediatorOnPage.getMessages()[1032],[v,p.responseText]))}},db_query:function(d){var a=true,s,h,v,m,x,l,g,w,o,f,c,r=10000000;if(d.name===null||d.name===""){INTERMediator.setErrorMessage(INTERMediatorLib.getInsertedStringFromErrorNumber(1005));a=false}if(!a){return}if(d.records==null){v="access=select&name="+encodeURIComponent(d.name)}else{if(Number(d.records)===0){v="access=describe&name="+encodeURIComponent(d.name)}else{v="access=select&name="+encodeURIComponent(d.name)}if(d.uselimit===true&&Number(d.records)>=INTERMediator.pagedSize&&Number(INTERMediator.pagedSize)>0){r=INTERMediator.pagedSize}else{r=d.records}}if(d.primaryKeyOnly){v+="&pkeyonly=true"}if(d.fields){for(s=0;s<d.fields.length;s++){v+="&field_"+s+"="+encodeURIComponent(d.fields[s])}}m=0;if(d.parentkeyvalue){for(h in d.parentkeyvalue){if(d.parentkeyvalue.hasOwnProperty(h)){v+="&foreign"+m+"field="+encodeURIComponent(h);v+="&foreign"+m+"value="+encodeURIComponent(d.parentkeyvalue[h]);m++}}}if(d.useoffset&&INTERMediator.startFrom!=null){v+="&start="+encodeURIComponent(INTERMediator.startFrom)}x=0;while(d.conditions&&d.conditions[x]){v+="&condition"+x;v+="field="+encodeURIComponent(d.conditions[x]["field"]);v+="&condition"+x;v+="operator="+encodeURIComponent(d.conditions[x]["operator"]);v+="&condition"+x;v+="value="+encodeURIComponent(d.conditions[x]["value"]);x++}l=INTERMediator.additionalCondition[d.name];if(l){if(l.field){l=[l]}for(h=0;h<l.length;h++){if(l[h]&&l[h]["field"]){if(l[h]["value"]||l[h]["field"]=="__operation__"){v+="&condition"+x;v+="field="+encodeURIComponent(l[h]["field"]);if(l[h]["operator"]!==undefined){v+="&condition"+x;v+="operator="+encodeURIComponent(l[h]["operator"])}if(l[h]["value"]!==undefined){v+="&condition"+x;v+="value="+encodeURIComponent(l[h]["value"])}x++}}}}c=0;g=INTERMediator.additionalSortKey[d.name];if(g){if(g.field){g=[g]}for(h=0;h<g.length;h++){v+="&sortkey"+c;v+="field="+encodeURIComponent(g[h]["field"]);v+="&sortkey"+c;v+="direction="+encodeURIComponent(g[h]["direction"]);c++}}var e={};for(var y in IMLibLocalContext.store){var q=new String(IMLibLocalContext.store[y]);var u=y.split(":");if(u&&u.length>1&&u[1].trim()==d.name&&q.length>0){if(u[0].trim()=="condition"&&u.length>=4){var p=u[2].split(",");var k=u[3].trim();if(p.length>1){v+="&condition"+x+"field=__operation__";v+="&condition"+x+"operator=ex";x++}for(var h=0;h<p.length;h++){v+="&condition"+x+"field="+encodeURIComponent(p[h].trim());v+="&condition"+x+"operator="+encodeURIComponent(k);v+="&condition"+x+"value="+encodeURIComponent(q);x++}}else{if(u[0].trim()=="valueofaddorder"&&u.length>=4){e[parseInt(q)]=[u[2].trim(),u[3].trim()]}else{if(u[0].trim()=="limitnumber"&&u.length>=4){r=parseInt(q)}}}}}v+="&records="+encodeURIComponent(r);var n=Object.keys(e);for(var s=0;s<n.length;s++){v+="&sortkey"+c+"field="+encodeURIComponent(e[n[s]][0]);v+="&sortkey"+c+"direction="+encodeURIComponent(e[n[s]][1]);c++}w={};try{o=this.server_access(v,1012,1004);w.recordset=o.dbresult;w.totalCount=o.resultCount;w.count=0;w.registeredId=o.registeredId;w.nullAcceptable=o.nullAcceptable;for(f in o.dbresult){w.count++}if((d.paging!=null)&&(d.paging==true)){if(!(Number(d.records)>=Number(INTERMediator.pagedSize)&&Number(INTERMediator.pagedSize)>0)){INTERMediator.pagedSize=Number(d.records)}INTERMediator.pagedAllCount=Number(o.resultCount);if(o.totalCount){INTERMediator.totalRecordCount=parseInt(o.totalCount,10)}}}catch(t){if(t=="_im_requath_request_"){throw t}else{INTERMediator.setErrorMessage(t,"EXCEPTION-17")}w.recordset=null;w.totalCount=0;w.count=0;w.registeredid=null;w.nullAcceptable=null}return w},db_queryWithAuth:function(c,a){var e=false;INTERMediatorOnPage.retrieveAuthInfo();try{e=INTERMediator_DBAdapter.db_query(c)}catch(d){if(d=="_im_requath_request_"){if(INTERMediatorOnPage.requireAuthentication){if(!INTERMediatorOnPage.isComplementAuthData()){INTERMediatorOnPage.authChallenge=null;INTERMediatorOnPage.authHashedPassword=null;INTERMediatorOnPage.authenticating(function(){e=INTERMediator_DBAdapter.db_queryWithAuth(arg,a)});return}}}else{INTERMediator.setErrorMessage(d,"EXCEPTION-16")}}a(e)},db_update:function(h){var c=true,e,k,l,a,g,f;if(h.name===null){INTERMediator.setErrorMessage(INTERMediatorLib.getInsertedStringFromErrorNumber(1007));c=false}if(h.dataset===null){INTERMediator.setErrorMessage(INTERMediatorLib.getInsertedStringFromErrorNumber(1011));c=false}if(!c){return}e="access=update&name="+encodeURIComponent(h.name);a=0;if(INTERMediator.additionalFieldValueOnUpdate&&INTERMediator.additionalFieldValueOnUpdate[h.name]){f=INTERMediator.additionalFieldValueOnUpdate[h.name];if(f.field){f=[f]}for(g in f){var d=f[g];e+="&field_"+a+"="+encodeURIComponent(d.field);e+="&value_"+a+"="+encodeURIComponent(d.value);a++}}if(h.conditions!=null){for(k=0;k<h.conditions.length;k++){e+="&condition"+k+"field=";e+=encodeURIComponent(h.conditions[k]["field"]);e+="&condition"+k+"operator=";e+=encodeURIComponent(h.conditions[k]["operator"]);if(h.conditions[k]["value"]){e+="&condition"+k+"value=";e+=encodeURIComponent(h.conditions[k]["value"])}}}for(k=0;k<h.dataset.length;k++){e+="&field_"+(a+k)+"="+encodeURIComponent(h.dataset[k]["field"]);if(INTERMediator.isTrident&&INTERMediator.ieVersion==8){e+="&value_"+(a+k)+"="+encodeURIComponent(h.dataset[k]["value"].replace(/\n/g,""))}else{e+="&value_"+(a+k)+"="+encodeURIComponent(h.dataset[k]["value"])}}l=this.server_access(e,1013,1014);return l.dbresult},db_updateWithAuth:function(c,a){var e=false;INTERMediatorOnPage.retrieveAuthInfo();try{e=INTERMediator_DBAdapter.db_update(c)}catch(d){if(d=="_im_requath_request_"){if(INTERMediatorOnPage.requireAuthentication){if(!INTERMediatorOnPage.isComplementAuthData()){INTERMediatorOnPage.authChallenge=null;INTERMediatorOnPage.authHashedPassword=null;INTERMediatorOnPage.authenticating(function(){e=INTERMediator_DBAdapter.db_updateWithAuth(arg,a)});return}}}else{INTERMediator.setErrorMessage(d,"EXCEPTION-15")}}a(e)},db_delete:function(k){var c=true,e,f,l,a,h,g;if(k.name===null){INTERMediator.setErrorMessage(INTERMediatorLib.getInsertedStringFromErrorNumber(1019));c=false}if(k.conditions===null){INTERMediator.setErrorMessage(INTERMediatorLib.getInsertedStringFromErrorNumber(1020));c=false}if(!c){return}e="access=delete&name="+encodeURIComponent(k.name);a=0;if(INTERMediator.additionalFieldValueOnDelete&&INTERMediator.additionalFieldValueOnDelete[k.name]){g=INTERMediator.additionalFieldValueOnDelete[k.name];if(g.field){g=[g]}for(h in g){var d=g[h];e+="&field_"+a+"="+encodeURIComponent(d.field);e+="&value_"+a+"="+encodeURIComponent(d.value);a++}}for(f=0;f<k.conditions.length;f++){e+="&condition"+f+"field="+encodeURIComponent(k.conditions[f]["field"]);e+="&condition"+f+"operator="+encodeURIComponent(k.conditions[f]["operator"]);e+="&condition"+f+"value="+encodeURIComponent(k.conditions[f]["value"])}l=this.server_access(e,1017,1015);INTERMediator.flushMessage();return l},db_deleteWithAuth:function(c,a){var e=false;INTERMediatorOnPage.retrieveAuthInfo();try{e=INTERMediator_DBAdapter.db_delete(c)}catch(d){if(d=="_im_requath_request_"){if(INTERMediatorOnPage.requireAuthentication){if(!INTERMediatorOnPage.isComplementAuthData()){INTERMediatorOnPage.authChallenge=null;INTERMediatorOnPage.authHashedPassword=null;INTERMediatorOnPage.authenticating(function(){e=INTERMediator_DBAdapter.db_deleteWithAuth(arg,a)});return}}}else{INTERMediator.setErrorMessage(d,"EXCEPTION-14")}}a(e)},db_createRecord:function(l){var f,g,n,k,h,a,c,e,m;if(l.name===null){INTERMediator.setErrorMessage(INTERMediatorLib.getInsertedStringFromErrorNumber(1021));return}e=INTERMediatorOnPage.getDataSources();c=null;for(m in e){if(e[m]["name"]==l.name){c=m;break}}if(c===null){alert("no targetname :"+l.name);return}f="access=new&name="+encodeURIComponent(l.name);a=0;if(INTERMediator.additionalFieldValueOnNewRecord&&INTERMediator.additionalFieldValueOnNewRecord[l.name]){h=INTERMediator.additionalFieldValueOnNewRecord[l.name];if(h.field){h=[h]}for(k in h){var d=h[k];f+="&field_"+a+"="+encodeURIComponent(d.field);f+="&value_"+a+"="+encodeURIComponent(d.value);a++}}for(g=0;g<l.dataset.length;g++){f+="&field_"+a+"="+encodeURIComponent(l.dataset[g]["field"]);f+="&value_"+a+"="+encodeURIComponent(l.dataset[g]["value"]);a++}n=this.server_access(f,1018,1016);INTERMediator.flushMessage();return{newKeyValue:n.newRecordKeyValue,recordset:n.dbresult}},db_createRecordWithAuth:function(c,a){var e=false;INTERMediatorOnPage.retrieveAuthInfo();try{e=INTERMediator_DBAdapter.db_createRecord(c)}catch(d){if(d=="_im_requath_request_"){if(INTERMediatorOnPage.requireAuthentication){if(!INTERMediatorOnPage.isComplementAuthData()){INTERMediatorOnPage.authChallenge=null;INTERMediatorOnPage.authHashedPassword=null;INTERMediatorOnPage.authenticating(function(){e=INTERMediator_DBAdapter.db_createRecordWithAuth(arg,a)});return}}}else{INTERMediator.setErrorMessage(d,"EXCEPTION-13")}}if(a){a(e.newKeyValue)}},unregister:function(c){var a=null,d;if(INTERMediatorOnPage.clientNotificationKey){var e=INTERMediatorOnPage.clientNotificationKey();if(e&&e!="_im_key_isnt_supplied"){d="access=unregister";if(c){d+="&pks="+encodeURIComponent(JSON.stringify(c))}a=this.server_access(d,1018,1016);return a}}}};var Parser=(function(aJ){var ai=0;var ad=1;var ac=2;var ab=5;var aO=65;var aj=3;var E=4;ap.regFirstVarChar=new RegExp("[\u00A0-\u1FFF\u2C00-\uDFFFa-zA-Z@_]");ap.regRestVarChar=new RegExp("[\u00A0-\u1FFF\u2C00-\uDFFFa-zA-Z@_0-9]");function aL(bd,bf,be,bg){this.type_=bd;this.index_=bf||0;this.prio_=be||0;this.number_=(bg!==undefined&&bg!==null)?bg:0;this.toString=function(){switch(this.type_){case ai:return this.number_;case ad:case ac:case ab:case aj:return this.index_;case E:return"CALL";case aO:return"SEPARATOR";default:return"Invalid Token"}}}function aT(bh,bf,be,bg,bd,bi){this.tokens=bh}var aP=/[\\\'\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;var S={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r","'":"\\'","\\":"\\\\"};function ag(bd){if(typeof bd==="string"){aP.lastIndex=0;return aP.test(bd)?"'"+bd.replace(aP,function(be){var bf=S[be];return typeof bf==="string"?bf:"\\u"+("0000"+be.charCodeAt(0).toString(16)).slice(-4)})+"'":"'"+bd+"'"}return bd}aT.prototype={simplify:function(bm){bm=bm||{};var bg=[];var bf=[];var bk;var bj;var bh;var bi;var bl=this.tokens.length;var bn;var be=0;for(be=0;be<bl;be++){bn=this.tokens[be];var bd=bn.type_;if(bd===ai){bg.push(bn)}else{if(bd===aj&&(bn.index_ in bm)){bn=new aL(ai,0,0,bm[bn.index_]);bg.push(bn)}else{if(bd===ab&&bg.length>2){bh=bg.pop();bj=bg.pop();bk=bg.pop();bi=ap.ops3[bn.index_];bn=new aL(ai,0,0,bi(bk.number_,bj.number_,bh.number_));bg.push(bn)}else{if(bd===ac&&bg.length>1){bj=bg.pop();bk=bg.pop();bi=ap.ops2[bn.index_];bn=new aL(ai,0,0,bi(bk.number_,bj.number_));bg.push(bn)}else{if(bd===ad&&bg.length>0){bk=bg.pop();bi=ap.ops1[bn.index_];bn=new aL(ai,0,0,bi(bk.number_));bg.push(bn)}else{while(bg.length>0){bf.push(bg.shift())}bf.push(bn)}}}}}}while(bg.length>0){bf.push(bg.shift())}return new aT(bf)},substitute:function(be,bm){if(!(bm instanceof aT)){bm=new ap().parse(String(bm))}var bj=[];var bl=this.tokens.length;var bn;var bg=0;for(bg=0;bg<bl;bg++){bn=this.tokens[bg];var bh=bn.type_;if(bh===aj&&bn.index_===be){for(var bf=0;bf<bm.tokens.length;bf++){var bi=bm.tokens[bf];var bd=new aL(bi.type_,bi.index_,bi.prio_,bi.number_);bj.push(bd)}}else{bj.push(bn)}}var bk=new aT(bj);return bk},evaluate:function(bl){bl=bl||{};var bf=[];var bj;var bi;var bg;var bh;var bk=this.tokens.length;var bm;var be=0;for(be=0;be<bk;be++){bm=this.tokens[be];var bd=bm.type_;if(bd===ai){bf.push(bm.number_)}else{if(bd===ab){bg=bf.pop();bi=bf.pop();bj=bf.pop();bh=ap.ops3Trail[bm.index_];bf.push(bh(bj,bi,bg))}else{if(bd===ac){bi=bf.pop();bj=bf.pop();bh=ap.ops2[bm.index_];bf.push(bh(bj,bi))}else{if(bd===aj){if(bm.index_ in bl){bf.push(bl[bm.index_])}else{if(bm.index_ in ap.functions){bf.push(ap.functions[bm.index_])}else{throw new Error("undefined variable: "+bm.index_)}}}else{if(bd===ad){bj=bf.pop();bh=ap.ops1[bm.index_];bf.push(bh(bj))}else{if(bd===aO){bi=bf.pop();bj=bf.pop();bf.push([bj,bi])}else{if(bd===E){bj=bf.pop();bh=bf.pop();if(bh.apply&&bh.call){if(Object.prototype.toString.call(bj)=="[object Array]"){bf.push(bh.apply(undefined,bj))}else{bf.push(bh.call(undefined,bj))}}else{throw new Error(bh+" is not a function")}}else{throw new Error("invalid Expression")}}}}}}}}if(bf.length>1){throw new Error("invalid Expression (parity)")}return bf[0]},variables:function(){var bd=this.tokens.length;var bg=[];for(var be=0;be<bd;be++){var bf=this.tokens[be];if(bf.type_===aj&&(bg.indexOf(bf.index_)==-1)&&!(bf.index_ in ap.functions)){bg.push(bf.index_)}}return bg}};function ax(bf,bd,bi){var bh,bg,be;bh=(bf instanceof Array)?arguments[0].join():arguments[0];bg=(bd instanceof Array)?arguments[1].join():arguments[1];be=(bd instanceof Array)?arguments[2].join():arguments[2];return bh?bg:be}function av(be,bd){var bh,bf,bi,bg;bh=(be instanceof Array)?be.join():be;bf=(bd instanceof Array)?bd.join():bd;bi=z(bh);bg=z(bf);if(!isNaN(bi)&&!isNaN(bi)){return Number(bi)>Number(bg)}return be>bd}function s(be,bd){var bh,bf,bi,bg;bh=(be instanceof Array)?be.join():be;bf=(bd instanceof Array)?bd.join():bd;bi=z(bh);bg=z(bf);if(!isNaN(bi)&&!isNaN(bi)){return Number(bi)<Number(bg)}return be<bd}function Q(be,bd){var bh,bf,bi,bg;bh=(be instanceof Array)?be.join():be;bf=(bd instanceof Array)?bd.join():bd;bi=z(bh);bg=z(bf);if(!isNaN(bi)&&!isNaN(bi)){return Number(bi)>=Number(bg)}return be>=bd}function h(be,bd){var bh,bf,bi,bg;bh=(be instanceof Array)?be.join():be;bf=(bd instanceof Array)?bd.join():bd;bi=z(bh);bg=z(bf);if(!isNaN(bi)&&!isNaN(bi)){return Number(bi)<=Number(bg)}return be<=bd}function a3(be,bd){var bh,bf,bi,bg;bh=(be instanceof Array)?be.join():be;bf=(bd instanceof Array)?bd.join():bd;bi=z(bh);bg=z(bf);if(!isNaN(bi)&&!isNaN(bi)){return Number(bi)==Number(bg)}return be==bd}function aw(be,bd){var bh,bf,bi,bg;bh=(be instanceof Array)?be.join():be;bf=(bd instanceof Array)?bd.join():bd;bi=z(bh);bg=z(bf);if(!isNaN(bi)&&!isNaN(bi)){return Number(bi)!=Number(bg)}return be!=bd}function aq(bd){return bd!==bd}function A(be,bd){var bh,bf,bi,bg;if(aq(be)||aq(bd)){return NaN}bh=(be instanceof Array)?be.join():be;bf=(bd instanceof Array)?bd.join():bd;bi=z(bh);bg=z(bf);if(!isNaN(bi)&&!isNaN(bg)){return Number(bi)+Number(bg)}return bh+bf}function aX(be,bd){var bh,bf,bi,bg,bj,bk;if(aq(be)||aq(bd)){return NaN}bh=(be instanceof Array)?be.join():be;bf=(bd instanceof Array)?bd.join():bd;bi=z(bh);bg=z(bf);if(!isNaN(bi)&&!isNaN(bg)){return bi-bg}bj=bh;do{bk=bj.indexOf(bf);if(bk>-1){bj=bj.substr(0,bk)+bj.substr(bk+bf.length)}}while(bk>-1);return bj}function c(be,bd){if(aq(be)||aq(bd)){return NaN}be=z(be);bd=z(bd);return be*bd}function y(be,bd){if(aq(be)||aq(bd)){return NaN}be=z(be);bd=z(bd);return be/bd}function d(be,bd){if(aq(be)||aq(bd)){return NaN}be=z(be);bd=z(bd);return be%bd}function ay(bd){if(aq(bd)){return NaN}bd=z(bd);return -bd}function aB(bd){bd=z(bd);return Math.random()*(bd||1)}function am(be){if(aq(be)){return NaN}be=z(be);be=Math.floor(be);var bd=be;while(be>1){bd=bd*(--be)}return bd}function P(bd){bd=(bd instanceof Array)?bd.join():bd;b=(b instanceof Array)?b.join():b;return !bd}function bc(be,bd){be=(be instanceof Array)?be.join():be;bd=(bd instanceof Array)?bd.join():bd;return be&&bd}function J(be,bd){be=(be instanceof Array)?be.join():be;bd=(bd instanceof Array)?bd.join():bd;return be||bd}function aM(bf,be,bj,bi,bh){var bd=0,bg;for(bg=0;bg<arguments.length;bg++){bd+=z(arguments[bg])}return bd}function ao(bf,be,bk,bj,bi){var bd=0,bg,bh=0;for(bg=0;bg<arguments.length;bg++){bd+=z(arguments[bg]);bh++}return bd/bh}function R(be,bd){if(bd==undefined){return Math.round(be)}else{be=(be instanceof Array)?be.join():be;bd=(bd instanceof Array)?bd.join():bd;return INTERMediatorLib.Round(be,bd)}}function m(bd){if(bd==undefined||bd==null){return 0}else{bd=(bd instanceof Array)?bd.join():bd;return(new String(bd)).length}}ap.regExDigitSeparator=new RegExp(INTERMediatorLib.digitSeparator()[1]);function z(be){var bd;if(be===undefined){return NaN}if(be==""){return 0}if(be.replace){bd=be.replace(ap.regExDigitSeparator,"")}else{bd=be}bd=parseFloat(bd);if(isNaN(bd)){return NaN}return bd}function F(be,bd){return Math.sqrt(be*be+bd*bd)}function W(be,bd){if(Object.prototype.toString.call(be)!="[object Array]"){return[be,bd]}be=be.slice();be.push(bd);return be}function au(bf,be){var bh,bg,bi,bd="";bh=(bf instanceof Array)?bf.join():bf;bg=(be instanceof Array)?be.join():be;for(bi=0;bi<bh.length;bi++){if(bg.indexOf(bh.substr(bi,1))>-1){bd+=bh.substr(bi,1)}}return bd}function r(bf,be){var bh,bg,bi,bd="";bh=(bf instanceof Array)?bf.join():bf;bg=(be instanceof Array)?be.join():be;for(bi=0;bi<bg.length;bi++){if(bh.indexOf(bg.substr(bi,1))<0){bd+=bg.substr(bi,1)}}return bh+bd}function al(bf,be){var bh,bg,bi,bd="";bh=(bf instanceof Array)?bf.join():bf;bg=(be instanceof Array)?be.join():be;for(bi=0;bi<bh.length;bi++){if(bg.indexOf(bh.substr(bi,1))<0){bd+=bh.substr(bi,1)}}return bd}function aF(bj,bi){var bf,be,bl,bk,bh,bg,bd="\n";bf=(bj instanceof Array)?bj.join():bj;bg=[bf.indexOf("\r\n"),bf.indexOf("\r"),bf.indexOf("\n")];for(bh=0;bh<bg.length;bh++){bg[bh]=(bg[bh]<0)?bf.length:bg[bh]}if(bg[0]<bf.length&&bg[0]<=bg[1]&&bg[0]<bg[2]){bd="\r\n"}else{if(bg[1]<bf.length&&bg[1]<bg[0]&&bg[1]<bg[2]){bd="\r"}}bl=bf.replace("\r\n","\n").replace("\r","\n").split("\n");be=(bi instanceof Array)?bi.join():bi;bk=be.replace("\r\n","\n").replace("\r","\n").split("\n");return[bl,bk,bd]}function l(bg,be){var bk,bi,bh,bf,bj,bd="";bk=aF(bg,be);bi=bk[0];bh=bk[1];bf=bk[2];for(bj=0;bj<bi.length;bj++){if(bh.indexOf(bi[bj])>-1&&bi[bj].length>0){bd+=bi[bj]+bf}}return bd}function bb(bg,be){var bk,bi,bh,bf,bj,bd="";bk=aF(bg,be);bi=bk[0];bh=bk[1];bf=bk[2];for(bj=0;bj<bi.length;bj++){if(bi[bj].length>0){bd+=bi[bj]+bf}}for(bj=0;bj<bh.length;bj++){if(bi.indexOf(bh[bj])<0&&bh[bj].length>0){bd+=bh[bj]+bf}}return bd}function aa(bg,be){var bk,bi,bh,bf,bj,bd="";bk=aF(bg,be);bi=bk[0];bh=bk[1];bf=bk[2];for(bj=0;bj<bi.length;bj++){if(bh.indexOf(bi[bj])<0&&bi[bj].length>0){bd+=bi[bj]+bf}}return bd}function aK(bg,bk,bf){var bj,bh,be,bi,bd="";bj=aF(bg,"");bh=bj[0];be=bj[2];bf=(bf==undefined)?bh.length:bf;for(bi=bk;(bi<bk+bf)&&(bi<bh.length);bi++){bd+=bh[bi]+be}return bd}function q(bf,bg){var be,bd;be=(bf instanceof Array)?bf.join():bf;bd=(bg instanceof Array)?bg.join():bg;return INTERMediatorLib.numberFormat(be,bd)}function Z(bh,bi,bd){var bf,bg,be;bf=(bh instanceof Array)?bh.join():bh;bg=(bi instanceof Array)?bi.join():bi;be=(bd instanceof Array)?bd.join():bd;return bf.substr(bg,be)}function T(bh,bi,bd){var be,bf,bg;be=(bh instanceof Array)?bh.join():bh;bf=(bi instanceof Array)?bi.join():bi;bg=(bd instanceof Array)?bd.join():bd;return be.substring(bf,bg)}function a5(bg,be){var bd,bf;bd=(bg instanceof Array)?bg.join():bg;bf=(be instanceof Array)?be.join():be;return bd.indexOf(bf)}function ae(bj,bk,bd,bh){var be,bf,bi,bg;be=(bj instanceof Array)?bj.join():bj;bf=(bk instanceof Array)?bk.join():bk;bi=(bd instanceof Array)?bd.join():bd;bg=(bh instanceof Array)?bh.join():bh;return be.substr(0,bf)+bg+be.substr(bi)}function x(bj,be,bi){var bd,bg,bh,bf;bd=(bj instanceof Array)?bj.join():bj;bg=(be instanceof Array)?be.join():be;bh=(bi instanceof Array)?bi.join():bi;bf=new RegExp(bg,"g");return bd.replace(bf,bh)}ap.timeOffset=(new Date()).getTimezoneOffset();function a(be){var bd;if(be===undefined){bd=Date.now()}else{bd=Date.parse(be.replace(/-/g,"/"));bd-=ap.timeOffset*60000}return parseInt(bd/86400000)}function aU(be){var bd;if(be===undefined){bd=Date.now()}else{bd=Date.parse(be.replace(/-/g,"/"))}return parseInt(bd/1000)}function ba(bd){if(parseInt(bd).length==bd.length){return bd}else{return a(bd)}}function aE(bd){if(parseInt(bd).length==bd.length){return bd}else{return aU(bd)}}function o(bg,bd,bf){var be=[];be.push(aN(bg));be.push(a0(bg));be.push(Y(bg));be[bf]+=bd;return az(be[0],be[1],be[2])}function aI(bg,bd,bf){var be=[];be.push(a8(bg));be.push(g(bg));be.push(e(bg));be.push(a4(bg));be.push(H(bg));be.push(f(bg));be[bf]+=bd;return aV(be[0],be[1],be[2],be[3],be[4],be[5])}function az(bh,bd,bg){var be=bd-1;if(be<0||be>11){bh+=parseInt(be/12);bd=be%12+1}var bf=parseInt(Date.UTC(bh,bd-1,bg,0,0,0)/86400000);return bf}function aV(bk,bd,bj,bh,bf,bg){if(bg<0||bg>59){bf+=parseInt(bg/60);bg=bg%60}if(bf<0||bf>59){bh+=parseInt(bf/60);bf=bf%60}if(bh<0||bh>23){bj+=parseInt(bh/24);bh=bh%24}var be=bd-1;if(be<0||be>11){bk+=parseInt(be/12);bd=be%12+1}var bi=Date.UTC(bk,bd-1,bj,bh,bf,bg)/1000;return bi}function aD(bd){return INTERMediator.dateTimeFunction?a8(bd):aN(bd)}function a6(bd){return INTERMediator.dateTimeFunction?g(bd):a0(bd)}function L(bd){return INTERMediator.dateTimeFunction?e(bd):Y(bd)}function aA(bd){return INTERMediator.dateTimeFunction?at(bd):an(bd)}function ah(bd){return INTERMediator.dateTimeFunction?a4(bd):0}function M(bd){return INTERMediator.dateTimeFunction?H(bd):0}function X(bd){return INTERMediator.dateTimeFunction?f(bd):0}function aN(bd){return new Date(ba(bd)*86400000).getFullYear()}function a0(bd){return new Date(ba(bd)*86400000).getMonth()+1}function Y(bd){return new Date(ba(bd)*86400000).getDate()}function an(bd){return new Date(ba(bd)*86400000).getDay()}function a8(bd){return new Date(aE(bd)*1000).getFullYear()}function g(bd){return new Date(aE(bd)*1000).getMonth()+1}function e(bd){return new Date(aE(bd)*1000).getDate()}function at(bd){return new Date(aE(bd)*1000).getDay()}function a4(bd){return new Date(aE(bd)*1000).getHours()}function H(bd){return new Date(aE(bd)*1000).getMinutes()}function f(bd){return new Date(aE(bd)*1000).getSeconds()}function p(be,bd){return INTERMediator.dateTimeFunction?G(be,bd):aQ(be,bd)}function ar(be,bd){return INTERMediator.dateTimeFunction?a1(be,bd):v(be,bd)}function V(be,bd){return INTERMediator.dateTimeFunction?k(be,bd):aW(be,bd)}function n(be,bd){return INTERMediator.dateTimeFunction?C(be,bd):NaN}function O(be,bd){return INTERMediator.dateTimeFunction?U(be,bd):NaN}function aZ(be,bd){return INTERMediator.dateTimeFunction?t(be,bd):NaN}function aQ(be,bd){return o(be,bd,0)}function v(be,bd){return o(be,bd,1)}function aW(be,bd){return o(be,bd,2)}function G(be,bd){return aI(be,bd,0)}function a1(be,bd){return aI(be,bd,1)}function k(be,bd){return aI(be,bd,2)}function C(be,bd){return aI(be,bd,3)}function U(be,bd){return aI(be,bd,4)}function t(be,bd){return aI(be,bd,5)}function K(bd){return INTERMediator.dateTimeFunction?w(bd):af(bd)}function af(bd){return aW(v(aS(bd),1),-1)}function w(bd){return t(a1(aY(bd),1),-1)}function aR(bd){return INTERMediator.dateTimeFunction?aY(bd):aS(bd)}function aS(bf){var be=aN(bf)+"/"+("0"+a0(bf)).substr(-2,2)+"/01";var bd=a(be);return bd}function aY(bd){var be=a8(bd)+"/"+("0"+g(bd)).substr(-2,2)+"/01 00:00:00";console.log(be);return aU(be)}function ak(){return parseInt(Date.now()/86400)}function N(){return parseInt(Date.now()/1000)}function D(bg){var bd,bf,be,bh;bd=String(bg);bf="";for(be=0;be<bd.length;be++){bh=bd.substr(be,1);if(bh>="0"&&bh<="9"){bf+=bh}else{if(bh>=""&&bh<=""){bf+=bh}else{if(bh>=""||bh=="."){bf+="."}}}}return parseFloat(bd)}function ap(){this.success=false;this.errormsg="";this.expression="";this.pos=0;this.tokennumber=0;this.tokenprio=0;this.tokenindex=0;this.tmpprio=0;ap.functions={random:aB,fac:am,min:Math.min,max:Math.max,pyt:F,pow:Math.pow,atan2:Math.atan2,"if":ax,sum:aM,average:ao,format:q,substr:Z,substring:T,indexof:a5,replace:ae,substitute:x,sin:Math.sin,cos:Math.cos,tan:Math.tan,asin:Math.asin,acos:Math.acos,atan:Math.atan,sqrt:Math.sqrt,log:Math.log,abs:Math.abs,ceil:Math.ceil,floor:Math.floor,round:R,exp:Math.exp,items:aK,length:m,datetime:aU,date:a,datecomponents:az,datetimecomponents:aV,year:aD,month:a6,day:L,weekday:aA,hour:ah,minute:M,second:X,yeard:aN,monthd:a0,dayd:Y,weekdayd:an,yeardt:a8,monthdt:g,daydt:e,weekdaydt:at,hourdt:a4,minutedt:H,seconddt:f,addyear:p,addmonth:ar,addday:V,addhour:n,addminute:O,addsecond:aZ,addyeard:aQ,addmonthd:v,adddayd:aW,addyeardt:G,addmonthdt:a1,adddaydt:k,addhourdt:C,addminutedt:U,addseconddt:t,endofmonth:K,startofmonth:aR,endofmonthd:af,startofmonthd:aS,endofmonthdt:w,startofmonthdt:aY,today:ak,now:N};this.consts={E:Math.E,PI:Math.PI};ap.operators={"!":[1,P,2],"+":[2,A,4],"-":[2,aX,4],"*":[2,c,3],"/":[2,y,3],"%":[2,d,3],"^":[2,Math.pow,1],",":[2,W,15],">":[2,av,6],"<":[2,s,6],">=":[2,Q,6],"<=":[2,h,6],"==":[2,a3,7],"=":[2,a3,7],"!=":[2,aw,7],"<>":[2,aw,7],"&&":[2,bc,11],"||":[2,J,12],"":[2,au,3],"":[2,r,4],"":[2,al,4],"":[2,l,3],"":[2,bb,4],"":[2,aa,4],"?":[2,ax,13],":":[4,ax,13]};ap.ops1={"-":ay};ap.ops2={};ap.ops3={};ap.ops3Trail={};for(var bd in ap.operators){switch(ap.operators[bd][0]){case 1:ap.ops1[bd]=ap.operators[bd][1];break;case 2:ap.ops2[bd]=ap.operators[bd][1];break;case 3:ap.ops3[bd]=ap.operators[bd][1];break;case 4:ap.ops3Trail[bd]=ap.operators[bd][1];break}}}ap.parse=function(bd){return new ap().parse(bd)};ap.evaluate=function(bd,be){return ap.parse(bd).evaluate(be)};ap.Expression=aT;var a2=1<<0;var aG=1<<1;var aC=1<<2;var I=1<<3;var B=1<<4;var u=1<<5;var a7=1<<6;var a9=1<<7;var aH=1<<8;ap.prototype={parse:function(bl){this.errormsg="";this.success=true;var bf=[];var bn=[];this.tmpprio=0;var bh=(a2|I|aC|a7);var bi=0;this.expression=bl;this.pos=0;var bk=[];while(this.pos<this.expression.length){if(this.isOperator()){if(this.isSign()&&(bh&a7)){if(this.isNegativeSign()){this.tokenprio=2;this.tokenindex="-";bi++;this.addfunc(bn,bf,ad)}bh=(a2|I|aC|a7)}else{if(this.isComment()){}else{if((bh&aG)===0){this.error_parsing(this.pos,"unexpected operator")}if(this.tokenindex=="?"){this.tmpprio-=40;this.tokenindex="if";this.addfunc(bn,bf,ac);this.tmpprio+=40;this.tokenindex=",";bi+=3;this.addfunc(bn,bf,ac)}else{if(this.tokenindex==":"){this.tokenindex=",";bi+=2;this.addfunc(bn,bf,ac)}else{bi+=2;this.addfunc(bn,bf,ac)}}bh=(a2|I|aC|a7)}}}else{if(this.isNumber()){if((bh&a2)===0){this.error_parsing(this.pos,"unexpected number")}var be=new aL(ai,0,0,this.tokennumber);bn.push(be);bh=(aG|B|u)}else{if(this.isString()){if((bh&a2)===0){this.error_parsing(this.pos,"unexpected string")}var be=new aL(ai,0,0,this.tokennumber);bn.push(be);bh=(aG|B|u)}else{if(this.isLeftParenth()){if((bh&I)===0){this.error_parsing(this.pos,'unexpected "("')}if(bh&a9){bk.push(true)}else{bk.push(false)}bh=(a2|I|aC|a7|aH)}else{if(this.isRightParenth()){var bm=bk.pop();if(bm){bi+=2;this.tokenprio=-2;this.tokenindex=-1;this.addfunc(bn,bf,E)}if(bh&aH){var be=new aL(ai,0,0,[]);bn.push(be)}else{if((bh&B)===0){this.error_parsing(this.pos,'unexpected ")"')}}bh=(aG|B|u|I|a9)}else{if(this.isConst()){if((bh&a2)===0){this.error_parsing(this.pos,"unexpected constant")}var bd=new aL(ai,0,0,this.tokennumber);bn.push(bd);bh=(aG|B|u)}else{if(this.isVar()){if((bh&a2)===0){this.error_parsing(this.pos,"unexpected variable")}var bj=new aL(aj,this.tokenindex,0,0);bn.push(bj);bh=(aG|B|u|I|a9)}else{if(this.isWhite()){}else{if(this.errormsg===""){this.error_parsing(this.pos,"unknown character")}else{this.error_parsing(this.pos,this.errormsg)}}}}}}}}}}if(this.tmpprio<0||this.tmpprio>=10){this.error_parsing(this.pos,'unmatched "()"')}while(bf.length>0){var bg=bf.pop();bn.push(bg)}return new aT(bn)},evaluate:function(bd,be){return this.parse(bd).evaluate(be)},error_parsing:function(bd,be){this.success=false;this.errormsg="parse error [column "+(bd)+"]: "+be;throw new Error(this.errormsg)},addfunc:function(bg,bd,bf){var be=new aL(bf,this.tokenindex,this.tokenprio+this.tmpprio,0);while(bd.length>0){if(be.prio_>=bd[bd.length-1].prio_){bg.push(bd.pop())}else{break}}bd.push(be)},isNumber:function(){var be=false;var bf="";while(this.pos<this.expression.length){var bd=this.expression.charCodeAt(this.pos);if((bd>=48&&bd<=57)||bd===46){bf+=this.expression.charAt(this.pos);this.pos++;this.tokennumber=parseFloat(bf);be=true}else{break}}return be},unescape:function(be,bj){var bd=[];var bi=false;for(var bg=0;bg<be.length;bg++){var bh=be.charAt(bg);if(bi){switch(bh){case"'":bd.push("'");break;case"\\":bd.push("\\");break;case"/":bd.push("/");break;case"b":bd.push("\b");break;case"f":bd.push("\f");break;case"n":bd.push("\n");break;case"r":bd.push("\r");break;case"t":bd.push("\t");break;case"u":var bf=parseInt(be.substring(bg+1,bg+5),16);bd.push(String.fromCharCode(bf));bg+=4;break;default:throw this.error_parsing(bj+bg,"Illegal escape sequence: '\\"+bh+"'")}bi=false}else{if(bh=="\\"){bi=true}else{bd.push(bh)}}}return bd.join("")},isString:function(){var be=false;var bg="";var bf=this.pos;if(this.pos<this.expression.length&&this.expression.charAt(this.pos)=="'"){this.pos++;while(this.pos<this.expression.length){var bd=this.expression.charAt(this.pos);if(bd!="'"||bg.slice(-1)=="\\"){bg+=this.expression.charAt(this.pos);this.pos++}else{this.pos++;this.tokennumber=this.unescape(bg,bf);be=true;break}}}return be},isConst:function(){var bf;for(var be in this.consts){if(true){var bd=be.length;bf=this.expression.substr(this.pos,bd);if(be===bf){this.tokennumber=this.consts[be];this.pos+=bd;return true}}}return false},isOperator:function(){var bd;if(this.pos+1<this.expression.length){bd=this.expression.substr(this.pos,2);if(ap.operators[bd]){this.tokenprio=ap.operators[bd][2];this.tokenindex=bd;this.pos+=2;return true}}bd=this.expression.substr(this.pos,1);if(ap.operators[bd]){this.tokenprio=ap.operators[bd][2];this.tokenindex=bd;this.pos++;return true}return false},isSign:function(){var bd=this.expression.charCodeAt(this.pos-1);if(bd===45||bd===43){return true}return false},isPositiveSign:function(){var bd=this.expression.charCodeAt(this.pos-1);if(bd===43){return true}return false},isNegativeSign:function(){var bd=this.expression.charCodeAt(this.pos-1);if(bd===45){return true}return false},isLeftParenth:function(){var bd=this.expression.charCodeAt(this.pos);if(bd===40){this.pos++;this.tmpprio-=20;return true}return false},isRightParenth:function(){var bd=this.expression.charCodeAt(this.pos);if(bd===41){this.pos++;this.tmpprio+=20;return true}return false},isComma:function(){var bd=this.expression.charCodeAt(this.pos);if(bd===44){this.pos++;this.tokenprio=15;this.tokenindex=",";return true}return false},isWhite:function(){var bd=this.expression.charCodeAt(this.pos);if(bd===32||bd===9||bd===10||bd===13){this.pos++;return true}return false},isVar:function(){var be="";for(var bd=this.pos;bd<this.expression.length;bd++){var bf=this.expression.charAt(bd);if(bd===this.pos){if(!bf.match(ap.regFirstVarChar)){break}}else{if(!bf.match(ap.regRestVarChar)){break}}be+=bf}if(be.length>0){this.tokenindex=be;this.tokenprio=0;this.pos+=be.length;return true}return false},isComment:function(){var bd=this.expression.charCodeAt(this.pos-1);if(bd===47&&this.expression.charCodeAt(this.pos)===42){this.pos=this.expression.indexOf("*/",this.pos)+2;if(this.pos===1){this.pos=this.expression.length}return true}return false}};aJ.Parser=ap;return ap})(typeof exports==="undefined"?{}:exports);INTERMediator.propertyIETridentSetup();if(INTERMediator.isIE&&INTERMediator.ieVersion<9){INTERMediator.startFrom=0;INTERMediator.pagedSize=0;INTERMediator.additionalCondition={};INTERMediator.additionalSortKey={}}else{Object.defineProperty(INTERMediator,"startFrom",{get:function(){return INTERMediator.getLocalProperty("_im_startFrom",0)},set:function(a){INTERMediator.setLocalProperty("_im_startFrom",a)}});Object.defineProperty(INTERMediator,"pagedSize",{get:function(){return INTERMediator.getLocalProperty("_im_pagedSize",0)},set:function(a){INTERMediator.setLocalProperty("_im_pagedSize",a)}});Object.defineProperty(INTERMediator,"additionalCondition",{get:function(){return INTERMediator.getLocalProperty("_im_additionalCondition",{})},set:function(a){INTERMediator.setLocalProperty("_im_additionalCondition",a)}});Object.defineProperty(INTERMediator,"additionalSortKey",{get:function(){return INTERMediator.getLocalProperty("_im_additionalSortKey",{})},set:function(a){INTERMediator.setLocalProperty("_im_additionalSortKey",a)}})}if(!INTERMediator.additionalCondition){INTERMediator.additionalCondition={}}if(!INTERMediator.additionalSortKey){INTERMediator.additionalSortKey={}}INTERMediatorLib.addEvent(window,"beforeunload",function(a){var c=""});INTERMediatorLib.addEvent(window,"unload",function(a){INTERMediator_DBAdapter.unregister()});
